OPTION CASEMAP:NONE

include vec.inc
include dumpreg.inc

M_TRUNC EQU 9   ; Mantissa trancation length (in bits)

.data
TABLE SEGMENT ALIGN(32)
			; 1/a, log(a)
log_table	dq 0.9990243902439024, 0.0009760859730554589  ; a=1.0009765625
			dq 0.997078870496592, 0.002925404329105136  ; a=1.0029296875
			dq 0.9951409135082604, 0.004870930234596512  ; a=1.0048828125
			dq 0.9932104752667313, 0.006812678417506831  ; a=1.0068359375
			dq 0.9912875121006777, 0.008750663520185453  ; a=1.0087890625
			dq 0.9893719806763285, 0.010684900100016353  ; a=1.0107421875
			dq 0.9874638379942141, 0.012615402630074235  ; a=1.0126953125
			dq 0.9855630413859481, 0.0145421854997743  ; a=1.0146484375
			dq 0.983669548511047, 0.01646526301551579  ; a=1.0166015625
			dq 0.9817833173537871, 0.018384649401319352  ; a=1.0185546875
			dq 0.9799043062200957, 0.020300358799458285  ; a=1.0205078125
			dq 0.9780324737344794, 0.02221240527108376  ; a=1.0224609375
			dq 0.9761677788369876, 0.02412080279684408  ; a=1.0244140625
			dq 0.9743101807802094, 0.026025565277498032  ; a=1.0263671875
			dq 0.9724596391263058, 0.027926706534522408  ; a=1.0283203125
			dq 0.9706161137440759, 0.029824240310713776  ; a=1.0302734375
			dq 0.9687795648060549, 0.03171818027078454  ; a=1.0322265625
			dq 0.9669499527856469, 0.03360854000195337  ; a=1.0341796875
			dq 0.9651272384542884, 0.03549533301453004  ; a=1.0361328125
			dq 0.9633113828786454, 0.037378572742494835  ; a=1.0380859375
			dq 0.9615023474178404, 0.039258272544072395  ; a=1.0400390625
			dq 0.9597000937207123, 0.04113444570230027  ; a=1.0419921875
			dq 0.9579045837231057, 0.043007105425592135  ; a=1.0439453125
			dq 0.9561157796451915, 0.044876264848295676  ; a=1.0458984375
			dq 0.9543336439888164, 0.04674193703124538  ; a=1.0478515625
			dq 0.9525581395348838, 0.04860413496231008  ; a=1.0498046875
			dq 0.9507892293407614, 0.05046287155693547  ; a=1.0517578125
			dq 0.9490268767377201, 0.052318159658681564  ; a=1.0537109375
			dq 0.9472710453283997, 0.05417001203975518  ; a=1.0556640625
			dq 0.9455216989843028, 0.056018441401537514  ; a=1.0576171875
			dq 0.943778801843318, 0.05786346037510683  ; a=1.0595703125
			dq 0.9420423183072677, 0.05970508152175635  ; a=1.0615234375
			dq 0.9403122130394858, 0.061543317333507375  ; a=1.0634765625
			dq 0.9385884509624198, 0.06337818023361773  ; a=1.0654296875
			dq 0.9368709972552608, 0.06520968257708547  ; a=1.0673828125
			dq 0.9351598173515981, 0.0670378366511481  ; a=1.0693359375
			dq 0.9334548769371012, 0.06886265467577715  ; a=1.0712890625
			dq 0.9317561419472248, 0.07068414880416826  ; a=1.0732421875
			dq 0.9300635785649409, 0.07250233112322686  ; a=1.0751953125
			dq 0.928377153218495, 0.07431721365404938  ; a=1.0771484375
			dq 0.9266968325791856, 0.0761288083524001  ; a=1.0791015625
			dq 0.9250225835591689, 0.07793712710918378  ; a=1.0810546875
			dq 0.9233543733092876, 0.07974218175091394  ; a=1.0830078125
			dq 0.9216921692169217, 0.0815439840401769  ; a=1.0849609375
			dq 0.9200359389038635, 0.08334254567609174  ; a=1.0869140625
			dq 0.9183856502242153, 0.08513787829476605  ; a=1.0888671875
			dq 0.9167412712623098, 0.08692999346974761  ; a=1.0908203125
			dq 0.9151027703306523, 0.08871890271247214  ; a=1.0927734375
			dq 0.9134701159678859, 0.09050461747270681  ; a=1.0947265625
			dq 0.9118432769367765, 0.09228714913899008  ; a=1.0966796875
			dq 0.9102222222222223, 0.09406650903906741  ; a=1.0986328125
			dq 0.9086069210292813, 0.09584270844032321  ; a=1.1005859375
			dq 0.9069973427812223, 0.09761575855020892  ; a=1.1025390625
			dq 0.905393457117595, 0.09938567051666736  ; a=1.1044921875
			dq 0.9037952338923213, 0.10115245542855322  ; a=1.1064453125
			dq 0.9022026431718062, 0.10291612431604996  ; a=1.1083984375
			dq 0.9006156552330695, 0.10467668815108294  ; a=1.1103515625
			dq 0.8990342405618964, 0.10643415784772904  ; a=1.1123046875
			dq 0.8974583698510079, 0.10818854426262255  ; a=1.1142578125
			dq 0.8958880139982502, 0.10993985819535756  ; a=1.1162109375
			dq 0.8943231441048035, 0.11168811038888693  ; a=1.1181640625
			dq 0.8927637314734089, 0.11343331152991759  ; a=1.1201171875
			dq 0.8912097476066144, 0.1151754722493026  ; a=1.1220703125
			dq 0.889661164205039, 0.11691460312242954  ; a=1.1240234375
			dq 0.8881179531656548, 0.11865071466960593  ; a=1.1259765625
			dq 0.8865800865800866, 0.12038381735644083  ; a=1.1279296875
			dq 0.88504753673293, 0.12211392159422348  ; a=1.1298828125
			dq 0.8835202761000863, 0.12384103774029862  ; a=1.1318359375
			dq 0.8819982773471146, 0.1255651760984384  ; a=1.1337890625
			dq 0.880481513327601, 0.12728634691921134  ; a=1.1357421875
			dq 0.878969957081545, 0.12900456040034786  ; a=1.1376953125
			dq 0.8774635818337618, 0.13071982668710289  ; a=1.1396484375
			dq 0.8759623609923011, 0.1324321558726153  ; a=1.1416015625
			dq 0.874466268146883, 0.13414155799826424  ; a=1.1435546875
			dq 0.8729752770673487, 0.13584804305402237  ; a=1.1455078125
			dq 0.8714893617021277, 0.13755162097880624  ; a=1.1474609375
			dq 0.8700084961767205, 0.1392523016608236  ; a=1.1494140625
			dq 0.8685326547921968, 0.14095009493791782  ; a=1.1513671875
			dq 0.8670618120237087, 0.1426450105979092  ; a=1.1533203125
			dq 0.8655959425190194, 0.14433705837893368  ; a=1.1552734375
			dq 0.8641350210970464, 0.14602624796977848  ; a=1.1572265625
			dq 0.8626790227464195, 0.14771258901021495  ; a=1.1591796875
			dq 0.8612279226240538, 0.14939609109132873  ; a=1.1611328125
			dq 0.8597816960537363, 0.151076763755847  ; a=1.1630859375
			dq 0.8583403185247276, 0.15275461649846303  ; a=1.1650390625
			dq 0.8569037656903765, 0.15442965876615794  ; a=1.1669921875
			dq 0.8554720133667502, 0.15610189995852006  ; a=1.1689453125
			dq 0.854045037531276, 0.15777134942806115  ; a=1.1708984375
			dq 0.8526228143213989, 0.15943801648053044  ; a=1.1728515625
			dq 0.8512053200332502, 0.16110191037522578  ; a=1.1748046875
			dq 0.8497925311203319, 0.16276304032530228  ; a=1.1767578125
			dq 0.848384424192212, 0.1644214154980784  ; a=1.1787109375
			dq 0.8469809760132341, 0.16607704501533957  ; a=1.1806640625
			dq 0.8455821635012386, 0.16772993795363916  ; a=1.1826171875
			dq 0.8441879637262985, 0.16938010334459705  ; a=1.1845703125
			dq 0.842798353909465, 0.17102755017519575  ; a=1.1865234375
			dq 0.8414133114215283, 0.17267228738807408  ; a=1.1884765625
			dq 0.8400328137817884, 0.17431432388181842  ; a=1.1904296875
			dq 0.8386568386568387, 0.17595366851125158  ; a=1.1923828125
			dq 0.8372853638593623, 0.17759033008771927  ; a=1.1943359375
			dq 0.8359183673469388, 0.17922431737937428  ; a=1.1962890625
			dq 0.8345558272208639, 0.18085563911145836  ; a=1.1982421875
			dq 0.8331977217249796, 0.18248430396658172  ; a=1.2001953125
			dq 0.8318440292445166, 0.1841103205850004  ; a=1.2021484375
			dq 0.8304947283049473, 0.1857336975648912  ; a=1.2041015625
			dq 0.8291497975708502, 0.18735444346262448  ; a=1.2060546875
			dq 0.8278092158447857, 0.1889725667930348  ; a=1.2080078125
			dq 0.8264729620661824, 0.19058807602968936  ; a=1.2099609375
			dq 0.8251410153102336, 0.19220097960515412  ; a=1.2119140625
			dq 0.8238133547868061, 0.193811285911258  ; a=1.2138671875
			dq 0.8224899598393575, 0.19541900329935488  ; a=1.2158203125
			dq 0.8211708099438653, 0.19702414008058336  ; a=1.2177734375
			dq 0.8198558847077662, 0.19862670452612458  ; a=1.2197265625
			dq 0.8185451638689049, 0.20022670486745806  ; a=1.2216796875
			dq 0.8172386272944933, 0.2018241492966152  ; a=1.2236328125
			dq 0.8159362549800797, 0.20341904596643118  ; a=1.2255859375
			dq 0.8146380270485283, 0.20501140299079432  ; a=1.2275390625
			dq 0.8133439237490071, 0.20660122844489406  ; a=1.2294921875
			dq 0.8120539254559873, 0.20818853036546647  ; a=1.2314453125
			dq 0.8107680126682502, 0.20977331675103802  ; a=1.2333984375
			dq 0.8094861660079051, 0.21135559556216751  ; a=1.2353515625
			dq 0.8082083662194159, 0.21293537472168597  ; a=1.2373046875
			dq 0.8069345941686368, 0.21451266211493455  ; a=1.2392578125
			dq 0.8056648308418568, 0.21608746559000094  ; a=1.2412109375
			dq 0.8043990573448547, 0.21765979295795343  ; a=1.2431640625
			dq 0.8031372549019608, 0.21922965199307343  ; a=1.2451171875
			dq 0.8018794048551292, 0.2207970504330862  ; a=1.2470703125
			dq 0.800625488663018, 0.2223619959793896  ; a=1.2490234375
			dq 0.7993754879000781, 0.22392449629728114  ; a=1.2509765625
			dq 0.7981293842556508, 0.22548455901618333  ; a=1.2529296875
			dq 0.796887159533074, 0.2270421917298671  ; a=1.2548828125
			dq 0.7956487956487956, 0.22859740199667358  ; a=1.2568359375
			dq 0.7944142746314973, 0.2301501973397343  ; a=1.2587890625
			dq 0.7931835786212239, 0.2317005852471894  ; a=1.2607421875
			dq 0.7919566898685229, 0.23324857317240438  ; a=1.2626953125
			dq 0.7907335907335907, 0.23479416853418503  ; a=1.2646484375
			dq 0.7895142636854279, 0.2363373787169908  ; a=1.2666015625
			dq 0.7882986913010007, 0.23787821107114646  ; a=1.2685546875
			dq 0.787086856264412, 0.2394166729130522  ; a=1.2705078125
			dq 0.7858787413660783, 0.24095277152539202  ; a=1.2724609375
			dq 0.7846743295019157, 0.24248651415734068  ; a=1.2744140625
			dq 0.7834736036725325, 0.24401790802476886  ; a=1.2763671875
			dq 0.7822765469824293, 0.24554696031044684  ; a=1.2783203125
			dq 0.7810831426392068, 0.24707367816424675  ; a=1.2802734375
			dq 0.7798933739527799, 0.24859806870334308  ; a=1.2822265625
			dq 0.7787072243346007, 0.2501201390124118  ; a=1.2841796875
			dq 0.7775246772968869, 0.2516398961438279  ; a=1.2861328125
			dq 0.7763457164518575, 0.25315734711786153  ; a=1.2880859375
			dq 0.7751703255109765, 0.25467249892287225  ; a=1.2900390625
			dq 0.7739984882842026, 0.2561853585155026  ; a=1.2919921875
			dq 0.7728301886792452, 0.2576959328208695  ; a=1.2939453125
			dq 0.771665410700829, 0.2592042287327544  ; a=1.2958984375
			dq 0.7705041384499624, 0.26071025311379226  ; a=1.2978515625
			dq 0.7693463561232157, 0.26221401279565854  ; a=1.2998046875
			dq 0.768192048012003, 0.26371551457925557  ; a=1.3017578125
			dq 0.7670411985018727, 0.2652147652348968  ; a=1.3037109375
			dq 0.7658937920718025, 0.2667117715024901  ; a=1.3056640625
			dq 0.7647498132935027, 0.2682065400917194  ; a=1.3076171875
			dq 0.7636092468307233, 0.26969907768222545  ; a=1.3095703125
			dq 0.7624720774385704, 0.27118939092378447  ; a=1.3115234375
			dq 0.7613382899628253, 0.27267748643648637  ; a=1.3134765625
			dq 0.7602078693392724, 0.2741633708109109  ; a=1.3154296875
			dq 0.7590808005930318, 0.2756470506083028  ; a=1.3173828125
			dq 0.7579570688378978, 0.27712853236074575  ; a=1.3193359375
			dq 0.7568366592756837, 0.27860782257133493  ; a=1.3212890625
			dq 0.7557195571955719, 0.2800849277143482  ; a=1.3232421875
			dq 0.7546057479734709, 0.2815598542354161  ; a=1.3251953125
			dq 0.753495217071376, 0.2830326085516906  ; a=1.3271484375
			dq 0.7523879500367376, 0.284503197052013  ; a=1.3291015625
			dq 0.7512839325018342, 0.28597162609707955  ; a=1.3310546875
			dq 0.7501831501831502, 0.287437902019607  ; a=1.3330078125
			dq 0.7490855888807608, 0.2889020311244965  ; a=1.3349609375
			dq 0.747991234477721, 0.2903640196889958  ; a=1.3369140625
			dq 0.7469000729394603, 0.2918238739628613  ; a=1.3388671875
			dq 0.7458120903131829, 0.29328160016851795  ; a=1.3408203125
			dq 0.7447272727272727, 0.2947372045012186  ; a=1.3427734375
			dq 0.7436456063907044, 0.29619069312920177  ; a=1.3447265625
			dq 0.7425670775924583, 0.2976420721938487  ; a=1.3466796875
			dq 0.7414916727009413, 0.29909134780983904  ; a=1.3486328125
			dq 0.7404193781634129, 0.3005385260653051  ; a=1.3505859375
			dq 0.7393501805054151, 0.3019836130219858  ; a=1.3525390625
			dq 0.738284066330209, 0.3034266147153785  ; a=1.3544921875
			dq 0.7372210223182145, 0.3048675371548907  ; a=1.3564453125
			dq 0.7361610352264558, 0.3063063863239898  ; a=1.3583984375
			dq 0.7351040918880115, 0.30774316818035263  ; a=1.3603515625
			dq 0.7340501792114695, 0.3091778886560129  ; a=1.3623046875
			dq 0.7329992841803865, 0.3106105536575087  ; a=1.3642578125
			dq 0.731951393852752, 0.3120411690660281  ; a=1.3662109375
			dq 0.7309064953604568, 0.3134697407375539  ; a=1.3681640625
			dq 0.729864575908767, 0.31489627450300783  ; a=1.3701171875
			dq 0.7288256227758008, 0.31632077616839305  ; a=1.3720703125
			dq 0.7277896233120114, 0.317743251514936  ; a=1.3740234375
			dq 0.7267565649396736, 0.31916370629922713  ; a=1.3759765625
			dq 0.7257264351523742, 0.3205821462533609  ; a=1.3779296875
			dq 0.7246992215145082, 0.32199857708507434  ; a=1.3798828125
			dq 0.7236749116607774, 0.3234130044778849  ; a=1.3818359375
			dq 0.7226534932956952, 0.3248254340912273  ; a=1.3837890625
			dq 0.7216349541930938, 0.3262358715605896  ; a=1.3857421875
			dq 0.7206192821956369, 0.3276443224976475  ; a=1.3876953125
			dq 0.7196064652143359, 0.32905079249039926  ; a=1.3896484375
			dq 0.7185964912280701, 0.3304552871032978  ; a=1.3916015625
			dq 0.7175893482831114, 0.33185781187738334  ; a=1.3935546875
			dq 0.7165850244926522, 0.33325837233041433  ; a=1.3955078125
			dq 0.7155835080363382, 0.33465697395699784  ; a=1.3974609375
			dq 0.7145847871598046, 0.33605362222871876  ; a=1.3994140625
			dq 0.713588850174216, 0.3374483225942684  ; a=1.4013671875
			dq 0.7125956854558108, 0.33884108047957184  ; a=1.4033203125
			dq 0.7116052814454482, 0.3402319012879147  ; a=1.4052734375
			dq 0.710617626648161, 0.341620790400069  ; a=1.4072265625
			dq 0.7096327096327096, 0.3430077531744178  ; a=1.4091796875
			dq 0.7086505190311418, 0.3443927949470794  ; a=1.4111328125
			dq 0.7076710435383552, 0.34577592103203075  ; a=1.4130859375
			dq 0.7066942719116632, 0.3471571367212293  ; a=1.4150390625
			dq 0.7057201929703653, 0.34853644728473476  ; a=1.4169921875
			dq 0.70474879559532, 0.3499138579708298  ; a=1.4189453125
			dq 0.7037800687285224, 0.3512893740061398  ; a=1.4208984375
			dq 0.7028140013726836, 0.35266300059575173  ; a=1.4228515625
			dq 0.7018505825908157, 0.35403474292333253  ; a=1.4248046875
			dq 0.7008898015058179, 0.35540460615124636  ; a=1.4267578125
			dq 0.6999316473000684, 0.3567725954206712  ; a=1.4287109375
			dq 0.6989761092150171, 0.3581387158517146  ; a=1.4306640625
			dq 0.6980231765507839, 0.35950297254352864  ; a=1.4326171875
			dq 0.697072838665759, 0.3608653705744242  ; a=1.4345703125
			dq 0.6961250849762066, 0.3622259150019844  ; a=1.4365234375
			dq 0.6951799049558723, 0.36358461086317717  ; a=1.4384765625
			dq 0.6942372881355933, 0.36494146317446713  ; a=1.4404296875
			dq 0.6932972241029113, 0.3662964769319267  ; a=1.4423828125
			dq 0.6923597025016903, 0.36764965711134673  ; a=1.4443359375
			dq 0.6914247130317354, 0.3690010086683457  ; a=1.4462890625
			dq 0.6904922454484154, 0.370350536538479  ; a=1.4482421875
			dq 0.6895622895622896, 0.3716982456373469  ; a=1.4501953125
			dq 0.6886348352387357, 0.373044140860702  ; a=1.4521484375
			dq 0.6877098723975823, 0.3743882270845559  ; a=1.4541015625
			dq 0.6867873910127431, 0.37573050916528533  ; a=1.4560546875
			dq 0.6858673811118553, 0.3770709919397373  ; a=1.4580078125
			dq 0.6849498327759197, 0.3784096802253337  ; a=1.4599609375
			dq 0.6840347361389446, 0.37974657882017526  ; a=1.4619140625
			dq 0.6831220813875917, 0.3810816925031446  ; a=1.4638671875
			dq 0.6822118587608261, 0.38241502603400884  ; a=1.4658203125
			dq 0.6813040585495675, 0.3837465841535214  ; a=1.4677734375
			dq 0.6803986710963456, 0.38507637158352304  ; a=1.4697265625
			dq 0.6794956867949569, 0.3864043930270424  ; a=1.4716796875
			dq 0.6785950960901259, 0.3877306531683958  ; a=1.4736328125
			dq 0.6776968894771674, 0.3890551566732865  ; a=1.4755859375
			dq 0.6768010575016523, 0.39037790818890283  ; a=1.4775390625
			dq 0.6759075907590759, 0.39169891234401644  ; a=1.4794921875
			dq 0.6750164798945286, 0.39301817374907916  ; a=1.4814453125
			dq 0.67412771560237, 0.39433569699631976  ; a=1.4833984375
			dq 0.673241288625904, 0.39565148665983974  ; a=1.4853515625
			dq 0.6723571897570584, 0.3969655472957087  ; a=1.4873046875
			dq 0.6714754098360656, 0.3982778834420589  ; a=1.4892578125
			dq 0.6705959397511461, 0.39958849961917936  ; a=1.4912109375
			dq 0.6697187704381949, 0.4008974003296092  ; a=1.4931640625
			dq 0.6688438928804703, 0.40220459005823067  ; a=1.4951171875
			dq 0.6679712981082844, 0.40351007327236105  ; a=1.4970703125
			dq 0.6671009771986971, 0.4048138544218444  ; a=1.4990234375
			dq 0.6662329212752115, 0.40611593793914275  ; a=1.5009765625
			dq 0.6653671215074723, 0.40741632823942614  ; a=1.5029296875
			dq 0.6645035691109669, 0.40871502972066265  ; a=1.5048828125
			dq 0.6636422553467272, 0.4100120467637077  ; a=1.5068359375
			dq 0.6627831715210356, 0.41130738373239273  ; a=1.5087890625
			dq 0.6619263089851325, 0.41260104497361305  ; a=1.5107421875
			dq 0.6610716591349257, 0.4138930348174155  ; a=1.5126953125
			dq 0.6602192134107028, 0.41518335757708574  ; a=1.5146484375
			dq 0.6593689632968448, 0.41647201754923396  ; a=1.5166015625
			dq 0.6585209003215434, 0.4177590190138814  ; a=1.5185546875
			dq 0.6576750160565189, 0.4190443662345452  ; a=1.5205078125
			dq 0.6568313021167415, 0.4203280634583234  ; a=1.5224609375
			dq 0.6559897501601537, 0.421610114915979  ; a=1.5244140625
			dq 0.655150351887396, 0.4228905248220235  ; a=1.5263671875
			dq 0.6543130990415336, 0.4241692973748005  ; a=1.5283203125
			dq 0.6534779834077856, 0.42544643675656774  ; a=1.5302734375
			dq 0.6526449968132568, 0.42672194713357947  ; a=1.5322265625
			dq 0.6518141311266709, 0.4279958326561681  ; a=1.5341796875
			dq 0.6509853782581055, 0.4292680974588247  ; a=1.5361328125
			dq 0.6501587301587302, 0.43053874566028033  ; a=1.5380859375
			dq 0.6493341788205453, 0.4318077813635853  ; a=1.5400390625
			dq 0.6485117162761241, 0.433075208656189  ; a=1.5419921875
			dq 0.6476913345983555, 0.4343410316100189  ; a=1.5439453125
			dq 0.6468730259001895, 0.43560525428155905  ; a=1.5458984375
			dq 0.6460567823343849, 0.4368678807119279  ; a=1.5478515625
			dq 0.6452425960932577, 0.438128914926956  ; a=1.5498046875
			dq 0.644430459408433, 0.4393883609372629  ; a=1.5517578125
			dq 0.6436203645505971, 0.44064622273833376  ; a=1.5537109375
			dq 0.642812303829253, 0.4419025043105954  ; a=1.5556640625
			dq 0.6420062695924765, 0.44315720961949184  ; a=1.5576171875
			dq 0.641202254226675, 0.44441034261555934  ; a=1.5595703125
			dq 0.6404002501563477, 0.44566190723450116  ; a=1.5615234375
			dq 0.6396002498438476, 0.4469119073972616  ; a=1.5634765625
			dq 0.6388022457891454, 0.4481603470100999  ; a=1.5654296875
			dq 0.638006230529595, 0.44940722996466315  ; a=1.5673828125
			dq 0.6372121966397013, 0.4506525601380595  ; a=1.5693359375
			dq 0.6364201367308887, 0.4518963413929301  ; a=1.5712890625
			dq 0.6356300434512725, 0.4531385775775213  ; a=1.5732421875
			dq 0.6348419094854308, 0.4543792725257558  ; a=1.5751953125
			dq 0.6340557275541796, 0.45561843005730385  ; a=1.5771484375
			dq 0.6332714904143476, 0.4568560539776538  ; a=1.5791015625
			dq 0.6324891908585547, 0.45809214807818205  ; a=1.5810546875
			dq 0.6317088217149908, 0.459326716136223  ; a=1.5830078125
			dq 0.6309303758471966, 0.46055976191513814  ; a=1.5849609375
			dq 0.6301538461538462, 0.4617912891643848  ; a=1.5869140625
			dq 0.629379225568531, 0.4630213016195847  ; a=1.5888671875
			dq 0.6286065070595457, 0.46424980300259205  ; a=1.5908203125
			dq 0.627835683629675, 0.46547679702156075  ; a=1.5927734375
			dq 0.6270667483159829, 0.466702287371012  ; a=1.5947265625
			dq 0.6262996941896024, 0.46792627773190065  ; a=1.5966796875
			dq 0.6255345143555284, 0.4691487717716818  ; a=1.5986328125
			dq 0.62477120195241, 0.4703697731443766  ; a=1.6005859375
			dq 0.6240097501523462, 0.4715892854906378  ; a=1.6025390625
			dq 0.6232501521606817, 0.472807312437815  ; a=1.6044921875
			dq 0.6224924012158055, 0.4740238576000192  ; a=1.6064453125
			dq 0.6217364905889496, 0.4752389245781872  ; a=1.6083984375
			dq 0.6209824135839903, 0.4764525169601458  ; a=1.6103515625
			dq 0.6202301635372501, 0.4776646383206749  ; a=1.6123046875
			dq 0.6194797338173019, 0.4788752922215711  ; a=1.6142578125
			dq 0.6187311178247734, 0.4800844822117102  ; a=1.6162109375
			dq 0.6179843089921545, 0.4812922118271098  ; a=1.6181640625
			dq 0.6172393007836046, 0.48249848459099137  ; a=1.6201171875
			dq 0.6164960866947622, 0.48370330401384176  ; a=1.6220703125
			dq 0.6157546602525557, 0.48490667359347456  ; a=1.6240234375
			dq 0.615015015015015, 0.4861085968150911  ; a=1.6259765625
			dq 0.6142771445710857, 0.4873090771513409  ; a=1.6279296875
			dq 0.6135410425404434, 0.488508118062382  ; a=1.6298828125
			dq 0.6128067025733094, 0.4897057229959406  ; a=1.6318359375
			dq 0.6120741183502689, 0.4909018953873709  ; a=1.6337890625
			dq 0.6113432835820896, 0.4920966386597137  ; a=1.6357421875
			dq 0.6106141920095408, 0.49328995622375577  ; a=1.6376953125
			dq 0.6098868374032163, 0.4944818514780877  ; a=1.6396484375
			dq 0.6091612135633552, 0.49567232780916254  ; a=1.6416015625
			dq 0.6084373143196673, 0.4968613885913529  ; a=1.6435546875
			dq 0.6077151335311572, 0.498049037187009  ; a=1.6455078125
			dq 0.6069946650859513, 0.4992352769465152  ; a=1.6474609375
			dq 0.6062759029011249, 0.500420111208347  ; a=1.6494140625
			dq 0.6055588409225311, 0.5016035432991272  ; a=1.6513671875
			dq 0.6048434731246308, 0.5027855765336822  ; a=1.6533203125
			dq 0.6041297935103245, 0.5039662142150976  ; a=1.6552734375
			dq 0.6034177961107837, 0.5051454596347732  ; a=1.6572265625
			dq 0.6027074749852854, 0.5063233160724789  ; a=1.6591796875
			dq 0.6019988242210464, 0.5074997867964086  ; a=1.6611328125
			dq 0.6012918379330593, 0.5086748750632352  ; a=1.6630859375
			dq 0.6005865102639296, 0.509848584118164  ; a=1.6650390625
			dq 0.5998828353837141, 0.5110209171949875  ; a=1.6669921875
			dq 0.5991808074897601, 0.5121918775161378  ; a=1.6689453125
			dq 0.5984804208065458, 0.5133614682927404  ; a=1.6708984375
			dq 0.5977816695855225, 0.5145296927246669  ; a=1.6728515625
			dq 0.5970845481049563, 0.5156965540005872  ; a=1.6748046875
			dq 0.5963890506697729, 0.5168620552980224  ; a=1.6767578125
			dq 0.595695171611402, 0.5180261997833961  ; a=1.6787109375
			dq 0.5950029052876235, 0.5191889906120863  ; a=1.6806640625
			dq 0.5943122460824144, 0.5203504309284765  ; a=1.6826171875
			dq 0.5936231884057971, 0.521510523866007  ; a=1.6845703125
			dq 0.5929357266936884, 0.5226692725472255  ; a=1.6865234375
			dq 0.5922498554077501, 0.5238266800838374  ; a=1.6884765625
			dq 0.5915655690352397, 0.5249827495767562  ; a=1.6904296875
			dq 0.5908828620888632, 0.526137484116153  ; a=1.6923828125
			dq 0.5902017291066283, 0.5272908867815065  ; a=1.6943359375
			dq 0.5895221646516984, 0.5284429606416519  ; a=1.6962890625
			dq 0.5888441633122484, 0.5295937087548299  ; a=1.6982421875
			dq 0.5881677197013211, 0.530743134168736  ; a=1.7001953125
			dq 0.5874928284566838, 0.5318912399205679  ; a=1.7021484375
			dq 0.5868194842406876, 0.5330380290370744  ; a=1.7041015625
			dq 0.5861476817401259, 0.5341835045346035  ; a=1.7060546875
			dq 0.5854774156660949, 0.535327669419149  ; a=1.7080078125
			dq 0.584808680753855, 0.5364705266863987  ; a=1.7099609375
			dq 0.5841414717626925, 0.5376120793217815  ; a=1.7119140625
			dq 0.5834757834757834, 0.5387523303005131  ; a=1.7138671875
			dq 0.5828116107000569, 0.5398912825876441  ; a=1.7158203125
			dq 0.5821489482660602, 0.5410289391381051  ; a=1.7177734375
			dq 0.5814877910278251, 0.542165302896753  ; a=1.7197265625
			dq 0.580828133862734, 0.5433003767984171  ; a=1.7216796875
			dq 0.5801699716713881, 0.5444341637679441  ; a=1.7236328125
			dq 0.579513299377476, 0.5455666667202433  ; a=1.7255859375
			dq 0.5788581119276427, 0.5466978885603322  ; a=1.7275390625
			dq 0.5782044042913608, 0.5478278321833805  ; a=1.7294921875
			dq 0.577552171460801, 0.5489565004747547  ; a=1.7314453125
			dq 0.5769014084507043, 0.550083896310063  ; a=1.7333984375
			dq 0.5762521102982555, 0.5512100225551982  ; a=1.7353515625
			dq 0.5756042720629567, 0.552334882066382  ; a=1.7373046875
			dq 0.574957888826502, 0.5534584776902085  ; a=1.7392578125
			dq 0.5743129556926528, 0.5545808122636873  ; a=1.7412109375
			dq 0.5736694677871148, 0.5557018886142864  ; a=1.7431640625
			dq 0.5730274202574147, 0.5568217095599749  ; a=1.7451171875
			dq 0.5723868082727781, 0.557940277909266  ; a=1.7470703125
			dq 0.5717476270240089, 0.5590575964612586  ; a=1.7490234375
			dq 0.5711098717233687, 0.5601736680056798  ; a=1.7509765625
			dq 0.5704735376044568, 0.5612884953229261  ; a=1.7529296875
			dq 0.5698386199220924, 0.562402081184106  ; a=1.7548828125
			dq 0.5692051139521956, 0.56351442835108  ; a=1.7568359375
			dq 0.5685730149916713, 0.564625539576503  ; a=1.7587890625
			dq 0.5679423183582918, 0.5657354176038641  ; a=1.7607421875
			dq 0.5673130193905818, 0.5668440651675282  ; a=1.7626953125
			dq 0.5666851134477033, 0.5679514849927754  ; a=1.7646484375
			dq 0.5660585959093422, 0.569057679795842  ; a=1.7666015625
			dq 0.5654334621755936, 0.5701626522839602  ; a=1.7685546875
			dq 0.5648097076668506, 0.571266405155398  ; a=1.7705078125
			dq 0.5641873278236914, 0.5723689410994981  ; a=1.7724609375
			dq 0.5635663181067694, 0.5734702627967181  ; a=1.7744140625
			dq 0.5629466739967015, 0.5745703729186692  ; a=1.7763671875
			dq 0.5623283909939594, 0.5756692741281548  ; a=1.7783203125
			dq 0.5617114646187603, 0.57676696907921  ; a=1.7802734375
			dq 0.5610958904109589, 0.5778634604171388  ; a=1.7822265625
			dq 0.5604816639299398, 0.5789587507785536  ; a=1.7841796875
			dq 0.5598687807545106, 0.5800528427914126  ; a=1.7861328125
			dq 0.5592572364827962, 0.5811457390750576  ; a=1.7880859375
			dq 0.5586470267321331, 0.5822374422402519  ; a=1.7900390625
			dq 0.5580381471389646, 0.5833279548892175  ; a=1.7919921875
			dq 0.5574305933587371, 0.5844172796156726  ; a=1.7939453125
			dq 0.5568243610657966, 0.585505419004868  ; a=1.7958984375
			dq 0.5562194459532862, 0.5865923756336248  ; a=1.7978515625
			dq 0.555615843733044, 0.5876781520703702  ; a=1.7998046875
			dq 0.5550135501355014, 0.5887627508751745  ; a=1.8017578125
			dq 0.5544125609095831, 0.5898461745997868  ; a=1.8037109375
			dq 0.5538128718226069, 0.5909284257876718  ; a=1.8056640625
			dq 0.5532144786601837, 0.5920095069740444  ; a=1.8076171875
			dq 0.5526173772261198, 0.5930894206859066  ; a=1.8095703125
			dq 0.5520215633423181, 0.5941681694420824  ; a=1.8115234375
			dq 0.5514270328486807, 0.5952457557532527  ; a=1.8134765625
			dq 0.5508337816030123, 0.596322182121991  ; a=1.8154296875
			dq 0.5502418054809243, 0.5973974510427976  ; a=1.8173828125
			dq 0.549651100375738, 0.5984715650021354  ; a=1.8193359375
			dq 0.5490616621983915, 0.5995445264784628  ; a=1.8212890625
			dq 0.5484734868773433, 0.6006163379422695  ; a=1.8232421875
			dq 0.5478865703584804, 0.6016870018561098  ; a=1.8251953125
			dq 0.547300908605024, 0.6027565206746365  ; a=1.8271484375
			dq 0.5467164975974372, 0.6038248968446355  ; a=1.8291015625
			dq 0.5461333333333334, 0.604892132805058  ; a=1.8310546875
			dq 0.5455514118273841, 0.6059582309870557  ; a=1.8330078125
			dq 0.5449707291112293, 0.6070231938140123  ; a=1.8349609375
			dq 0.5443912812333865, 0.6080870237015773  ; a=1.8369140625
			dq 0.5438130642591609, 0.6091497230576993  ; a=1.8388671875
			dq 0.543236074270557, 0.6102112942826581  ; a=1.8408203125
			dq 0.5426603073661898, 0.6112717397690971  ; a=1.8427734375
			dq 0.5420857596611964, 0.6123310619020564  ; a=1.8447265625
			dq 0.5415124272871497, 0.6133892630590044  ; a=1.8466796875
			dq 0.5409403063919704, 0.6144463456098698  ; a=1.8486328125
			dq 0.5403693931398417, 0.6155023119170736  ; a=1.8505859375
			dq 0.5397996837111229, 0.6165571643355611  ; a=1.8525390625
			dq 0.5392311743022643, 0.6176109052128328  ; a=1.8544921875
			dq 0.5386638611257233, 0.618663536888976  ; a=1.8564453125
			dq 0.5380977404098791, 0.6197150616966964  ; a=1.8583984375
			dq 0.5375328083989501, 0.6207654819613483  ; a=1.8603515625
			dq 0.5369690613529103, 0.621814800000966  ; a=1.8623046875
			dq 0.536406495547407, 0.6228630181262945  ; a=1.8642578125
			dq 0.5358451072736787, 0.6239101386408199  ; a=1.8662109375
			dq 0.5352848928384736, 0.6249561638407998  ; a=1.8681640625
			dq 0.5347258485639687, 0.6260010960152933  ; a=1.8701171875
			dq 0.5341679707876891, 0.6270449374461914  ; a=1.8720703125
			dq 0.5336112558624283, 0.6280876904082469  ; a=1.8740234375
			dq 0.5330557001561687, 0.6291293571691036  ; a=1.8759765625
			dq 0.5325013000520021, 0.6301699399893267  ; a=1.8779296875
			dq 0.531948051948052, 0.6312094411224315  ; a=1.8798828125
			dq 0.5313959522573949, 0.6322478628149133  ; a=1.8818359375
			dq 0.5308449974079834, 0.633285207306276  ; a=1.8837890625
			dq 0.5302951838425686, 0.6343214768290614  ; a=1.8857421875
			dq 0.5297465080186239, 0.6353566736088778  ; a=1.8876953125
			dq 0.5291989664082687, 0.636390799864429  ; a=1.8896484375
			dq 0.5286525554981931, 0.6374238578075427  ; a=1.8916015625
			dq 0.5281072717895823, 0.6384558496431987  ; a=1.8935546875
			dq 0.5275631117980423, 0.6394867775695572  ; a=1.8955078125
			dq 0.5270200720535255, 0.640516643777987  ; a=1.8974609375
			dq 0.526478149100257, 0.6415454504530935  ; a=1.8994140625
			dq 0.5259373394966615, 0.6425731997727466  ; a=1.9013671875
			dq 0.5253976398152899, 0.6435998939081077  ; a=1.9033203125
			dq 0.5248590466427473, 0.6446255350236582  ; a=1.9052734375
			dq 0.5243215565796211, 0.6456501252772259  ; a=1.9072265625
			dq 0.5237851662404092, 0.646673666820013  ; a=1.9091796875
			dq 0.5232498722534492, 0.6476961617966231  ; a=1.9111328125
			dq 0.5227156712608474, 0.6487176123450876  ; a=1.9130859375
			dq 0.522182559918409, 0.6497380205968932  ; a=1.9150390625
			dq 0.521650534895568, 0.6507573886770079  ; a=1.9169921875
			dq 0.5211195928753181, 0.6517757187039085  ; a=1.9189453125
			dq 0.5205897305541434, 0.652793012789606  ; a=1.9208984375
			dq 0.5200609446419502, 0.6538092730396724  ; a=1.9228515625
			dq 0.519533231861999, 0.6548245015532671  ; a=1.9248046875
			dq 0.5190065889508363, 0.6558387004231623  ; a=1.9267578125
			dq 0.5184810126582279, 0.6568518717357692  ; a=1.9287109375
			dq 0.5179564997470916, 0.6578640175711639  ; a=1.9306640625
			dq 0.5174330469934311, 0.6588751400031126  ; a=1.9326171875
			dq 0.5169106511862696, 0.6598852410990979  ; a=1.9345703125
			dq 0.5163893091275845, 0.6608943229203429  ; a=1.9365234375
			dq 0.5158690176322418, 0.6619023875218377  ; a=1.9384765625
			dq 0.5153497735279315, 0.6629094369523637  ; a=1.9404296875
			dq 0.514831573655103, 0.663915473254519  ; a=1.9423828125
			dq 0.5143144148669011, 0.6649204984647432  ; a=1.9443359375
			dq 0.5137982940291018, 0.6659245146133417  ; a=1.9462890625
			dq 0.5132832080200501, 0.6669275237245107  ; a=1.9482421875
			dq 0.5127691537305958, 0.6679295278163622  ; a=1.9501953125
			dq 0.512256128064032, 0.668930528900947  ; a=1.9521484375
			dq 0.511744127936032, 0.6699305289842803  ; a=1.9541015625
			dq 0.5112331502745882, 0.6709295300663651  ; a=1.9560546875
			dq 0.5107231920199501, 0.6719275341412164  ; a=1.9580078125
			dq 0.510214250124564, 0.672924543196885  ; a=1.9599609375
			dq 0.5097063215530114, 0.6739205592154813  ; a=1.9619140625
			dq 0.5091994032819492, 0.674915584173199  ; a=1.9638671875
			dq 0.5086934923000497, 0.6759096200403384  ; a=1.9658203125
			dq 0.5081885856079404, 0.6769026687813302  ; a=1.9677734375
			dq 0.5076846802181457, 0.6778947323547587  ; a=1.9697265625
			dq 0.5071817731550272, 0.6788858127133844  ; a=1.9716796875
			dq 0.5066798614547254, 0.679875911804168  ; a=1.9736328125
			dq 0.5061789421651013, 0.6808650315682924  ; a=1.9755859375
			dq 0.505679012345679, 0.6818531739411864  ; a=1.9775390625
			dq 0.5051800690675876, 0.682840340852547  ; a=1.9794921875
			dq 0.5046821094135042, 0.6838265342263616  ; a=1.9814453125
			dq 0.5041851304775973, 0.6848117559809316  ; a=1.9833984375
			dq 0.5036891293654697, 0.6857960080288935  ; a=1.9853515625
			dq 0.5031941031941032, 0.6867792922772422  ; a=1.9873046875
			dq 0.5027000490918017, 0.6877616106273527  ; a=1.9892578125
			dq 0.5022069641981364, 0.6887429649750021  ; a=1.9912109375
			dq 0.5017148456638902, 0.6897233572103917  ; a=1.9931640625
			dq 0.5012236906510035, 0.690702789218169  ; a=1.9951171875
			dq 0.5007334963325183, 0.691681262877449  ; a=1.9970703125
			dq 0.5002442598925256, 0.6926587800618365  ; a=1.9990234375
TABLE ENDS

COEFS SEGMENT ALIGN(32)
coefs	dq -318.153512397923  ; c_7
		dq 3.5620196096027517  ; c_6
		dq 0.2021208190819915  ; c_5
		dq -0.25000471586413053  ; c_4
		dq 0.333333331394435  ; c_3
		dq -0.49999999999861267  ; c_2
		dq 1.0000000000000002  ; c_1
		dq 0.0  ; c_0
COEFS ENDS

.code
; @param (xmm0) - double x in [0, 1)
; @return (xmm0)
PUBLIC ln
ln PROC
	; Assume xmm0[i] in [1,2) -> 0|111 1111 1111|mmmm mmmm mmmm ...
	;                   sign bit ^|^^ exponent ^|^^ mantissa ^^ ...
	vmovq rax, xmm0
	shl rax, 12  ; remove sign (1 bit) + exponent (11 bits)
	shr rax, 64 - M_TRUNC  ; most significant bits of mantissa -> index in table
	shl rax, 4  ; mul 16 (sizeof xmmword ptr)
	lea rcx, log_table
	vmovapd xmm1, xmmword ptr [rcx + rax]  ; [1/a, ln(a)]

	; xmm2: calculate residual, r = x/a - 1.0
	mov rax, 0BFF0000000000000h  ; -1.0
	vmovq xmm2, rax
	vfmadd231sd xmm2, xmm0, xmm1  ; x*(1/a) + (-1.0)

	; xmm0: ln(a)
	_vpermj xmm0, xmm1  ; [ln(a), 1/a]

	; xmm3: P(r) ~= ln(1 + r);
	;	Horner's method: degree 5 minimax polynomial
	vmovapd ymm3, ymmword ptr [coefs + (0)*32]
	_vpermj ymm1, ymm3
	vfmadd132sd xmm3, xmm1, xmm2
	_vpermk ymm1, ymm1
	vfmadd132sd xmm3, xmm1, xmm2
	_vpermj ymm1, ymm1
	vfmadd132sd xmm3, xmm1, xmm2
	vmovapd ymm1, ymmword ptr [coefs + (1)*32]
	vfmadd132sd xmm3, xmm1, xmm2
	_vpermj ymm1, ymm1
	vfmadd132sd xmm3, xmm1, xmm2
	_vpermk ymm1, ymm1
	vfmadd132sd xmm3, xmm1, xmm2
	_vpermj ymm1, ymm1
	vfmadd132sd xmm3, xmm1, xmm2

	; return ln(a) + P(r) ~= ln(x)
	vaddsd xmm0, xmm0, xmm3
	ret
ln ENDP
END
