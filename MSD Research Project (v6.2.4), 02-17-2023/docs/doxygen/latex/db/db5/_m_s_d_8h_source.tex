\hypertarget{_m_s_d_8h_source}{}\doxysection{MSD.\+h}
\label{_m_s_d_8h_source}\index{C:/Users/mathh/GitHub/Molecular-\/Spintronics-\/Research-\/Project/MSD Research Project -\/ Latest Development Version/src/MSD.h@{C:/Users/mathh/GitHub/Molecular-\/Spintronics-\/Research-\/Project/MSD Research Project -\/ Latest Development Version/src/MSD.h}}
\mbox{\hyperlink{_m_s_d_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#ifndef UDC\_MSD}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#define UDC\_MSD}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define UDC\_MSD\_VERSION "{}6.2"{}}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <cstdlib>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <ctime>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <cstring>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <exception>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <random>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_vector_8h}{Vector.h}}"{}}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{udc_8h}{udc.h}}"{}}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{_sparse_array_8h}{SparseArray.h}}"{}}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceudc}{udc}} \{}
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{keyword}{using }std::bind;}
\DoxyCodeLine{37 \textcolor{keyword}{using }std::function;}
\DoxyCodeLine{38 \textcolor{keyword}{using }std::invalid\_argument;}
\DoxyCodeLine{39 \textcolor{keyword}{using }std::mt19937\_64;}
\DoxyCodeLine{40 \textcolor{keyword}{using }std::istream;}
\DoxyCodeLine{41 \textcolor{keyword}{using }std::ostream;}
\DoxyCodeLine{42 \textcolor{keyword}{using }std::streampos;}
\DoxyCodeLine{43 \textcolor{keyword}{using }std::out\_of\_range;}
\DoxyCodeLine{44 \textcolor{keyword}{using }std::ref;}
\DoxyCodeLine{45 \textcolor{keyword}{using }std::string;}
\DoxyCodeLine{46 \textcolor{keyword}{using }std::uniform\_int\_distribution;}
\DoxyCodeLine{47 \textcolor{keyword}{using }std::uniform\_real\_distribution;}
\DoxyCodeLine{48 \textcolor{keyword}{using }std::shared\_ptr;}
\DoxyCodeLine{49 \textcolor{keyword}{using }std::exception;}
\DoxyCodeLine{50 \textcolor{keyword}{using }std::strcmp;}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{keyword}{using }\mbox{\hyperlink{namespaceudc_aa4b4d55516f1e34de5dc8b228f160597}{udc::E}};}
\DoxyCodeLine{53 \textcolor{keyword}{using }\mbox{\hyperlink{namespaceudc_a1757f9fc50446243658974977dd95e7c}{udc::PI}};}
\DoxyCodeLine{54 \textcolor{keyword}{using }\mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{udc::sq}};}
\DoxyCodeLine{55 \textcolor{keyword}{using }\mbox{\hyperlink{classudc_1_1_vector}{udc::Vector}};}
\DoxyCodeLine{56 \textcolor{keyword}{using }\mbox{\hyperlink{classudc_1_1_sparse_array}{udc::SparseArray}};}
\DoxyCodeLine{57 \textcolor{keyword}{using }\mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{udc::bread}};}
\DoxyCodeLine{58 \textcolor{keyword}{using }\mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{udc::bwrite}};}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 }
\DoxyCodeLine{66 \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \{}
\DoxyCodeLine{67     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{namespace_m_s_d}{MSD}};}
\DoxyCodeLine{68     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{NodeIterable}};}
\DoxyCodeLine{69     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}};}
\DoxyCodeLine{70     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}};}
\DoxyCodeLine{71     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73  \textcolor{keyword}{public}:}
\DoxyCodeLine{77     \textcolor{keyword}{struct }\mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}} \{}
\DoxyCodeLine{78         \textcolor{comment}{// nearest-\/neighbor parameters}}
\DoxyCodeLine{79         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_a888be7fafaea5cedfc9f59ce6291a5c8}{Jm}};    \textcolor{comment}{// spin * spin}}
\DoxyCodeLine{80         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_afe9b27d63588d6f6066137961556274b}{Je1m}};  \textcolor{comment}{// spin * flux}}
\DoxyCodeLine{81         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_a8e66fedceee8f6cbd949e2e39f68cb38}{Jeem}};  \textcolor{comment}{// flux * flux}}
\DoxyCodeLine{82         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_ae10a09e2ff621f6427be2bb5a69ba595}{bm}};    \textcolor{comment}{// Biquadratic Coupling}}
\DoxyCodeLine{83         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_a7c1edcd9071395e3e894f12c03a2a8b2}{Dm}};    \textcolor{comment}{// Dzyaloshinskii-\/Moriya interaction (i.e. Skyrmions)}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85         \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_afdea45614d2c2dafb5aedc4cecface74}{EdgeParameters}}();}
\DoxyCodeLine{86     \};}
\DoxyCodeLine{87 }
\DoxyCodeLine{89     \textcolor{keyword}{struct }\mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}} \{}
\DoxyCodeLine{90         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters_aa7b74cbea7b3cba87f57ad48232a3786}{Sm}}, \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters_a0a56503fd7eb794ba63f04a1ec25238e}{Fm}};  \textcolor{comment}{// spin and spin fluctuation magnetude scalars}}
\DoxyCodeLine{91         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters_a297971abdfd713f536d590ef8feb7fbc}{Je0m}};     \textcolor{comment}{// spin * flux (local)}}
\DoxyCodeLine{92         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters_a821f45a250dc5e42bd03ab91e377605f}{Am}};      \textcolor{comment}{// Anisotropy}}
\DoxyCodeLine{93 }
\DoxyCodeLine{94         \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters_a4864f595737510a02a6cda276b3d8f33}{NodeParameters}}();}
\DoxyCodeLine{95     \};}
\DoxyCodeLine{96 }
\DoxyCodeLine{97     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_deserialization_exception}{DeserializationException}} : \textcolor{keyword}{public} \mbox{\hyperlink{classudc_1_1_u_d_c_exception}{UDCException}} \{}
\DoxyCodeLine{98      \textcolor{keyword}{public}:}
\DoxyCodeLine{99         \mbox{\hyperlink{classudc_1_1_molecule_1_1_deserialization_exception_a48c7fdb254d2d146fcfa30ec5f5388ef}{DeserializationException}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *message) : \mbox{\hyperlink{classudc_1_1_u_d_c_exception}{UDCException}}(message) \{\}}
\DoxyCodeLine{100     \};}
\DoxyCodeLine{101 }
\DoxyCodeLine{102  \textcolor{keyword}{private}:}
\DoxyCodeLine{103     \textcolor{keyword}{struct }Node;}
\DoxyCodeLine{104     \textcolor{keyword}{struct }Edge;}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 }
\DoxyCodeLine{107     \textcolor{keyword}{struct }Edge \{}
\DoxyCodeLine{114         \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{_m_s_d-export_8cpp_a1f271f489f903c0f87a909221e674a63}{edgeIndex}}, nodeIndex, selfIndex;}
\DoxyCodeLine{115         }
\DoxyCodeLine{124         \textcolor{keywordtype}{double} direction;}
\DoxyCodeLine{125 }
\DoxyCodeLine{126         Edge(\textcolor{keywordtype}{size\_t} edgeIndex, \textcolor{keywordtype}{size\_t} nodeIndex, \textcolor{keywordtype}{size\_t} selfIndex, \textcolor{keywordtype}{double} direction);}
\DoxyCodeLine{127     \};}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{keyword}{struct }Node \{}
\DoxyCodeLine{130         \mbox{\hyperlink{_m_s_d-export_8cpp_a3ff276dcf7d10876c4783799c899bfd9}{NodeParameters}} parameters;}
\DoxyCodeLine{131         std::vector<Edge> neighbors;}
\DoxyCodeLine{132 }
\DoxyCodeLine{133         Node(\textcolor{keyword}{const} \mbox{\hyperlink{_m_s_d-export_8cpp_a3ff276dcf7d10876c4783799c899bfd9}{NodeParameters}} \&parameters = \mbox{\hyperlink{_m_s_d-export_8cpp_a3ff276dcf7d10876c4783799c899bfd9}{NodeParameters}}());}
\DoxyCodeLine{134     \};}
\DoxyCodeLine{135 }
\DoxyCodeLine{136  \textcolor{comment}{// -\/-\/-\/-\/-\/ Molecule (prototype) fields and methods -\/-\/-\/-\/-\/}}
\DoxyCodeLine{137  \textcolor{keyword}{private}:}
\DoxyCodeLine{138     std::vector<EdgeParameters> edgeParameters;   \textcolor{comment}{// array of edges}}
\DoxyCodeLine{139     std::vector<Node> nodes;  \textcolor{comment}{// array of nodes (e.g. atoms) making up this Molecule}}
\DoxyCodeLine{140     \textcolor{keywordtype}{size\_t} leftLead, rightLead;  \textcolor{comment}{// the position of the nodes connected to the left FM and right FM, respectively.}}
\DoxyCodeLine{141     \textcolor{keywordtype}{size\_t} sSize;  \textcolor{comment}{// size of buffer (bytes) needed for serialization or deserizalization}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143  \textcolor{keyword}{public}:}
\DoxyCodeLine{144     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{char} * \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_a5d2f40b3d48330e1345c68b8b05a18ad}{HEADER}};  \textcolor{comment}{// safety header for (de)serizlization}}
\DoxyCodeLine{145     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classudc_1_1_molecule_a5c178c3e3abe344b6019877b4e877dfa}{HEADER\_SIZE}};  \textcolor{comment}{// size of HEADER string (not including null-\/terminator, '\(\backslash\)0'): strlen(HEADER)}}
\DoxyCodeLine{146     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_a1b9d46a0051e4ddbb66f8b0322844dda}{NOT\_FOUND}} = (\textcolor{keywordtype}{unsigned} int) -\/1;  \textcolor{comment}{// -\/1 will be the maximum unsigned int}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148  \textcolor{keyword}{public}:}
\DoxyCodeLine{153     \mbox{\hyperlink{classudc_1_1_molecule_a4a38e660030e37a46905b99fb87be886}{Molecule}}();}
\DoxyCodeLine{154 }
\DoxyCodeLine{162     \mbox{\hyperlink{classudc_1_1_molecule_a4a38e660030e37a46905b99fb87be886}{Molecule}}(\textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}}, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}} \&nodeParams = \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}}());}
\DoxyCodeLine{163 }
\DoxyCodeLine{164     \textcolor{comment}{// Molecule(const Molecule \&other);        // use default copy-\/constructor}}
\DoxyCodeLine{165     \textcolor{comment}{// bool operator=(const Molecule \&other);  // use default assignment operator}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167  \textcolor{keyword}{public}:}
\DoxyCodeLine{168     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a682c1855e517d0c2b68118b114d31d15}{serialize}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *buffer) \textcolor{keyword}{const};  \textcolor{comment}{// store this Molecule object into the given buffer}}
\DoxyCodeLine{169     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_ac8c39d99187f0dae0b0fe7ef7e935a0d}{deserialize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *buffer);  \textcolor{comment}{// reconstruct this Molecule object using the given buffer}}
\DoxyCodeLine{170     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classudc_1_1_molecule_a9fc6cbb7d10939477c3abcefd319ae54}{serializationSize}}() \textcolor{keyword}{const};  \textcolor{comment}{// the size needed (in bytes) to serialize this Molecule object}}
\DoxyCodeLine{171 }
\DoxyCodeLine{172     istream\& \mbox{\hyperlink{classudc_1_1_molecule_aedb314ce8b1dff4ecf156d6e739d170f}{read}}(istream \&in);  \textcolor{comment}{// reads the serialized data from the given binary istream}}
\DoxyCodeLine{173     ostream\& \mbox{\hyperlink{classudc_1_1_molecule_a59ea4534de4d263562db48eac48a68cc}{write}}(ostream \&out) \textcolor{keyword}{const};  \textcolor{comment}{// writes the serialized data to the given binary ostream}}
\DoxyCodeLine{174     \textcolor{keyword}{static} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \mbox{\hyperlink{classudc_1_1_molecule_a97742a892262f853a7ec68d982d68fae}{load}}(istream \&in);  \textcolor{comment}{// same as read, but constructs and returns a new Molecule (MSD::MolProto) object}}
\DoxyCodeLine{175 }
\DoxyCodeLine{179     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_ab18585360b5c1577f6be8cc1f565b260}{createNode}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}} \&parameters = \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}}());}
\DoxyCodeLine{180 }
\DoxyCodeLine{185     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}}() \textcolor{keyword}{const};}
\DoxyCodeLine{186 }
\DoxyCodeLine{194     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_ae1411a791a83503073a9dc8a7b1d3b33}{connectNodes}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nodeA, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nodeB, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}} \&parameters = \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}}());}
\DoxyCodeLine{195 }
\DoxyCodeLine{200     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_a41ffa48f091303c3178c8e783cc3142e}{edgeIndex}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nodeA, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nodeB) \textcolor{keyword}{const};}
\DoxyCodeLine{201 }
\DoxyCodeLine{202     \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}} \mbox{\hyperlink{classudc_1_1_molecule_a012b0e0a805476ae9e80673b9070db86}{getEdgeParameters}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index) \textcolor{keyword}{const};}
\DoxyCodeLine{203     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a303bb5e1cc934255220e58949e345065}{setEdgeParameters}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}} \&p);}
\DoxyCodeLine{204     \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}} \mbox{\hyperlink{classudc_1_1_molecule_aee4baa13cfc0b0584ec8e2c5000a76be}{getNodeParameters}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index) \textcolor{keyword}{const};}
\DoxyCodeLine{205     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_ad13bc013a1031b8379ee7f134ce4724e}{setNodeParameters}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}} \&p);}
\DoxyCodeLine{206     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a401ed0509649570cc636b5a08735cbd6}{setAllParameters}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{Molecule::NodeParameters}} \&nodeParams, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{Molecule::EdgeParameters}} \&edgeParams);}
\DoxyCodeLine{207 }
\DoxyCodeLine{208     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a055eb97e7305e44ebb8a0d22a23f6752}{setLeftLead}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} node);}
\DoxyCodeLine{209     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a549536b6815dd4ffcedb3ab3895a064f}{setRightLead}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} node);}
\DoxyCodeLine{210     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a57552dd57e092b3d7bc5e2e13e2a419a}{setLeads}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} left, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} right);}
\DoxyCodeLine{211     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_ab2718d472f48420e4ae77827c2753f9a}{getLeftLead}}() \textcolor{keyword}{const};}
\DoxyCodeLine{212     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_a09895cda60e964b18e0c38384e5f3a89}{getRightLead}}() \textcolor{keyword}{const};}
\DoxyCodeLine{213     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a8eacb4f3318b2d68c571cafb56a956ba}{getLeads}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&left, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&right) \textcolor{keyword}{const};}
\DoxyCodeLine{214 }
\DoxyCodeLine{215     \textcolor{comment}{// Iterators}}
\DoxyCodeLine{216     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{NodeIterable}};}
\DoxyCodeLine{217     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}};}
\DoxyCodeLine{218 }
\DoxyCodeLine{219     \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{NodeIterable}} \mbox{\hyperlink{classudc_1_1_molecule_a57560cc5b9d4d5971c16566f77e2e279}{getNodes}}() \textcolor{keyword}{const};  \textcolor{comment}{// iterates over all nodes in the Molecule }}
\DoxyCodeLine{220     \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}} \mbox{\hyperlink{classudc_1_1_molecule_afc512c8f695a33e8918bd20912beb8cd}{getEdges}}() \textcolor{keyword}{const};  \textcolor{comment}{// iterates over all the edges in the entire Molecule}}
\DoxyCodeLine{221     \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}} \mbox{\hyperlink{classudc_1_1_molecule_a48c40b90cb716c63b0a3c6b2a39d4805}{getAdjacencyList}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nodeIndex) \textcolor{keyword}{const};  \textcolor{comment}{// iterates over the edges (i.e. adjacency list) of a given node}}
\DoxyCodeLine{222     \textcolor{comment}{// Note: changes to the molecule invalidate all previously constructed Iterable or Iterator objects}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \{}
\DoxyCodeLine{225         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{NodeIterable}};}
\DoxyCodeLine{226 }
\DoxyCodeLine{227      \textcolor{keyword}{private}:}
\DoxyCodeLine{228         \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{NodeIterable}} \&iterable;}
\DoxyCodeLine{229         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx;}
\DoxyCodeLine{230 }
\DoxyCodeLine{231         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{NodeIterable}} \&nodes, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx);}
\DoxyCodeLine{232     }
\DoxyCodeLine{233      \textcolor{keyword}{public}:}
\DoxyCodeLine{234         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_add4653d895f324444b7d295a35e6ca00}{getIndex}}() \textcolor{keyword}{const};}
\DoxyCodeLine{235         \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a04119ad80998be7ebd7207d360e638c8}{getParameters}}() \textcolor{keyword}{const};}
\DoxyCodeLine{236         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a0acdd22957b069b97f55d993aa6e5829}{getNeighbors}}() \textcolor{keyword}{const};}
\DoxyCodeLine{237 }
\DoxyCodeLine{238         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a90229c78c03c1801f453149a9937bde3}{operator*}}() \textcolor{keyword}{const};}
\DoxyCodeLine{239         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_ac47692c114579ddc642d0b1c52b52131}{operator[]}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{240         \textcolor{keyword}{operator} \textcolor{keywordtype}{unsigned} int() \textcolor{keyword}{const};}
\DoxyCodeLine{241         }
\DoxyCodeLine{242         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a7e91c5498ef57076c1ae1fab987aad5d}{operator++}}();}
\DoxyCodeLine{243         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a7e91c5498ef57076c1ae1fab987aad5d}{operator++}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{244         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a8fa5a9c55ba31ba6764381dccf744d7d}{operator-\/-\/}}();}
\DoxyCodeLine{245         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a8fa5a9c55ba31ba6764381dccf744d7d}{operator-\/-\/}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{246         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a207d566d2d8896940834b2f31d9f1d06}{operator+=}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{247         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a304236b160397a0acafb9da86f11c35a}{operator-\/=}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{248         }
\DoxyCodeLine{249         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a8772bf176b248dc6516aeb05d215b613}{operator+}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{250         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a9d35b7c2a293de896beb459ef28bec3d}{operator-\/}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{251         }
\DoxyCodeLine{252         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_acdccb03fb3f35569ef320751b63e325d}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{253         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_aaf5e7cd3552fccdb68d144d5a1811875}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{254         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a963b18b0c35d0d571887387fc7934a51}{operator>}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{255         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a9005e6f852dde85e408d2c82800dd01e}{operator<}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{256         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a6188db396027c98c9df61689eaa7b16d}{operator>=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{257         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a383142fbdb73230ae1351ebc344c6cc1}{operator<=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{258     \};}
\DoxyCodeLine{259 }
\DoxyCodeLine{260     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{NodeIterable}} \{}
\DoxyCodeLine{261         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule}{Molecule}};}
\DoxyCodeLine{262         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}};}
\DoxyCodeLine{263 }
\DoxyCodeLine{264      \textcolor{keyword}{private}:}
\DoxyCodeLine{265         \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&mol;}
\DoxyCodeLine{266         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \_begin;}
\DoxyCodeLine{267         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \_end;}
\DoxyCodeLine{268     }
\DoxyCodeLine{269         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{NodeIterable}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&mol);}
\DoxyCodeLine{270     }
\DoxyCodeLine{271      \textcolor{keyword}{public}:}
\DoxyCodeLine{272         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable_a93ca9f19d78899a40883db494030f979}{begin}}() \textcolor{keyword}{const};}
\DoxyCodeLine{273         \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable_a767f322c4ff11ee1186d25c7b7f9cbba}{end}}() \textcolor{keyword}{const};}
\DoxyCodeLine{274         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable_ac011c126be9e17781413d20b3a948a80}{size}}() \textcolor{keyword}{const};}
\DoxyCodeLine{275     \};}
\DoxyCodeLine{276 }
\DoxyCodeLine{277     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \{}
\DoxyCodeLine{278         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}};}
\DoxyCodeLine{279 }
\DoxyCodeLine{280      \textcolor{keyword}{private}:}
\DoxyCodeLine{281         \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}} \&iterable;}
\DoxyCodeLine{282         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx;  \textcolor{comment}{// idx of edges iterable. not nessesarily the same as the "{}edgeIndex"{} returned by Molecule::connectNodes}}
\DoxyCodeLine{283 }
\DoxyCodeLine{284         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}} \&edges, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx);}
\DoxyCodeLine{285 }
\DoxyCodeLine{286         \textcolor{keyword}{const} Edge\& getEdge() \textcolor{keyword}{const};  \textcolor{comment}{// helper method}}
\DoxyCodeLine{287 }
\DoxyCodeLine{288      \textcolor{keyword}{public}:}
\DoxyCodeLine{289         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_ad88f7e40ebfe2511a137aa4c92e1d51a}{getIndex}}() \textcolor{keyword}{const};}
\DoxyCodeLine{290         \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a09e7bf9b99075469f710f08beea71685}{getParameters}}() \textcolor{keyword}{const};}
\DoxyCodeLine{291         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a72e95da607f48a728dd556cda7e207ae}{src}}() \textcolor{keyword}{const};  \textcolor{comment}{// (index of) source node}}
\DoxyCodeLine{292         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_ab072345b8ea0ec27afc7772f9c0a7c1a}{dest}}() \textcolor{keyword}{const};  \textcolor{comment}{// (index of) destination node}}
\DoxyCodeLine{293         \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a30e4e4bd72065262b480647727a756f4}{getDirection}}() \textcolor{keyword}{const};  \textcolor{comment}{// direction of node: either 1.0, -\/1.0, or 0.0}}
\DoxyCodeLine{294 }
\DoxyCodeLine{295         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a57789b552f047e491ef01f662f4cb0d3}{operator*}}() \textcolor{keyword}{const};}
\DoxyCodeLine{296         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a474258db92785d660b20d5199f2dad29}{operator[]}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{297         \textcolor{keyword}{operator} \textcolor{keywordtype}{unsigned} int() \textcolor{keyword}{const};}
\DoxyCodeLine{298         }
\DoxyCodeLine{299         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a7f4f13887c99c74b0dbfdaac40d01472}{operator++}}();}
\DoxyCodeLine{300         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a7f4f13887c99c74b0dbfdaac40d01472}{operator++}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{301         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a68c1eea291e0a2b6e8240582366e2067}{operator-\/-\/}}();}
\DoxyCodeLine{302         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a68c1eea291e0a2b6e8240582366e2067}{operator-\/-\/}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{303         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_acbfe20ee73fe60d7dc5f9113184aa243}{operator+=}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{304         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a81a47567f40b2f2b59a00e623ae0ba7d}{operator-\/=}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{305         }
\DoxyCodeLine{306         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a8eb84273f87c1ba1bdc95ed7a38bdb74}{operator+}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{307         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_af2a54a5b128f4bce68c21aa3156df2e6}{operator-\/}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{308         }
\DoxyCodeLine{309         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a9caef518cfd1939e0fc1c054fdebc2fb}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{310         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a3308b9ac135787346d5068f6c73d3650}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{311         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a808406f7eac9b3b8502d0c89030b4e79}{operator>}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{312         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_af0de103fa148c030788a5715f3c46b72}{operator<}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{313         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_abcb719bc3b5ac22fa2a6b5895ec4070b}{operator>=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{314         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_ac42d179444c1f9a7b47245cd3d472847}{operator<=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{315     \};}
\DoxyCodeLine{316 }
\DoxyCodeLine{317     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}} \{}
\DoxyCodeLine{318         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule}{Molecule}};}
\DoxyCodeLine{319         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}};}
\DoxyCodeLine{320     }
\DoxyCodeLine{321      \textcolor{keyword}{private}:}
\DoxyCodeLine{322         \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&mol;}
\DoxyCodeLine{323         std::vector<Edge> edges;}
\DoxyCodeLine{324 }
\DoxyCodeLine{325         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&);}
\DoxyCodeLine{326         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} node);}
\DoxyCodeLine{327     }
\DoxyCodeLine{328      \textcolor{keyword}{public}:}
\DoxyCodeLine{329         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable_a6ad09c81e1ffd3a9d71ba1db9073e6cc}{begin}}() \textcolor{keyword}{const};}
\DoxyCodeLine{330         \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable_a25744b1ee7e22c419406eed7c40c8e29}{end}}() \textcolor{keyword}{const};}
\DoxyCodeLine{331         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable_af058dfb0b3208a64abd7d1c5ace96783}{size}}() \textcolor{keyword}{const};}
\DoxyCodeLine{332     \};}
\DoxyCodeLine{333 }
\DoxyCodeLine{334  \textcolor{comment}{// -\/-\/-\/-\/-\/ Molecule::Instance stuff -\/-\/-\/-\/-\/}}
\DoxyCodeLine{335  \textcolor{keyword}{private}:}
\DoxyCodeLine{340     \textcolor{keyword}{class }Instance \{}
\DoxyCodeLine{341         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_molecule}{Molecule}};}
\DoxyCodeLine{342         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{namespace_m_s_d}{MSD}};}
\DoxyCodeLine{343     }
\DoxyCodeLine{344      \textcolor{keyword}{private}:}
\DoxyCodeLine{345         \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&prototype;  \textcolor{comment}{// contains a reference to the the Molecular structure and parameters}}
\DoxyCodeLine{346         \mbox{\hyperlink{namespace_m_s_d}{MSD}} \&msd;  \textcolor{comment}{// a reference to the MSD this Molecule::Instace is attached to}}
\DoxyCodeLine{347         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, z;  \textcolor{comment}{// the (x,y,z) position of this Molecule::Instance. Note: the mol's x position is determined by msd.molPosL, msd.molPosR.  }}
\DoxyCodeLine{348         std::vector<Vector> spins;  \textcolor{comment}{// states of each "{}Node"{}}}
\DoxyCodeLine{349         std::vector<Vector> fluxes;}
\DoxyCodeLine{350 }
\DoxyCodeLine{374         Instance(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&prototype, \mbox{\hyperlink{namespace_m_s_d}{MSD}} \&msd, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z,}
\DoxyCodeLine{375                 \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&initSpin = \mbox{\hyperlink{classudc_1_1_vector_a969618e05cff7f052ae3e9fcf7b49104}{Vector::J}}, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&initFlux = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}});}
\DoxyCodeLine{376         Instance(\textcolor{keyword}{const} Instance \&other);}
\DoxyCodeLine{377 }
\DoxyCodeLine{378         Instance\& operator=(\textcolor{keyword}{const} Instance \&other);  \textcolor{comment}{// copies the spin/flux states}}
\DoxyCodeLine{379     }
\DoxyCodeLine{380      \textcolor{keyword}{public}:}
\DoxyCodeLine{381         \textcolor{keywordtype}{void} setLocalM(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux);}
\DoxyCodeLine{382         \textcolor{keywordtype}{void} setSpin(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin);}
\DoxyCodeLine{383         \textcolor{keywordtype}{void} setFlux(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux);}
\DoxyCodeLine{384         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} getSpin(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a) \textcolor{keyword}{const};}
\DoxyCodeLine{385         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} getFlux(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a) \textcolor{keyword}{const};}
\DoxyCodeLine{386         \textcolor{keywordtype}{void} getLocalM(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin, \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux) \textcolor{keyword}{const};}
\DoxyCodeLine{387     \};}
\DoxyCodeLine{388 }
\DoxyCodeLine{392     Instance instantiate(\mbox{\hyperlink{namespace_m_s_d}{MSD}} \&msd, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z) \textcolor{keyword}{const};}
\DoxyCodeLine{393 \};}
\DoxyCodeLine{394 }
\DoxyCodeLine{395 }
\DoxyCodeLine{399 \textcolor{keyword}{class }\mbox{\hyperlink{namespace_m_s_d}{MSD}} \{}
\DoxyCodeLine{400  \textcolor{keyword}{public}:}
\DoxyCodeLine{401     \textcolor{keyword}{typedef} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \mbox{\hyperlink{classudc_1_1_m_s_d_a7266f08d021d5a06960b152c95a9213e}{MolProto}};}
\DoxyCodeLine{402     \textcolor{keyword}{typedef} Molecule::Instance \mbox{\hyperlink{classudc_1_1_m_s_d_ab3c0b3e8474e18cb213f79d66f221b67}{Mol}};}
\DoxyCodeLine{403     \textcolor{keyword}{typedef} function<\mbox{\hyperlink{classudc_1_1_m_s_d_a7266f08d021d5a06960b152c95a9213e}{MolProto}} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int})> \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MolProtoFactory}};}
\DoxyCodeLine{404     \textcolor{keyword}{typedef} function<\mbox{\hyperlink{classudc_1_1_vector}{Vector}} (\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&, function<\textcolor{keywordtype}{double}()>)> \mbox{\hyperlink{classudc_1_1_m_s_d_a3d235795ecc459cc0c2069c3f05d089d}{FlippingAlgorithm}};}
\DoxyCodeLine{405     }
\DoxyCodeLine{406     \textcolor{comment}{// needed so these methods can update energy and magnetization of the MSD}}
\DoxyCodeLine{407     \textcolor{keyword}{friend} \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{Mol::setLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux);}
\DoxyCodeLine{408     \textcolor{keyword}{friend} \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a4d4a91fd46eec66e753dfa2642c25068}{Mol::setSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin);}
\DoxyCodeLine{409     \textcolor{keyword}{friend} \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a0bb8c1e9fef1960578abc46446380dbf}{Mol::setFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux);}
\DoxyCodeLine{410 }
\DoxyCodeLine{411     \textcolor{keyword}{struct }\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{Parameters}} \{}
\DoxyCodeLine{412         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aea19a4bd6b6b630bb5255c6f3206d67d}{kT}};  \textcolor{comment}{// Temperature}}
\DoxyCodeLine{413         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a7df654a8138c850e64de4adea7c5776a}{B}};  \textcolor{comment}{// Magnetic field}}
\DoxyCodeLine{414         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9347bd5ecace963e09c974e2e6236f40}{SL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aad0f4bd2d0ba9b01de8f6830b4d77f09}{SR}};  \textcolor{comment}{// spin magnitudes}}
\DoxyCodeLine{415         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a55712b42b9d9460519b2ffc4a24cdd96}{FL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a3b84c7bdff2e5acbf7e2aee9f4f87380}{FR}};  \textcolor{comment}{// Spin fluctuation constants, flux.norm() = uniform random between [0, F)}}
\DoxyCodeLine{416         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a4de534ffb37d66a609206ecfbc79a4a3}{JL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a626eb888da1ae30b0fd04fd60bbf5b4a}{JR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a570769f809bfc17b833b760025d54635}{JmL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a11d9a80a263371635f53ad14232b7c10}{JmR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a876665131291f40627d234de2636e7a5}{JLR}};  \textcolor{comment}{// Heisenberg exchange coupling between s\_i and s\_j: local spin and neighboring spins}}
\DoxyCodeLine{417         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a38fbdb6de5465d21767e5acdd70e4e46}{Je0L}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a0fd1a65ab83a4cfc0aed753762a71f1c}{Je0R}};  \textcolor{comment}{// Exchange coupling between s\_i and f\_i: local spin and local flux vector}}
\DoxyCodeLine{418         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_adab3e0cfbf9f3c60b828d70e9a7853cd}{Je1L}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a1f5a1b2902f4152f4027c9a6d66546dd}{Je1R}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_acf66b51f1494866fe609eabf57790989}{Je1mL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a6357fcbf8fe7d799c10bb33853fe5fd7}{Je1mR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_afe51f061d0cda85616e3a04ecb34cb85}{Je1LR}};  \textcolor{comment}{// Exchange coupling between s\_i and f\_j: local spin and neighboring flux vectors}}
\DoxyCodeLine{419         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a01e7b66d243045c1253a7f2e8c70ab03}{JeeL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a4d3e4c3b64dfded7ac1c07c45f71fb6e}{JeeR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aed49e5aed77920be09b8323a0cee2781}{JeemL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aa2775ee2661215984de3caf7832c0f13}{JeemR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a316117cf75ee335416c34e938960b8a1}{JeeLR}};  \textcolor{comment}{// Exchange coupling between f\_i and f\_j: local flux and neighboring flux vectors}}
\DoxyCodeLine{420         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_afe3cfa8886ebb734fbe817c8dd254d8f}{bL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9e807cec26c1219ef16f3e26f67a926a}{bR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ac35c301b854f5d76621b39774776bf22}{bmL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a0f4027af582ca01b7db0941641227ac5}{bmR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a022b5b93636d04f81172635825796469}{bLR}};  \textcolor{comment}{// Biquadratic Coupling}}
\DoxyCodeLine{421         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9d8c4ad2396d258736c0d5985feaca55}{AL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aa97373f0348686a6f2c1abbbf35aeb1a}{AR}};  \textcolor{comment}{// Anisotropy}}
\DoxyCodeLine{422         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_af8bbfb0d4941170abb9cb20874d37177}{DL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a6c585701e1e89a881bbfe9d1eee5d64c}{DR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_af0493729f1925de734f4d595643fa09f}{DmL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a2bf4786615f44fd118d255aa59bf8190}{DmR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ab293ea7698715b6f29b0c0b007a85a4e}{DLR}};  \textcolor{comment}{// Dzyaloshinskii-\/Moriya interaction (i.e. Skyrmions)}}
\DoxyCodeLine{423         }
\DoxyCodeLine{424         \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ad972cfd353c72aa28063ac74d9bed3cf}{Parameters}}();}
\DoxyCodeLine{425         }
\DoxyCodeLine{426         \textcolor{keywordtype}{bool} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a7a0a0b93af506366c206f39a8adabfa9}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{Parameters}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{427         \textcolor{keywordtype}{bool} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ae6d8e34b3fb5bf65b69b8fd7b870d71a}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{Parameters}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{428     \};}
\DoxyCodeLine{429     }
\DoxyCodeLine{430     \textcolor{keyword}{struct }\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \{}
\DoxyCodeLine{431         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};  \textcolor{comment}{// time, i.e. current iteration}}
\DoxyCodeLine{432         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}};  \textcolor{comment}{// Magnetization}}
\DoxyCodeLine{433         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_aeae2f7666be87f8d4499d612567fe71a}{MS}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a020102ea8f3621b4791a75de90624ade}{MSL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66823c7a278ea165067eadaf62c976d0}{MSR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a42f24fd034f5acf41d415093def18fa5}{MSm}};  \textcolor{comment}{// Magnetization due to spin only (no flux)}}
\DoxyCodeLine{434         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a789b09f14dc037a00b59733ef5e6b8fe}{MF}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1a6be402d985814748b000dce6b983e9}{MFL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66d2b20d7c955c704ce31b355419ee45}{MFR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac3c2f0d86900c360181e14073842f9a5}{MFm}};  \textcolor{comment}{// Magnetization due to flux only (no spin) }}
\DoxyCodeLine{435         \textcolor{keywordtype}{double} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}}, \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}};  \textcolor{comment}{// Internal Energy}}
\DoxyCodeLine{436         }
\DoxyCodeLine{437         \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_acab69dbb27e71f71fd874272e036dcc6}{Results}}();}
\DoxyCodeLine{438         }
\DoxyCodeLine{439         \textcolor{keywordtype}{bool} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab6fb2b0afd66ea58ae596c7d34bd42f0}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{440         \textcolor{keywordtype}{bool} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_aedd99e890f8609ae49464003794fd263}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{441     \};}
\DoxyCodeLine{442     }
\DoxyCodeLine{443     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \{}
\DoxyCodeLine{444         \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{namespace_m_s_d}{MSD}};}
\DoxyCodeLine{445         }
\DoxyCodeLine{446      \textcolor{keyword}{private}:}
\DoxyCodeLine{447         \textcolor{keyword}{const} \mbox{\hyperlink{namespace_m_s_d}{MSD}} \&msd;}
\DoxyCodeLine{448         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i;  \textcolor{comment}{// index in msd::indicies}}
\DoxyCodeLine{449         }
\DoxyCodeLine{450         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespace_m_s_d}{MSD}} \&, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i);}
\DoxyCodeLine{451         }
\DoxyCodeLine{452      \textcolor{keyword}{public}:}
\DoxyCodeLine{453         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a8ad36deb75ea34c351470a210dc5f8df}{getIndex}}() \textcolor{keyword}{const};}
\DoxyCodeLine{454         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aff3d00d1f3d3abc57ab3e1708f22046e}{getX}}() \textcolor{keyword}{const};}
\DoxyCodeLine{455         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a74a04cdef90898fe9ecac8fe91a67cec}{getY}}() \textcolor{keyword}{const};}
\DoxyCodeLine{456         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a6b7cdba16db28e6b16dbf1f60361a83b}{getZ}}() \textcolor{keyword}{const};}
\DoxyCodeLine{457         }
\DoxyCodeLine{458         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_afea68bb7dba79b2747964d9d1d52cdfe}{getSpin}}() \textcolor{keyword}{const};}
\DoxyCodeLine{459         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_abd996192129eb23f7679d731bb831e08}{getFlux}}() \textcolor{keyword}{const};}
\DoxyCodeLine{460         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a8c8ea6d938c5e7497e26d36bd603c7b3}{getLocalM}}() \textcolor{keyword}{const};}
\DoxyCodeLine{461         }
\DoxyCodeLine{462         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_abb6e962e7a330c8a6deb53b4af1a33eb}{operator*}}() \textcolor{keyword}{const};}
\DoxyCodeLine{463         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a9d84bb256488be2f19c519c1edc94bf2}{operator[]}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{464         \textcolor{keyword}{operator} \textcolor{keywordtype}{unsigned} int() \textcolor{keyword}{const};}
\DoxyCodeLine{465         }
\DoxyCodeLine{466         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}}\& \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aa2acdacfb5a3b245e86d52caf6ccee5b}{operator++}}();}
\DoxyCodeLine{467         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aa2acdacfb5a3b245e86d52caf6ccee5b}{operator++}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{468         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}}\& \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a9b7068af2426eff599c7898cc556d80c}{operator-\/-\/}}();}
\DoxyCodeLine{469         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a9b7068af2426eff599c7898cc556d80c}{operator-\/-\/}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{470         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}}\& \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_ae6a30558ca84c5c83e220f5f565c9337}{operator+=}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{471         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}}\& \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_ae815a105b76ecd74ffbca42059dd66d5}{operator-\/=}}(\textcolor{keywordtype}{int});}
\DoxyCodeLine{472         }
\DoxyCodeLine{473         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a36610ced86cca4e0b20b3cae881bc949}{operator+}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{474         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_ad552ff63add04ee2f65ce2b635c82a3f}{operator-\/}}(\textcolor{keywordtype}{int}) \textcolor{keyword}{const};}
\DoxyCodeLine{475         }
\DoxyCodeLine{476         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aa5f4db2e3ab06026529de54a9c22b7a4}{operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{477         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_abfe94ce7e6d750efea5d32a705fe3cd3}{operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{478         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a066d2acce9354012cdbf70dcc7b4cc99}{operator>}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{479         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aa1571de940e3cd6061568b26f6fd27c8}{operator<}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{480         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a62aed3f164b19a1581de95ddee11cde9}{operator>=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{481         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a7c6a05177dd8932f7baa9aa441a59096}{operator<=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&) \textcolor{keyword}{const};}
\DoxyCodeLine{482     \};}
\DoxyCodeLine{483 }
\DoxyCodeLine{484     \textcolor{keyword}{class }\mbox{\hyperlink{classudc_1_1_m_s_d_1_1_molecule_exception}{MoleculeException}} : \textcolor{keyword}{public} \mbox{\hyperlink{classudc_1_1_u_d_c_exception}{UDCException}} \{}
\DoxyCodeLine{485      \textcolor{keyword}{public}:}
\DoxyCodeLine{486         \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_molecule_exception_a368380a2e67e7ed48071a43c9dab6613}{MoleculeException}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *message) : \mbox{\hyperlink{classudc_1_1_u_d_c_exception}{UDCException}}(message) \{\}}
\DoxyCodeLine{487     \};}
\DoxyCodeLine{488     }
\DoxyCodeLine{489     \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_a3d235795ecc459cc0c2069c3f05d089d}{FlippingAlgorithm}} \mbox{\hyperlink{classudc_1_1_m_s_d_a7010b43c1e96eca520bcefba7aa36ad3}{UP\_DOWN\_MODEL}};}
\DoxyCodeLine{490     \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_a3d235795ecc459cc0c2069c3f05d089d}{FlippingAlgorithm}} \mbox{\hyperlink{classudc_1_1_m_s_d_a82cedfe873fa654afa32ab3d1b6f3ead}{CONTINUOUS\_SPIN\_MODEL}};}
\DoxyCodeLine{491     }
\DoxyCodeLine{492     \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MolProtoFactory}} \mbox{\hyperlink{classudc_1_1_m_s_d_ac578f0076fce752e661058c648d88997}{LINEAR\_MOL}};}
\DoxyCodeLine{493     \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MolProtoFactory}} \mbox{\hyperlink{classudc_1_1_m_s_d_a72708188b46e1ddffb7c6e2fec96c587}{CIRCULAR\_MOL}};}
\DoxyCodeLine{494 }
\DoxyCodeLine{495  \textcolor{keyword}{private}:}
\DoxyCodeLine{496     \textcolor{keyword}{static} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} initSpin; \textcolor{comment}{//initial spin of all atoms}}
\DoxyCodeLine{497     \textcolor{keyword}{static} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} initFlux; \textcolor{comment}{//initial spin fluctuation (direction only) for each atom}}
\DoxyCodeLine{498     }
\DoxyCodeLine{499     \mbox{\hyperlink{classudc_1_1_sparse_array}{SparseArray<Vector>}} spins;}
\DoxyCodeLine{500     \mbox{\hyperlink{classudc_1_1_sparse_array}{SparseArray<Vector>}} fluxes;}
\DoxyCodeLine{501     \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{Parameters}} parameters;}
\DoxyCodeLine{502     \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} results;}
\DoxyCodeLine{503     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, height, depth;}
\DoxyCodeLine{504     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosL, molPosR;}
\DoxyCodeLine{505     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} topL, bottomL, frontR, backR;  \textcolor{comment}{// "{}inner sizes/boundaries"{}}}
\DoxyCodeLine{506     }
\DoxyCodeLine{507     \mbox{\hyperlink{classudc_1_1_molecule}{MolProto}} molProto;                  \textcolor{comment}{// Contains the prototype for the molecule instances}}
\DoxyCodeLine{508     \mbox{\hyperlink{classudc_1_1_sparse_array}{SparseArray<shared\_ptr<Mol>}}> mols;  \textcolor{comment}{// Contains the molecule instances. Uses the same indexing as spins and fluxes.}}
\DoxyCodeLine{509                                         \textcolor{comment}{// Note: Mol the same Mol object is pointed for all x where y,z remain constant.}}
\DoxyCodeLine{510     }
\DoxyCodeLine{511     \textcolor{comment}{// number of atoms in both the entire device (n) and in each region (nL, nR, etc.)}}
\DoxyCodeLine{512     \textcolor{comment}{// n\_mL, n\_mR, mLR are defined as twice the number of bonds since these regions exist only as an interaction between two regions.}}
\DoxyCodeLine{513     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} n, nL, nR, n\_m, n\_mL, n\_mR, nLR;}
\DoxyCodeLine{514 }
\DoxyCodeLine{515     \textcolor{comment}{// flags for each region to remember if they exist based on given dimensions and inner bounds}}
\DoxyCodeLine{516     \textcolor{keywordtype}{bool} FM\_L\_exists, FM\_R\_exists, mol\_exists;}
\DoxyCodeLine{517     }
\DoxyCodeLine{518     std::vector<unsigned int> indices; \textcolor{comment}{// valid indices}}
\DoxyCodeLine{519     std::vector<unsigned int> unique\_mol\_indices;  \textcolor{comment}{// valid indices for each unique mol. (x == molPosL)}}
\DoxyCodeLine{520     }
\DoxyCodeLine{521     mt19937\_64 prng; \textcolor{comment}{//pseudo random number generator}}
\DoxyCodeLine{522     uniform\_real\_distribution<double> rand; \textcolor{comment}{//uniform probability density function on the interval [0, 1)}}
\DoxyCodeLine{523     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} seed; \textcolor{comment}{//store seed so that every run can follow the same sequence}}
\DoxyCodeLine{524     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} seed\_count; \textcolor{comment}{//to help keep seeds from repeating because of temporal proximity}}
\DoxyCodeLine{525     }
\DoxyCodeLine{526     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z) \textcolor{keyword}{const};}
\DoxyCodeLine{527     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a) \textcolor{keyword}{const};}
\DoxyCodeLine{528     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a) \textcolor{keyword}{const};}
\DoxyCodeLine{529     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a) \textcolor{keyword}{const};}
\DoxyCodeLine{530     }
\DoxyCodeLine{531     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} genSeed(); \textcolor{comment}{//generates a new seed}}
\DoxyCodeLine{532     }
\DoxyCodeLine{533     \mbox{\hyperlink{namespace_m_s_d}{MSD}}\& operator=(\textcolor{keyword}{const} \mbox{\hyperlink{namespace_m_s_d}{MSD}}\&); \textcolor{comment}{//undefined, do not use!}}
\DoxyCodeLine{534     \mbox{\hyperlink{namespace_m_s_d}{MSD}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespace_m_s_d}{MSD}} \&m); \textcolor{comment}{//undefined, do not use!}}
\DoxyCodeLine{535 }
\DoxyCodeLine{536     \textcolor{keywordtype}{void} init(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MolProtoFactory}} *molProtoFactory = NULL);}
\DoxyCodeLine{537     }
\DoxyCodeLine{538  \textcolor{keyword}{public}:}
\DoxyCodeLine{539     std::vector<Results> \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}};}
\DoxyCodeLine{540     \mbox{\hyperlink{classudc_1_1_m_s_d_a3d235795ecc459cc0c2069c3f05d089d}{FlippingAlgorithm}} \mbox{\hyperlink{classudc_1_1_m_s_d_a2ccd325cf09e82420004de9702894de5}{flippingAlgorithm}}; \textcolor{comment}{//algorithm used to "{}flip"{} an atom in metropolis}}
\DoxyCodeLine{541     }
\DoxyCodeLine{542     \mbox{\hyperlink{namespace_m_s_d}{MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth,}
\DoxyCodeLine{543             \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{MolProto}} \&molProto, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosL,}
\DoxyCodeLine{544             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} topL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bottomL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} frontR, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} backR);}
\DoxyCodeLine{545     \mbox{\hyperlink{namespace_m_s_d}{MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth,}
\DoxyCodeLine{546             \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MolProtoFactory}} \&molType, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosR,}
\DoxyCodeLine{547             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} topL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bottomL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} frontR, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} backR);}
\DoxyCodeLine{548     \mbox{\hyperlink{namespace_m_s_d}{MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth,}
\DoxyCodeLine{549             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosR,}
\DoxyCodeLine{550             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} topL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bottomL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} frontR, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} backR);}
\DoxyCodeLine{551     \mbox{\hyperlink{namespace_m_s_d}{MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth,}
\DoxyCodeLine{552             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} heightL, \textcolor{keywordtype}{unsigned} depthR);}
\DoxyCodeLine{553     \mbox{\hyperlink{namespace_m_s_d}{MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth);}
\DoxyCodeLine{554     }
\DoxyCodeLine{555     }
\DoxyCodeLine{556     \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{Parameters}} \mbox{\hyperlink{classudc_1_1_m_s_d_abfa4f6883d0b4677ab7b70c1adf06066}{getParameters}}() \textcolor{keyword}{const};}
\DoxyCodeLine{557     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_aa1513f639c10ca29773ea287ae104121}{setParameters}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{Parameters}} \&);}
\DoxyCodeLine{558     \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \mbox{\hyperlink{classudc_1_1_m_s_d_ae1bee2a207b40720156243ed19eed671}{getResults}}() \textcolor{keyword}{const};}
\DoxyCodeLine{559     }
\DoxyCodeLine{560     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a5c1d308f90d10072e5288685ba4d58db}{set\_kT}}(\textcolor{keywordtype}{double} kT);}
\DoxyCodeLine{561     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a18aa13537e0deda7d1263c1fd8d8228a}{setB}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&B);}
\DoxyCodeLine{562 }
\DoxyCodeLine{563     \mbox{\hyperlink{classudc_1_1_molecule}{MolProto}} \mbox{\hyperlink{classudc_1_1_m_s_d_a77dce5d8c1a874c47acfbc69d5a867ab}{getMolProto}}() \textcolor{keyword}{const};}
\DoxyCodeLine{564     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_aa8ed0dab0705b810e4d14215b488fb43}{setMolProto}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{MolProto}} \&proto);  \textcolor{comment}{// Note: the new MolProto must have the same "{}size"{} (number of nodes) as the previous MolProto.}}
\DoxyCodeLine{565     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_aade85204d30f826444572e41f27613aa}{setMolParameters}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{MolProto::NodeParameters}} \&, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{MolProto::EdgeParameters}} \&);  \textcolor{comment}{// uniformally updates all mol. parameters}}
\DoxyCodeLine{566 }
\DoxyCodeLine{567     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a) \textcolor{keyword}{const};}
\DoxyCodeLine{568     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z) \textcolor{keyword}{const};}
\DoxyCodeLine{569     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a) \textcolor{keyword}{const};}
\DoxyCodeLine{570     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z) \textcolor{keyword}{const};}
\DoxyCodeLine{571     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_af0cad12dfc8de11dfbbb600672b94a53}{getLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a) \textcolor{keyword}{const};}
\DoxyCodeLine{572     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_af0cad12dfc8de11dfbbb600672b94a53}{getLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z) \textcolor{keyword}{const};}
\DoxyCodeLine{573     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a4d4a91fd46eec66e753dfa2642c25068}{setSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&);}
\DoxyCodeLine{574     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a4d4a91fd46eec66e753dfa2642c25068}{setSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&);}
\DoxyCodeLine{575     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a0bb8c1e9fef1960578abc46446380dbf}{setFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&);}
\DoxyCodeLine{576     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a0bb8c1e9fef1960578abc46446380dbf}{setFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&);}
\DoxyCodeLine{577     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{setLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&);}
\DoxyCodeLine{578     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{setLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&);}
\DoxyCodeLine{579     }
\DoxyCodeLine{580     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a762738c5f2b8e17f526c6138fcf89872}{getN}}() \textcolor{keyword}{const};}
\DoxyCodeLine{581     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_adc9f743ee13e82becfe0a2c50ee52ec1}{getNL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{582     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_ae18b1502712c3ac5314dbb6130c354ed}{getNR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{583     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a100e8176f61523c520c546149d9014a6}{getNm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{584     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a3a90533d4764c960d421ccf254696133}{getNmL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{585     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_ad5c8743bd63fd3cdbb0361233e405c0b}{getNmR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{586     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a7add4bc60686c62e73343afa6092b017}{getNLR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{587     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a3ece5c5f34abcc06fef11fc96189895d}{getWidth}}() \textcolor{keyword}{const};}
\DoxyCodeLine{588     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a536ab447508f890fd16272995c6fae8b}{getHeight}}() \textcolor{keyword}{const};}
\DoxyCodeLine{589     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_aefb9f78944562ded126ec46485319557}{getDepth}}() \textcolor{keyword}{const};}
\DoxyCodeLine{590     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a939846baeed48015266b707a703ef15f}{getDimensions}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&depth) \textcolor{keyword}{const};}
\DoxyCodeLine{591     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a2c5e7ed01ae1e5e5e6157e76748f88ab}{getMolPosL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{592     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a158fcf1df8fc10e66257138df6e4a60e}{getMolPosR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{593     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a52a344961c0464197bc0936e24ec1107}{getMolPos}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&molPosL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&molPosR) \textcolor{keyword}{const};}
\DoxyCodeLine{594     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a9d5727849f685e6cccb5e5a0a3818cb3}{getTopL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{595     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a66200786b332ed413fa3e29a7ecedad3}{getBottomL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{596     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a7de138059fe647ec24a50d3b98ecdfe8}{getFrontR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{597     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a368da5ea0c007b29f0c18a4415b2d1f6}{getBackR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{598     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a54c6db2f1ffe3cb9de31b2e278ae2335}{getInnerBounds}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&topL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&bottomL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&frontR, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&backR) \textcolor{keyword}{const};}
\DoxyCodeLine{599     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_af17782522b81ac6827d6874ae6aa5018}{getFM\_L\_exists}}() \textcolor{keyword}{const};}
\DoxyCodeLine{600     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_ac7b197dca279f02512882dc173a70aaf}{getFM\_R\_exists}}() \textcolor{keyword}{const};}
\DoxyCodeLine{601     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_a87c3cff4cf2db6a08fa6d7f184500eea}{getMol\_exists}}() \textcolor{keyword}{const};}
\DoxyCodeLine{602     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a61db2cb3389641129ce97c0613917ec5}{getRegions}}(\textcolor{keywordtype}{bool} \&FM\_L\_exists, \textcolor{keywordtype}{bool} \&FM\_R\_exists, \textcolor{keywordtype}{bool} \&mol\_exists) \textcolor{keyword}{const};}
\DoxyCodeLine{603     }
\DoxyCodeLine{604     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a3cb49ad4ca11278ed81998a8efd3ce68}{setSeed}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} seed);  \textcolor{comment}{// change the seed of the prng, and restart the pseudo-\/random sequence}}
\DoxyCodeLine{605     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classudc_1_1_m_s_d_adedd5f97461ea96c685923b45b49d91b}{getSeed}}() \textcolor{keyword}{const};  \textcolor{comment}{// get the seed currently being used}}
\DoxyCodeLine{606 }
\DoxyCodeLine{607     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a82b75829d72149de1992f198ad3c73b6}{reinitialize}}(\textcolor{keywordtype}{bool} reseed = \textcolor{keyword}{true}); \textcolor{comment}{//reseed iff you want a new seed, true by default}}
\DoxyCodeLine{608     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a9b89ead4fcfc2c0ead59dcb33538a334}{randomize}}(\textcolor{keywordtype}{bool} reseed = \textcolor{keyword}{true}); \textcolor{comment}{//similar to reinitialize, but initial state is random}}
\DoxyCodeLine{609     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a3da3a656fdd0a10f6bbc819935c9fa1d}{metropolis}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} N);}
\DoxyCodeLine{610     \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a3da3a656fdd0a10f6bbc819935c9fa1d}{metropolis}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} N, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} freq);}
\DoxyCodeLine{611     }
\DoxyCodeLine{612     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_aca1fecf2568de928a441aa031280fc49}{specificHeat}}() \textcolor{keyword}{const};}
\DoxyCodeLine{613     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a0b14f09fe74231e5f9981b1571666ce5}{specificHeat\_L}}() \textcolor{keyword}{const};}
\DoxyCodeLine{614     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a8c62ebc53fe5f1d620785ad492b27414}{specificHeat\_R}}() \textcolor{keyword}{const};}
\DoxyCodeLine{615     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_abb96b180a4960bf101178aa01701b3cc}{specificHeat\_m}}() \textcolor{keyword}{const};}
\DoxyCodeLine{616     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a2d9850c33757ced8ae7c7b4b5de5afb2}{specificHeat\_mL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{617     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a162b9154b562fb1f70e128eb9f0b9c46}{specificHeat\_mR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{618     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_ab0205d423d26ab312fe9d612eb6b82e4}{specificHeat\_LR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{619     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_ac8f8afe5da02b14af09b1b4861a274e1}{magneticSusceptibility}}() \textcolor{keyword}{const};}
\DoxyCodeLine{620     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a3a7e3fa4340af6fe33cf2daceb37f656}{magneticSusceptibility\_L}}() \textcolor{keyword}{const};}
\DoxyCodeLine{621     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_acb90487ccf1985ac1045c7762fa4f42f}{magneticSusceptibility\_R}}() \textcolor{keyword}{const};}
\DoxyCodeLine{622     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a215acad84017f65c72a1abcb504b12ea}{magneticSusceptibility\_m}}() \textcolor{keyword}{const};}
\DoxyCodeLine{623     }
\DoxyCodeLine{624     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a4b9e7018e4245eaf23d4e01d0b582cc3}{meanM}}() \textcolor{keyword}{const};}
\DoxyCodeLine{625     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a8fe5c6f539ba5f128d89f6c32e42a81b}{meanML}}() \textcolor{keyword}{const};}
\DoxyCodeLine{626     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a75a2a166c7a100d23729914893024e8b}{meanMR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{627     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a7b1361f8f8a4c2782e16f4885860160d}{meanMm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{628     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a4c23d2ce55dbe92303a93b0f04247d6a}{meanMS}}() \textcolor{keyword}{const};}
\DoxyCodeLine{629     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a6c769149852b83b104041036684cc3b5}{meanMSL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{630     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_af32676ff5839b6a89cae38003cf392a5}{meanMSR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{631     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a0d9c252051a14d75fbfdab2e3ba0f1e5}{meanMSm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{632     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a195fcd710a651679837fe247ba037e65}{meanMF}}() \textcolor{keyword}{const};}
\DoxyCodeLine{633     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_aa996c134623e5f28bb2d599088f4cd56}{meanMFL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{634     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_ab4b2b0695b3e6143c44b6ab391f9890d}{meanMFR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{635     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a9aac2bad16a926cd6ac24e3c4291325f}{meanMFm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{636     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a07edbbd70d154577745c22e5ec7bdee4}{meanU}}() \textcolor{keyword}{const};}
\DoxyCodeLine{637     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_aec1081b7cc26892ee7bc9399f1fadbb2}{meanUL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{638     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a250a0059dd38873b6efe85a4f5da8668}{meanUR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{639     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a922653ef103119a00b0c808c62a7f9d3}{meanUm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{640     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a41a86b85c83949242bcc602775ed136d}{meanUmL}}() \textcolor{keyword}{const};}
\DoxyCodeLine{641     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_ad5c1cd7334fdd3ea7db7964f2e69a536}{meanUmR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{642     \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a215bb03467cc147f837cd3afe89a793a}{meanULR}}() \textcolor{keyword}{const};}
\DoxyCodeLine{643     }
\DoxyCodeLine{644     \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_afb91b037de5315bfde0159ee591267a3}{begin}}() \textcolor{keyword}{const};}
\DoxyCodeLine{645     \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_a917317363ac8e2e78840845d6fc49f91}{end}}() \textcolor{keyword}{const};}
\DoxyCodeLine{646 \};}
\DoxyCodeLine{647 }
\DoxyCodeLine{648 ostream\& \mbox{\hyperlink{namespaceudc_a6b685c21976ba81485ee5434b8a7ca41}{operator <<}}(ostream \&out, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{MSD::Parameters}} \&p);}
\DoxyCodeLine{649 ostream\& \mbox{\hyperlink{namespaceudc_a6b685c21976ba81485ee5434b8a7ca41}{operator <<}}(ostream \&out, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{MSD::Results}} \&r);}
\DoxyCodeLine{650 }
\DoxyCodeLine{651 }
\DoxyCodeLine{652 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{653 ostream\& \mbox{\hyperlink{namespaceudc_a6b685c21976ba81485ee5434b8a7ca41}{operator <<}}(ostream \&out, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{MSD::Parameters}} \&p) \{}
\DoxyCodeLine{654     \textcolor{keywordflow}{return} out}
\DoxyCodeLine{655         << \textcolor{stringliteral}{"{}kT = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aea19a4bd6b6b630bb5255c6f3206d67d}{kT}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}B = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a7df654a8138c850e64de4adea7c5776a}{B}} << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{656 }
\DoxyCodeLine{657         << \textcolor{stringliteral}{"{}SL = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9347bd5ecace963e09c974e2e6236f40}{SL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}SR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aad0f4bd2d0ba9b01de8f6830b4d77f09}{SR}} << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{658         << \textcolor{stringliteral}{"{}FL = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a55712b42b9d9460519b2ffc4a24cdd96}{FL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}FR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a3b84c7bdff2e5acbf7e2aee9f4f87380}{FR}} << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{659         }
\DoxyCodeLine{660         << \textcolor{stringliteral}{"{}JL  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a4de534ffb37d66a609206ecfbc79a4a3}{JL}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}JR  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a626eb888da1ae30b0fd04fd60bbf5b4a}{JR}}  << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{661         << \textcolor{stringliteral}{"{}JmL = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a570769f809bfc17b833b760025d54635}{JmL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}JmR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a11d9a80a263371635f53ad14232b7c10}{JmR}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}JLR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a876665131291f40627d234de2636e7a5}{JLR}} << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{662         }
\DoxyCodeLine{663         << \textcolor{stringliteral}{"{}Je0L  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a38fbdb6de5465d21767e5acdd70e4e46}{Je0L}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}Je0R  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a0fd1a65ab83a4cfc0aed753762a71f1c}{Je0R}}  << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{664         << \textcolor{stringliteral}{"{}Je1L  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_adab3e0cfbf9f3c60b828d70e9a7853cd}{Je1L}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}Je1R  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a1f5a1b2902f4152f4027c9a6d66546dd}{Je1R}}  << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{665         << \textcolor{stringliteral}{"{}Je1mL = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_acf66b51f1494866fe609eabf57790989}{Je1mL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}Je1mR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a6357fcbf8fe7d799c10bb33853fe5fd7}{Je1mR}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}Je1LR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_afe51f061d0cda85616e3a04ecb34cb85}{Je1LR}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{666         << \textcolor{stringliteral}{"{}JeeL  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a01e7b66d243045c1253a7f2e8c70ab03}{JeeL}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}JeeR  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a4d3e4c3b64dfded7ac1c07c45f71fb6e}{JeeR}}  << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{667         << \textcolor{stringliteral}{"{}JeemL = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aed49e5aed77920be09b8323a0cee2781}{JeemL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}JeemR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aa2775ee2661215984de3caf7832c0f13}{JeemR}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}JeeLR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a316117cf75ee335416c34e938960b8a1}{JeeLR}} << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{668         }
\DoxyCodeLine{669         << \textcolor{stringliteral}{"{}bL  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_afe3cfa8886ebb734fbe817c8dd254d8f}{bL}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}bR  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9e807cec26c1219ef16f3e26f67a926a}{bR}}  << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{670         << \textcolor{stringliteral}{"{}bmL = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ac35c301b854f5d76621b39774776bf22}{bmL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}bmR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a0f4027af582ca01b7db0941641227ac5}{bmR}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}bLR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a022b5b93636d04f81172635825796469}{bLR}} << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{671         }
\DoxyCodeLine{672         << \textcolor{stringliteral}{"{}AL = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9d8c4ad2396d258736c0d5985feaca55}{AL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}AR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aa97373f0348686a6f2c1abbbf35aeb1a}{AR}} << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{673         }
\DoxyCodeLine{674         << \textcolor{stringliteral}{"{}DL  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_af8bbfb0d4941170abb9cb20874d37177}{DL}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}DR  = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a6c585701e1e89a881bbfe9d1eee5d64c}{DR}}  << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{675         << \textcolor{stringliteral}{"{}DmL = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_af0493729f1925de734f4d595643fa09f}{DmL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}DmR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a2bf4786615f44fd118d255aa59bf8190}{DmR}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}DLR = "{}} << p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ab293ea7698715b6f29b0c0b007a85a4e}{DLR}} << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{676 \}}
\DoxyCodeLine{677 }
\DoxyCodeLine{678 ostream\& \mbox{\hyperlink{namespaceudc_a6b685c21976ba81485ee5434b8a7ca41}{operator <<}}(ostream \&out, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{MSD::Results}} \&r) \{}
\DoxyCodeLine{679     \textcolor{keywordflow}{return} out}
\DoxyCodeLine{680         << \textcolor{stringliteral}{"{}t   = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}   << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{681         << \textcolor{stringliteral}{"{}M   = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}}   << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}ML  = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}MR  = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}Mm  = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}}  << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{682         << \textcolor{stringliteral}{"{}MS  = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_aeae2f7666be87f8d4499d612567fe71a}{MS}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}MSL = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a020102ea8f3621b4791a75de90624ade}{MSL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}MSR = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66823c7a278ea165067eadaf62c976d0}{MSR}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}MSm = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a42f24fd034f5acf41d415093def18fa5}{MSm}} << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{683         << \textcolor{stringliteral}{"{}MF  = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a789b09f14dc037a00b59733ef5e6b8fe}{MF}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}MFL = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1a6be402d985814748b000dce6b983e9}{MFL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}MFR = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66d2b20d7c955c704ce31b355419ee45}{MFR}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}MFm = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac3c2f0d86900c360181e14073842f9a5}{MFm}} << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{684         << \textcolor{stringliteral}{"{}U   = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}}   << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}UL  = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}UR  = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}}  << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}Um  = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}}  << \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{685         << \textcolor{stringliteral}{"{}UmL = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}UmR = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}} << \textcolor{charliteral}{'\(\backslash\)n'} << \textcolor{stringliteral}{"{}ULR = "{}} << r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}} << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{686 \}}
\DoxyCodeLine{687 }
\DoxyCodeLine{688 }
\DoxyCodeLine{689 Molecule::EdgeParameters::EdgeParameters()}
\DoxyCodeLine{690 : Jm(1), Je1m(0), Jeem(0), bm(0), Dm(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}})}
\DoxyCodeLine{691 \{\}}
\DoxyCodeLine{692 }
\DoxyCodeLine{693 Molecule::NodeParameters::NodeParameters()}
\DoxyCodeLine{694 : Sm(1), Fm(0), Je0m(0), Am(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}})}
\DoxyCodeLine{695 \{\}}
\DoxyCodeLine{696 }
\DoxyCodeLine{697 Molecule::Edge::Edge(\textcolor{keywordtype}{size\_t} eIdx, \textcolor{keywordtype}{size\_t} nIdx, \textcolor{keywordtype}{size\_t} sIdx, \textcolor{keywordtype}{double} dir)}
\DoxyCodeLine{698 : \mbox{\hyperlink{classudc_1_1_molecule_a41ffa48f091303c3178c8e783cc3142e}{edgeIndex}}(eIdx), nodeIndex(nIdx), selfIndex(sIdx), direction(dir)}
\DoxyCodeLine{699 \{\}}
\DoxyCodeLine{700 }
\DoxyCodeLine{701 Molecule::Node::Node(\textcolor{keyword}{const} \mbox{\hyperlink{_m_s_d-export_8cpp_a3ff276dcf7d10876c4783799c899bfd9}{NodeParameters}} \&parameters) : parameters(parameters) \{}
\DoxyCodeLine{702 \}}
\DoxyCodeLine{703 }
\DoxyCodeLine{704 \textcolor{keyword}{const} \textcolor{keywordtype}{char} * \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_a5d2f40b3d48330e1345c68b8b05a18ad}{Molecule::HEADER}} = \textcolor{stringliteral}{"{}MMB"{}};}
\DoxyCodeLine{705 \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classudc_1_1_molecule_a5c178c3e3abe344b6019877b4e877dfa}{Molecule::HEADER\_SIZE}} = 3;  \textcolor{comment}{// compile-\/time constant of strlen(HEADER)}}
\DoxyCodeLine{706 }
\DoxyCodeLine{707 \textcolor{comment}{// 2 size\_t's for the leads, and 1 for each block length (nodeParams, and edgeParams)}}
\DoxyCodeLine{708 \mbox{\hyperlink{classudc_1_1_molecule_a4a38e660030e37a46905b99fb87be886}{Molecule::Molecule}}() : leftLead(0), rightLead(0), sSize(\mbox{\hyperlink{classudc_1_1_molecule_a5c178c3e3abe344b6019877b4e877dfa}{HEADER\_SIZE}} + 4 * sizeof(size\_t)) \{}
\DoxyCodeLine{709 \}}
\DoxyCodeLine{710 }
\DoxyCodeLine{711 \mbox{\hyperlink{classudc_1_1_molecule_a4a38e660030e37a46905b99fb87be886}{Molecule::Molecule}}(\textcolor{keywordtype}{size\_t} \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}} \&nodeParams)}
\DoxyCodeLine{712 : nodes(\mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}), leftLead(0), rightLead(0),}
\DoxyCodeLine{713   sSize(\mbox{\hyperlink{_m_s_d-export_8cpp_acdcc9c325c0ace2430455ec8aafd3406}{HEADER\_SIZE}} + 4 * sizeof(size\_t) + \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}} * (6 * sizeof(double) + sizeof(size\_t)))}
\DoxyCodeLine{714 \{}
\DoxyCodeLine{715     \textcolor{keywordflow}{for} (Node \&node : nodes)}
\DoxyCodeLine{716         node.parameters = nodeParams;}
\DoxyCodeLine{717 \}}
\DoxyCodeLine{718 }
\DoxyCodeLine{719 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a682c1855e517d0c2b68118b114d31d15}{Molecule::serialize}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *buffer)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{720     \textcolor{comment}{// "{}MMB"{} (MSD mol. binary) header (for safety)}}
\DoxyCodeLine{721     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classudc_1_1_molecule_a5c178c3e3abe344b6019877b4e877dfa}{HEADER\_SIZE}}; i++)}
\DoxyCodeLine{722         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(\mbox{\hyperlink{classudc_1_1_molecule_a5d2f40b3d48330e1345c68b8b05a18ad}{HEADER}}[i], buffer);}
\DoxyCodeLine{723     }
\DoxyCodeLine{724     \textcolor{comment}{// First write the edge-\/parameters section}}
\DoxyCodeLine{725     \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(edgeParameters.size(), buffer);}
\DoxyCodeLine{726     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}} \&eParam : edgeParameters) \{}
\DoxyCodeLine{727         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(eParam.Jm, buffer);  \textcolor{comment}{// order must be correct (must match Molecule::deserialize)}}
\DoxyCodeLine{728         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(eParam.Je1m, buffer);}
\DoxyCodeLine{729         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(eParam.Jeem, buffer);}
\DoxyCodeLine{730         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(eParam.bm, buffer);}
\DoxyCodeLine{731         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(eParam.Dm.x, buffer);}
\DoxyCodeLine{732         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(eParam.Dm.y, buffer);}
\DoxyCodeLine{733         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(eParam.Dm.z, buffer);}
\DoxyCodeLine{734     \}}
\DoxyCodeLine{735 }
\DoxyCodeLine{736     \textcolor{comment}{// Second, write the node-\/parameters section}}
\DoxyCodeLine{737     \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(nodes.size(), buffer);}
\DoxyCodeLine{738     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} Node \&node : nodes) \{}
\DoxyCodeLine{739         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(node.parameters.Sm, buffer);  \textcolor{comment}{// Order must be correct (must match Molecule::deserialize)}}
\DoxyCodeLine{740         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(node.parameters.Fm, buffer);}
\DoxyCodeLine{741         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(node.parameters.Je0m, buffer);}
\DoxyCodeLine{742         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(node.parameters.Am.x, buffer);}
\DoxyCodeLine{743         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(node.parameters.Am.y, buffer);}
\DoxyCodeLine{744         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(node.parameters.Am.z, buffer);}
\DoxyCodeLine{745     \}}
\DoxyCodeLine{746 }
\DoxyCodeLine{747     \textcolor{comment}{// Thridly, write the adjacency section}}
\DoxyCodeLine{748     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} Node \&node : nodes) \{}
\DoxyCodeLine{749         \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(node.neighbors.size(), buffer);}
\DoxyCodeLine{750         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} Edge \&edge : node.neighbors) \{}
\DoxyCodeLine{751             \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(edge.edgeIndex, buffer);}
\DoxyCodeLine{752             \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(edge.nodeIndex, buffer);}
\DoxyCodeLine{753             \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(edge.direction, buffer);}
\DoxyCodeLine{754         \}}
\DoxyCodeLine{755     \}}
\DoxyCodeLine{756 }
\DoxyCodeLine{757     \textcolor{comment}{// Lastly write "{}extra stuff"{}}}
\DoxyCodeLine{758     \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(leftLead, buffer);}
\DoxyCodeLine{759     \mbox{\hyperlink{namespaceudc_a1e040d8326f2ad3b600f8f66a8de6305}{bwrite}}(rightLead, buffer);}
\DoxyCodeLine{760 \}}
\DoxyCodeLine{761 }
\DoxyCodeLine{762 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_ac8c39d99187f0dae0b0fe7ef7e935a0d}{Molecule::deserialize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *buffer) \{}
\DoxyCodeLine{763     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *buffer\_start = buffer;}
\DoxyCodeLine{764 }
\DoxyCodeLine{765     \textcolor{comment}{// Read "{}MMB"{} header (for saftey)}}
\DoxyCodeLine{766     \textcolor{keywordtype}{char} header[\mbox{\hyperlink{classudc_1_1_molecule_a5c178c3e3abe344b6019877b4e877dfa}{HEADER\_SIZE}} + 1];}
\DoxyCodeLine{767     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classudc_1_1_molecule_a5c178c3e3abe344b6019877b4e877dfa}{HEADER\_SIZE}}; i++)}
\DoxyCodeLine{768         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(header[i], buffer);}
\DoxyCodeLine{769     header[\mbox{\hyperlink{classudc_1_1_molecule_a5c178c3e3abe344b6019877b4e877dfa}{HEADER\_SIZE}}] = \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{770     }
\DoxyCodeLine{771     \textcolor{keywordflow}{if} (strcmp(\mbox{\hyperlink{classudc_1_1_molecule_a5d2f40b3d48330e1345c68b8b05a18ad}{HEADER}}, header) != 0)}
\DoxyCodeLine{772         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classudc_1_1_molecule_1_1_deserialization_exception}{DeserializationException}}((\textcolor{keywordtype}{string}(\textcolor{stringliteral}{"{}Missing header: "{}}) + \textcolor{keywordtype}{string}(\mbox{\hyperlink{classudc_1_1_molecule_a5d2f40b3d48330e1345c68b8b05a18ad}{HEADER}})).c\_str());}
\DoxyCodeLine{773 }
\DoxyCodeLine{774     \textcolor{comment}{// First read edges}}
\DoxyCodeLine{775     \textcolor{keywordtype}{size\_t} edgeCount;}
\DoxyCodeLine{776     \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(edgeCount, buffer);  \textcolor{comment}{// First the number of edges is read.}}
\DoxyCodeLine{777     edgeParameters.erase(edgeParameters.begin(), edgeParameters.end());}
\DoxyCodeLine{778     edgeParameters.reserve(edgeCount);}
\DoxyCodeLine{779     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < edgeCount; i++) \{}
\DoxyCodeLine{780         \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}} eParam;}
\DoxyCodeLine{781         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(eParam.\mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_a888be7fafaea5cedfc9f59ce6291a5c8}{Jm}}, buffer);    \textcolor{comment}{// Then each edge's parameters are read.}}
\DoxyCodeLine{782         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(eParam.\mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_afe9b27d63588d6f6066137961556274b}{Je1m}}, buffer);  \textcolor{comment}{// (Take careful note of the order in which the fields are stored.)}}
\DoxyCodeLine{783         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(eParam.\mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_a8e66fedceee8f6cbd949e2e39f68cb38}{Jeem}}, buffer);}
\DoxyCodeLine{784         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(eParam.\mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_ae10a09e2ff621f6427be2bb5a69ba595}{bm}}, buffer);}
\DoxyCodeLine{785         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(eParam.\mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_a7c1edcd9071395e3e894f12c03a2a8b2}{Dm}}.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}}, buffer);}
\DoxyCodeLine{786         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(eParam.\mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_a7c1edcd9071395e3e894f12c03a2a8b2}{Dm}}.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}}, buffer);}
\DoxyCodeLine{787         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(eParam.\mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters_a7c1edcd9071395e3e894f12c03a2a8b2}{Dm}}.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}}, buffer);}
\DoxyCodeLine{788         edgeParameters.push\_back(eParam);}
\DoxyCodeLine{789     \}}
\DoxyCodeLine{790 }
\DoxyCodeLine{791     \textcolor{comment}{// Then read nodes (in two "{}sweeps"{})}}
\DoxyCodeLine{792     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}};}
\DoxyCodeLine{793     \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{udc::bread}}(\mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}}, buffer);  \textcolor{comment}{// Next the number of nodes is read.}}
\DoxyCodeLine{794     nodes.erase(nodes.begin(), nodes.end());}
\DoxyCodeLine{795     nodes.reserve(\mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}});}
\DoxyCodeLine{796     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}}; i++) \{}
\DoxyCodeLine{797         Node node;}
\DoxyCodeLine{798         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(node.parameters.Sm, buffer);  \textcolor{comment}{// For each node, we read its (local) parameter fields.}}
\DoxyCodeLine{799         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(node.parameters.Fm, buffer);  \textcolor{comment}{// (Take careful note of the order in which the fields are stored.)}}
\DoxyCodeLine{800         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(node.parameters.Je0m, buffer);}
\DoxyCodeLine{801         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(node.parameters.Am.x, buffer);}
\DoxyCodeLine{802         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(node.parameters.Am.y, buffer);}
\DoxyCodeLine{803         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(node.parameters.Am.z, buffer);}
\DoxyCodeLine{804         nodes.push\_back(node);}
\DoxyCodeLine{805     \}}
\DoxyCodeLine{806     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}}; i++) \{}
\DoxyCodeLine{807         Node \&node = nodes[i];}
\DoxyCodeLine{808         \textcolor{keywordtype}{size\_t} neighborCount;}
\DoxyCodeLine{809         \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(neighborCount, buffer);  \textcolor{comment}{// ("{}Spweep"{} 2) Again for each node, get the number of neighbors this time.}}
\DoxyCodeLine{810         node.neighbors.reserve(neighborCount);}
\DoxyCodeLine{811         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 0; j < neighborCount; j++) \{}
\DoxyCodeLine{812             \textcolor{keywordtype}{size\_t} eIndex, nIndex;}
\DoxyCodeLine{813             \textcolor{keywordtype}{double} direction;}
\DoxyCodeLine{814             \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(eIndex, buffer);  \textcolor{comment}{// Finally we read each (edge index, node index, direction) triplet for this node.}}
\DoxyCodeLine{815             \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(nIndex, buffer);}
\DoxyCodeLine{816             \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(direction, buffer);}
\DoxyCodeLine{817             Edge edge(eIndex, nIndex, i, direction);}
\DoxyCodeLine{818             node.neighbors.push\_back(edge);}
\DoxyCodeLine{819         \}}
\DoxyCodeLine{820     \}}
\DoxyCodeLine{821 }
\DoxyCodeLine{822     \textcolor{comment}{// Lastly, we read the leads' positions}}
\DoxyCodeLine{823     \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(leftLead, buffer);  \textcolor{comment}{// (Left lead first, then right lead.)}}
\DoxyCodeLine{824     \mbox{\hyperlink{namespaceudc_a51cb94811213523405b27e375b7a1b33}{bread}}(rightLead, buffer);}
\DoxyCodeLine{825 }
\DoxyCodeLine{826     sSize = buffer -\/ buffer\_start;}
\DoxyCodeLine{827 \}}
\DoxyCodeLine{828 }
\DoxyCodeLine{829 \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classudc_1_1_molecule_a9fc6cbb7d10939477c3abcefd319ae54}{Molecule::serializationSize}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{830     \textcolor{keywordflow}{return} sSize;}
\DoxyCodeLine{831 \}}
\DoxyCodeLine{832 }
\DoxyCodeLine{833 istream\& \mbox{\hyperlink{classudc_1_1_molecule_aedb314ce8b1dff4ecf156d6e739d170f}{Molecule::read}}(istream \&in) \{}
\DoxyCodeLine{834     \textcolor{comment}{// get file size}}
\DoxyCodeLine{835     in.seekg(0, in.end);}
\DoxyCodeLine{836     streampos size = in.tellg();}
\DoxyCodeLine{837     in.seekg(0, in.beg);}
\DoxyCodeLine{838 }
\DoxyCodeLine{839     \textcolor{comment}{// read data into buffer}}
\DoxyCodeLine{840     \textcolor{keywordtype}{char} *data = \textcolor{keyword}{new} \textcolor{keywordtype}{char}[size];}
\DoxyCodeLine{841     in.read(data, size);}
\DoxyCodeLine{842 }
\DoxyCodeLine{843     \textcolor{comment}{// deserialize buffer}}
\DoxyCodeLine{844     \mbox{\hyperlink{classudc_1_1_molecule_ac8c39d99187f0dae0b0fe7ef7e935a0d}{deserialize}}((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *) data);}
\DoxyCodeLine{845     \textcolor{keyword}{delete} [] data;}
\DoxyCodeLine{846 }
\DoxyCodeLine{847     \textcolor{keywordflow}{return} in;}
\DoxyCodeLine{848 \}}
\DoxyCodeLine{849 }
\DoxyCodeLine{850 ostream\& \mbox{\hyperlink{classudc_1_1_molecule_a59ea4534de4d263562db48eac48a68cc}{Molecule::write}}(ostream \&out)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{851     \textcolor{keywordtype}{size\_t} size = \mbox{\hyperlink{classudc_1_1_molecule_a9fc6cbb7d10939477c3abcefd319ae54}{serializationSize}}();}
\DoxyCodeLine{852     \textcolor{comment}{// std::cout << "{} -\/-\/ Allocating...\(\backslash\)n"{};  // DEBUG}}
\DoxyCodeLine{853     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data = \textcolor{keyword}{new} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}[size];}
\DoxyCodeLine{854     \textcolor{comment}{// std::cout << "{} -\/-\/ Serializing...\(\backslash\)n"{};  // DEBUG}}
\DoxyCodeLine{855     \mbox{\hyperlink{classudc_1_1_molecule_a682c1855e517d0c2b68118b114d31d15}{serialize}}(data);}
\DoxyCodeLine{856     \textcolor{comment}{// std::cout << "{} -\/-\/ Writing...\(\backslash\)n"{};  // DEBUG}}
\DoxyCodeLine{857     out.write((\textcolor{keywordtype}{char} *) data, size);}
\DoxyCodeLine{858     \textcolor{keyword}{delete} [] data;}
\DoxyCodeLine{859     \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{860 \}}
\DoxyCodeLine{861 }
\DoxyCodeLine{862 \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \mbox{\hyperlink{classudc_1_1_molecule_a97742a892262f853a7ec68d982d68fae}{Molecule::load}}(istream \&in) \{}
\DoxyCodeLine{863     \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} mol;}
\DoxyCodeLine{864     mol.\mbox{\hyperlink{classudc_1_1_molecule_aedb314ce8b1dff4ecf156d6e739d170f}{read}}(in);}
\DoxyCodeLine{865     \textcolor{keywordflow}{return} mol;}
\DoxyCodeLine{866 \}}
\DoxyCodeLine{867 }
\DoxyCodeLine{868 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_ab18585360b5c1577f6be8cc1f565b260}{Molecule::createNode}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{NodeParameters}} \&parameters) \{}
\DoxyCodeLine{869     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index = nodes.size();}
\DoxyCodeLine{870 }
\DoxyCodeLine{871     \textcolor{keywordflow}{if} (index >= \mbox{\hyperlink{classudc_1_1_molecule_a1b9d46a0051e4ddbb66f8b0322844dda}{NOT\_FOUND}})}
\DoxyCodeLine{872         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}Molecule::createNode: Can not create node because the maximum number of nodes has been reached"{}});}
\DoxyCodeLine{873     }
\DoxyCodeLine{874     Node node(parameters);}
\DoxyCodeLine{875     nodes.push\_back(node);}
\DoxyCodeLine{876 }
\DoxyCodeLine{877     \textcolor{comment}{// SERIALIZATION\_SIZE of NODE\_PARAMETERS,}}
\DoxyCodeLine{878     \textcolor{comment}{// plus 1 size\_t for size of adjacency list}}
\DoxyCodeLine{879     sSize += 6 * \textcolor{keyword}{sizeof}(double) + \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{880 }
\DoxyCodeLine{881     \textcolor{keywordflow}{return} index;}
\DoxyCodeLine{882 \}}
\DoxyCodeLine{883 }
\DoxyCodeLine{884 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{Molecule::nodeCount}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{885     \textcolor{keywordflow}{return} nodes.size();}
\DoxyCodeLine{886 \}}
\DoxyCodeLine{887 }
\DoxyCodeLine{888 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_ae1411a791a83503073a9dc8a7b1d3b33}{Molecule::connectNodes}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} b, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{EdgeParameters}} \&parameters) \{}
\DoxyCodeLine{889     \textcolor{keywordtype}{size\_t} index = edgeParameters.size();}
\DoxyCodeLine{890 }
\DoxyCodeLine{891     \{}
\DoxyCodeLine{892         \textcolor{keywordflow}{if} (index == \mbox{\hyperlink{classudc_1_1_molecule_a1b9d46a0051e4ddbb66f8b0322844dda}{NOT\_FOUND}})}
\DoxyCodeLine{893             \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}Molecule::connectNodes: Can not create edge because the maximum number of edges has been reached"{}});}
\DoxyCodeLine{894         }
\DoxyCodeLine{895         \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}} = nodes.size();}
\DoxyCodeLine{896         \textcolor{keywordflow}{if} (a >= \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}} || b >= \mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}})}
\DoxyCodeLine{897             \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}Molecule::connectNodes: Invalid node index"{}});}
\DoxyCodeLine{898     \}}
\DoxyCodeLine{899 }
\DoxyCodeLine{900     edgeParameters.push\_back(parameters);}
\DoxyCodeLine{901 }
\DoxyCodeLine{902     \textcolor{keywordtype}{bool} isLoop = (a == b);}
\DoxyCodeLine{903     \textcolor{keywordtype}{double} dir = (isLoop ? 0 : +1);}
\DoxyCodeLine{904 }
\DoxyCodeLine{905     \textcolor{comment}{// attach edge: a -\/> b}}
\DoxyCodeLine{906     Edge edgeA(index, b, a, dir);}
\DoxyCodeLine{907     nodes[a].neighbors.push\_back(edgeA);}
\DoxyCodeLine{908 }
\DoxyCodeLine{909     \textcolor{comment}{// 7 double's for EdgeParameters,}}
\DoxyCodeLine{910     \textcolor{comment}{// and a triplet of (size\_t, size\_t, double) for the the first entree in the adjacency lists}}
\DoxyCodeLine{911     sSize += 7 * \textcolor{keyword}{sizeof}(double) + 2 * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{size\_t}) + \textcolor{keyword}{sizeof}(double);}
\DoxyCodeLine{912 }
\DoxyCodeLine{913     \textcolor{keywordflow}{if} (!isLoop) \{  \textcolor{comment}{// only duplicate edge if it's not a self connected edge}}
\DoxyCodeLine{914         \textcolor{comment}{// attach edge: b -\/> a}}
\DoxyCodeLine{915         Edge edgeB(index, a, b, -\/dir);}
\DoxyCodeLine{916         nodes[b].neighbors.push\_back(edgeB);}
\DoxyCodeLine{917 }
\DoxyCodeLine{918         \textcolor{comment}{// a second triplet of (size\_t, size\_t, double) for the second entree in the adjacency lists}}
\DoxyCodeLine{919         sSize += 2 * \textcolor{keyword}{sizeof}(size\_t) + \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double});}
\DoxyCodeLine{920     \}}
\DoxyCodeLine{921 }
\DoxyCodeLine{922     \textcolor{keywordflow}{return} index;}
\DoxyCodeLine{923 \}}
\DoxyCodeLine{924 }
\DoxyCodeLine{925 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_a41ffa48f091303c3178c8e783cc3142e}{Molecule::edgeIndex}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} b)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{926     \textcolor{keywordflow}{if} (a >= nodes.size() || b >= nodes.size())}
\DoxyCodeLine{927         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}Molecule::edgeIndex: Invalid node index"{}});}
\DoxyCodeLine{928 }
\DoxyCodeLine{929     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} Edge \&edge : nodes[a].neighbors)}
\DoxyCodeLine{930         \textcolor{keywordflow}{if} (edge.nodeIndex == b)}
\DoxyCodeLine{931             \textcolor{keywordflow}{return} edge.edgeIndex;}
\DoxyCodeLine{932     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_a1b9d46a0051e4ddbb66f8b0322844dda}{NOT\_FOUND}};}
\DoxyCodeLine{933 \}}
\DoxyCodeLine{934 }
\DoxyCodeLine{935 \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{Molecule::EdgeParameters}} \mbox{\hyperlink{classudc_1_1_molecule_a012b0e0a805476ae9e80673b9070db86}{Molecule::getEdgeParameters}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{936     \textcolor{keywordflow}{return} edgeParameters.at(index);}
\DoxyCodeLine{937 \}}
\DoxyCodeLine{938 }
\DoxyCodeLine{939 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a303bb5e1cc934255220e58949e345065}{Molecule::setEdgeParameters}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{Molecule::EdgeParameters}} \&p) \{}
\DoxyCodeLine{940     edgeParameters.at(index) = p;}
\DoxyCodeLine{941 \}}
\DoxyCodeLine{942 }
\DoxyCodeLine{943 \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{Molecule::NodeParameters}} \mbox{\hyperlink{classudc_1_1_molecule_aee4baa13cfc0b0584ec8e2c5000a76be}{Molecule::getNodeParameters}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{944     \textcolor{keywordflow}{return} nodes.at(index).parameters;}
\DoxyCodeLine{945 \}}
\DoxyCodeLine{946 }
\DoxyCodeLine{947 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_ad13bc013a1031b8379ee7f134ce4724e}{Molecule::setNodeParameters}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} index, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{Molecule::NodeParameters}} \&p) \{}
\DoxyCodeLine{948     nodes.at(index).parameters = p;}
\DoxyCodeLine{949 \}}
\DoxyCodeLine{950 }
\DoxyCodeLine{951 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a401ed0509649570cc636b5a08735cbd6}{Molecule::setAllParameters}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{Molecule::NodeParameters}} \&nodeParams, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{Molecule::EdgeParameters}} \&edgeParams) \{}
\DoxyCodeLine{952     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < edgeParameters.size(); i++)}
\DoxyCodeLine{953         edgeParameters[i] = edgeParams;}
\DoxyCodeLine{954     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < nodes.size(); i++)}
\DoxyCodeLine{955         nodes[i].parameters = nodeParams;}
\DoxyCodeLine{956 \}}
\DoxyCodeLine{957 }
\DoxyCodeLine{958 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a055eb97e7305e44ebb8a0d22a23f6752}{Molecule::setLeftLead}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} node) \{}
\DoxyCodeLine{959     leftLead = node;}
\DoxyCodeLine{960 \}}
\DoxyCodeLine{961 }
\DoxyCodeLine{962 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a549536b6815dd4ffcedb3ab3895a064f}{Molecule::setRightLead}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} node) \{}
\DoxyCodeLine{963     rightLead = node;}
\DoxyCodeLine{964 \}}
\DoxyCodeLine{965 }
\DoxyCodeLine{966 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a57552dd57e092b3d7bc5e2e13e2a419a}{Molecule::setLeads}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} left, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} right) \{}
\DoxyCodeLine{967     leftLead = left;}
\DoxyCodeLine{968     rightLead = right;}
\DoxyCodeLine{969 \}}
\DoxyCodeLine{970 }
\DoxyCodeLine{971 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_ab2718d472f48420e4ae77827c2753f9a}{Molecule::getLeftLead}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{972     \textcolor{keywordflow}{return} leftLead;}
\DoxyCodeLine{973 \}}
\DoxyCodeLine{974 }
\DoxyCodeLine{975 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_a09895cda60e964b18e0c38384e5f3a89}{Molecule::getRightLead}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{976     \textcolor{keywordflow}{return} rightLead;}
\DoxyCodeLine{977 \}}
\DoxyCodeLine{978 }
\DoxyCodeLine{979 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_molecule_a8eacb4f3318b2d68c571cafb56a956ba}{Molecule::getLeads}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&left, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&right)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{980     left = leftLead;}
\DoxyCodeLine{981     right = rightLead;}
\DoxyCodeLine{982 \}}
\DoxyCodeLine{983 }
\DoxyCodeLine{984 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{Molecule::NodeIterable}} \mbox{\hyperlink{classudc_1_1_molecule_a57560cc5b9d4d5971c16566f77e2e279}{Molecule::getNodes}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{985     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable}{Molecule::NodeIterable}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{986 \}}
\DoxyCodeLine{987 }
\DoxyCodeLine{988 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{Molecule::EdgeIterable}} \mbox{\hyperlink{classudc_1_1_molecule_afc512c8f695a33e8918bd20912beb8cd}{Molecule::getEdges}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{989     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{Molecule::EdgeIterable}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{990 \}}
\DoxyCodeLine{991 }
\DoxyCodeLine{992 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{Molecule::EdgeIterable}} \mbox{\hyperlink{classudc_1_1_molecule_a48c40b90cb716c63b0a3c6b2a39d4805}{Molecule::getAdjacencyList}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nodeIndex)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{993     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{Molecule::EdgeIterable}}(*\textcolor{keyword}{this}, nodeIndex);}
\DoxyCodeLine{994 \}}
\DoxyCodeLine{995 }
\DoxyCodeLine{996 Molecule::NodeIterator::NodeIterator(\textcolor{keyword}{const} NodeIterable \&nodes, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx) : iterable(nodes), idx(idx) \{}
\DoxyCodeLine{997 \}}
\DoxyCodeLine{998 }
\DoxyCodeLine{999 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_add4653d895f324444b7d295a35e6ca00}{Molecule::NodeIterator::getIndex}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1000     \textcolor{keywordflow}{return} idx;}
\DoxyCodeLine{1001 \}}
\DoxyCodeLine{1002 }
\DoxyCodeLine{1003 \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{Molecule::NodeParameters}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a04119ad80998be7ebd7207d360e638c8}{Molecule::NodeIterator::getParameters}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1004     \textcolor{keywordflow}{return} iterable.mol.getNodeParameters(getIndex());}
\DoxyCodeLine{1005 \}}
\DoxyCodeLine{1006 }
\DoxyCodeLine{1007 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{Molecule::EdgeIterable}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a0acdd22957b069b97f55d993aa6e5829}{Molecule::NodeIterator::getNeighbors}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1008     \textcolor{keywordflow}{return} iterable.mol.\mbox{\hyperlink{classudc_1_1_molecule_a48c40b90cb716c63b0a3c6b2a39d4805}{getAdjacencyList}}(getIndex());}
\DoxyCodeLine{1009 \}}
\DoxyCodeLine{1010 }
\DoxyCodeLine{1011 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a90229c78c03c1801f453149a9937bde3}{Molecule::NodeIterator::operator*}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1012     \textcolor{keywordflow}{return} getIndex();}
\DoxyCodeLine{1013 \}}
\DoxyCodeLine{1014 }
\DoxyCodeLine{1015 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_ac47692c114579ddc642d0b1c52b52131}{Molecule::NodeIterator::operator[]}}(\textcolor{keywordtype}{int} offset)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1016     \textcolor{keywordflow}{return} *(*\textcolor{keyword}{this} + offset);}
\DoxyCodeLine{1017 \}}
\DoxyCodeLine{1018 }
\DoxyCodeLine{1019 Molecule::NodeIterator::operator \textcolor{keywordtype}{unsigned} int()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1020     \textcolor{keywordflow}{return} getIndex();}
\DoxyCodeLine{1021 \}}
\DoxyCodeLine{1022 }
\DoxyCodeLine{1023 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a7e91c5498ef57076c1ae1fab987aad5d}{Molecule::NodeIterator::operator++}}() \{}
\DoxyCodeLine{1024     ++idx;}
\DoxyCodeLine{1025     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1026 \}}
\DoxyCodeLine{1027 }
\DoxyCodeLine{1028 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a7e91c5498ef57076c1ae1fab987aad5d}{Molecule::NodeIterator::operator++}}(\textcolor{keywordtype}{int}) \{}
\DoxyCodeLine{1029     \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}} prev = *\textcolor{keyword}{this};}
\DoxyCodeLine{1030     ++(*this);}
\DoxyCodeLine{1031     \textcolor{keywordflow}{return} prev;}
\DoxyCodeLine{1032 \}}
\DoxyCodeLine{1033 }
\DoxyCodeLine{1034 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a8fa5a9c55ba31ba6764381dccf744d7d}{Molecule::NodeIterator::operator-\/-\/}}() \{}
\DoxyCodeLine{1035     -\/-\/idx;}
\DoxyCodeLine{1036     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1037 \}}
\DoxyCodeLine{1038 }
\DoxyCodeLine{1039 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a8fa5a9c55ba31ba6764381dccf744d7d}{Molecule::NodeIterator::operator-\/-\/}}(\textcolor{keywordtype}{int}) \{}
\DoxyCodeLine{1040     \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}} prev = *\textcolor{keyword}{this};}
\DoxyCodeLine{1041     -\/-\/(*this);}
\DoxyCodeLine{1042     \textcolor{keywordflow}{return} prev;}
\DoxyCodeLine{1043 \}}
\DoxyCodeLine{1044 }
\DoxyCodeLine{1045 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a207d566d2d8896940834b2f31d9f1d06}{Molecule::NodeIterator::operator+=}}(\textcolor{keywordtype}{int} offset) \{}
\DoxyCodeLine{1046     idx += offset;}
\DoxyCodeLine{1047     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1048 \}}
\DoxyCodeLine{1049 }
\DoxyCodeLine{1050 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a304236b160397a0acafb9da86f11c35a}{Molecule::NodeIterator::operator-\/=}}(\textcolor{keywordtype}{int} offset) \{}
\DoxyCodeLine{1051     idx -\/= offset;}
\DoxyCodeLine{1052     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1053 \}}
\DoxyCodeLine{1054 }
\DoxyCodeLine{1055 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a8772bf176b248dc6516aeb05d215b613}{Molecule::NodeIterator::operator+}}(\textcolor{keywordtype}{int} offset)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1056     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}}(iterable, idx + offset);}
\DoxyCodeLine{1057 \}}
\DoxyCodeLine{1058 }
\DoxyCodeLine{1059 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a9d35b7c2a293de896beb459ef28bec3d}{Molecule::NodeIterator::operator-\/}}(\textcolor{keywordtype}{int} offset)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1060     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}}(iterable, idx -\/ offset);}
\DoxyCodeLine{1061 \}}
\DoxyCodeLine{1062 }
\DoxyCodeLine{1063 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_acdccb03fb3f35569ef320751b63e325d}{Molecule::NodeIterator::operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1064     \textcolor{keywordflow}{return} idx == iter.idx;}
\DoxyCodeLine{1065 \}}
\DoxyCodeLine{1066 }
\DoxyCodeLine{1067 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_aaf5e7cd3552fccdb68d144d5a1811875}{Molecule::NodeIterator::operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1068     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} == iter);}
\DoxyCodeLine{1069 \}}
\DoxyCodeLine{1070 }
\DoxyCodeLine{1071 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a963b18b0c35d0d571887387fc7934a51}{Molecule::NodeIterator::operator>}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1072     \textcolor{keywordflow}{return} idx < iter.idx;}
\DoxyCodeLine{1073 \}}
\DoxyCodeLine{1074 }
\DoxyCodeLine{1075 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a9005e6f852dde85e408d2c82800dd01e}{Molecule::NodeIterator::operator<}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1076     \textcolor{keywordflow}{return} idx > iter.idx;}
\DoxyCodeLine{1077 \}}
\DoxyCodeLine{1078 }
\DoxyCodeLine{1079 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a6188db396027c98c9df61689eaa7b16d}{Molecule::NodeIterator::operator>=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1080     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} < iter);}
\DoxyCodeLine{1081 \}}
\DoxyCodeLine{1082 }
\DoxyCodeLine{1083 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator_a383142fbdb73230ae1351ebc344c6cc1}{Molecule::NodeIterator::operator<=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{NodeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1084     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} > iter);}
\DoxyCodeLine{1085 \}}
\DoxyCodeLine{1086 }
\DoxyCodeLine{1087 Molecule::NodeIterable::NodeIterable(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&mol)}
\DoxyCodeLine{1088 : mol(mol), \_begin(0), \_end(mol.\mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}}())}
\DoxyCodeLine{1089 \{}
\DoxyCodeLine{1090     \textcolor{comment}{/* empty */}}
\DoxyCodeLine{1091 \}}
\DoxyCodeLine{1092 }
\DoxyCodeLine{1093 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable_a93ca9f19d78899a40883db494030f979}{Molecule::NodeIterable::begin}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1094     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}}(*\textcolor{keyword}{this}, \_begin);}
\DoxyCodeLine{1095 \}}
\DoxyCodeLine{1096 }
\DoxyCodeLine{1097 \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable_a767f322c4ff11ee1186d25c7b7f9cbba}{Molecule::NodeIterable::end}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1098     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterator}{Molecule::NodeIterator}}(*\textcolor{keyword}{this}, \_end);}
\DoxyCodeLine{1099 \}}
\DoxyCodeLine{1100 }
\DoxyCodeLine{1101 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_node_iterable_ac011c126be9e17781413d20b3a948a80}{Molecule::NodeIterable::size}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1102     \textcolor{keywordflow}{return} \_end -\/ \_begin;}
\DoxyCodeLine{1103 \}}
\DoxyCodeLine{1104 }
\DoxyCodeLine{1105 Molecule::EdgeIterator::EdgeIterator(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable}{EdgeIterable}} \&edges, \textcolor{keywordtype}{unsigned} idx) : iterable(edges), idx(idx) \{}
\DoxyCodeLine{1106 \}}
\DoxyCodeLine{1107 }
\DoxyCodeLine{1108 \textcolor{keyword}{const} Molecule::Edge\& Molecule::EdgeIterator::getEdge()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1109     \textcolor{keywordflow}{return} iterable.edges.at(idx);}
\DoxyCodeLine{1110 \}}
\DoxyCodeLine{1111 }
\DoxyCodeLine{1112 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_ad88f7e40ebfe2511a137aa4c92e1d51a}{Molecule::EdgeIterator::getIndex}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1113     \textcolor{keywordflow}{return} getEdge().edgeIndex;}
\DoxyCodeLine{1114 \}}
\DoxyCodeLine{1115 }
\DoxyCodeLine{1116 \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{Molecule::EdgeParameters}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a09e7bf9b99075469f710f08beea71685}{Molecule::EdgeIterator::getParameters}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1117     \textcolor{keywordflow}{return} iterable.mol.getEdgeParameters(getIndex());}
\DoxyCodeLine{1118 \}}
\DoxyCodeLine{1119 }
\DoxyCodeLine{1120 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a72e95da607f48a728dd556cda7e207ae}{Molecule::EdgeIterator::src}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1121     \textcolor{keywordflow}{return} getEdge().selfIndex;}
\DoxyCodeLine{1122 \}}
\DoxyCodeLine{1123 }
\DoxyCodeLine{1124 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_ab072345b8ea0ec27afc7772f9c0a7c1a}{Molecule::EdgeIterator::dest}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1125     \textcolor{keywordflow}{return} getEdge().nodeIndex;}
\DoxyCodeLine{1126 \}}
\DoxyCodeLine{1127 }
\DoxyCodeLine{1128 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a30e4e4bd72065262b480647727a756f4}{Molecule::EdgeIterator::getDirection}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1129     \textcolor{keywordflow}{return} getEdge().direction;}
\DoxyCodeLine{1130 \}}
\DoxyCodeLine{1131 }
\DoxyCodeLine{1132 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a57789b552f047e491ef01f662f4cb0d3}{Molecule::EdgeIterator::operator*}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1133     \textcolor{keywordflow}{return} getIndex();}
\DoxyCodeLine{1134 \}}
\DoxyCodeLine{1135 }
\DoxyCodeLine{1136 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a474258db92785d660b20d5199f2dad29}{Molecule::EdgeIterator::operator[]}}(\textcolor{keywordtype}{int} offset)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1137     \textcolor{keywordflow}{return} *(*\textcolor{keyword}{this} + offset);}
\DoxyCodeLine{1138 \}}
\DoxyCodeLine{1139 }
\DoxyCodeLine{1140 Molecule::EdgeIterator::operator \textcolor{keywordtype}{unsigned} int()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1141     \textcolor{keywordflow}{return} getIndex();}
\DoxyCodeLine{1142 \}}
\DoxyCodeLine{1143         }
\DoxyCodeLine{1144 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a7f4f13887c99c74b0dbfdaac40d01472}{Molecule::EdgeIterator::operator++}}() \{}
\DoxyCodeLine{1145     ++idx;}
\DoxyCodeLine{1146     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1147 \}}
\DoxyCodeLine{1148 }
\DoxyCodeLine{1149 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a7f4f13887c99c74b0dbfdaac40d01472}{Molecule::EdgeIterator::operator++}}(\textcolor{keywordtype}{int}) \{}
\DoxyCodeLine{1150     \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}} prev = *\textcolor{keyword}{this};}
\DoxyCodeLine{1151     ++(*this);}
\DoxyCodeLine{1152     \textcolor{keywordflow}{return} prev;}
\DoxyCodeLine{1153 \}}
\DoxyCodeLine{1154 }
\DoxyCodeLine{1155 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a68c1eea291e0a2b6e8240582366e2067}{Molecule::EdgeIterator::operator-\/-\/}}() \{}
\DoxyCodeLine{1156     -\/-\/idx;}
\DoxyCodeLine{1157     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1158 \}}
\DoxyCodeLine{1159 }
\DoxyCodeLine{1160 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a68c1eea291e0a2b6e8240582366e2067}{Molecule::EdgeIterator::operator-\/-\/}}(\textcolor{keywordtype}{int}) \{}
\DoxyCodeLine{1161     \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}} prev = *\textcolor{keyword}{this};}
\DoxyCodeLine{1162     -\/-\/(*this);}
\DoxyCodeLine{1163     \textcolor{keywordflow}{return} prev;}
\DoxyCodeLine{1164 \}}
\DoxyCodeLine{1165 }
\DoxyCodeLine{1166 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_acbfe20ee73fe60d7dc5f9113184aa243}{Molecule::EdgeIterator::operator+=}}(\textcolor{keywordtype}{int} offset) \{}
\DoxyCodeLine{1167     idx += offset;}
\DoxyCodeLine{1168     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1169 \}}
\DoxyCodeLine{1170 }
\DoxyCodeLine{1171 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}}\& \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a81a47567f40b2f2b59a00e623ae0ba7d}{Molecule::EdgeIterator::operator-\/=}}(\textcolor{keywordtype}{int} offset) \{}
\DoxyCodeLine{1172     idx -\/= offset;}
\DoxyCodeLine{1173     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1174 \}}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a8eb84273f87c1ba1bdc95ed7a38bdb74}{Molecule::EdgeIterator::operator+}}(\textcolor{keywordtype}{int} offset)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1177     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}}(iterable, idx + offset);}
\DoxyCodeLine{1178 \}}
\DoxyCodeLine{1179 }
\DoxyCodeLine{1180 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_af2a54a5b128f4bce68c21aa3156df2e6}{Molecule::EdgeIterator::operator-\/}}(\textcolor{keywordtype}{int} offset)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1181     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}}(iterable, idx -\/ offset);}
\DoxyCodeLine{1182 \}}
\DoxyCodeLine{1183 }
\DoxyCodeLine{1184 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a9caef518cfd1939e0fc1c054fdebc2fb}{Molecule::EdgeIterator::operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1185     \textcolor{keywordflow}{return} idx == iter.idx;}
\DoxyCodeLine{1186 \}}
\DoxyCodeLine{1187 }
\DoxyCodeLine{1188 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a3308b9ac135787346d5068f6c73d3650}{Molecule::EdgeIterator::operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1189     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} == iter);}
\DoxyCodeLine{1190 \}}
\DoxyCodeLine{1191 }
\DoxyCodeLine{1192 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_a808406f7eac9b3b8502d0c89030b4e79}{Molecule::EdgeIterator::operator>}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1193     \textcolor{keywordflow}{return} idx > iter.idx;}
\DoxyCodeLine{1194 \}}
\DoxyCodeLine{1195 }
\DoxyCodeLine{1196 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_af0de103fa148c030788a5715f3c46b72}{Molecule::EdgeIterator::operator<}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1197     \textcolor{keywordflow}{return} idx < iter.idx;}
\DoxyCodeLine{1198 \}}
\DoxyCodeLine{1199 }
\DoxyCodeLine{1200 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_abcb719bc3b5ac22fa2a6b5895ec4070b}{Molecule::EdgeIterator::operator>=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1201     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} < iter);}
\DoxyCodeLine{1202 \}}
\DoxyCodeLine{1203 }
\DoxyCodeLine{1204 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator_ac42d179444c1f9a7b47245cd3d472847}{Molecule::EdgeIterator::operator<=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{EdgeIterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1205     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} > iter);}
\DoxyCodeLine{1206 \}}
\DoxyCodeLine{1207 }
\DoxyCodeLine{1208 Molecule::EdgeIterable::EdgeIterable(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&mol) : mol(mol) \{}
\DoxyCodeLine{1209     \textcolor{keywordtype}{int} sum = 0;}
\DoxyCodeLine{1210     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} node : mol.\mbox{\hyperlink{classudc_1_1_molecule_a57560cc5b9d4d5971c16566f77e2e279}{getNodes}}())}
\DoxyCodeLine{1211         sum += mol.nodes.at(node).neighbors.size();}
\DoxyCodeLine{1212     edges.reserve(sum);}
\DoxyCodeLine{1213     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} node : mol.\mbox{\hyperlink{classudc_1_1_molecule_a57560cc5b9d4d5971c16566f77e2e279}{getNodes}}()) \{}
\DoxyCodeLine{1214         \textcolor{keyword}{auto} neighbors = mol.nodes.at(node).neighbors;}
\DoxyCodeLine{1215         edges.insert(edges.end(), neighbors.begin(), neighbors.end());}
\DoxyCodeLine{1216     \}}
\DoxyCodeLine{1217 \}}
\DoxyCodeLine{1218 }
\DoxyCodeLine{1219 Molecule::EdgeIterable::EdgeIterable(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule_a4a38e660030e37a46905b99fb87be886}{Molecule}} \&mol, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} node) :mol(mol) \{}
\DoxyCodeLine{1220     edges = mol.nodes.at(node).neighbors;}
\DoxyCodeLine{1221 \}}
\DoxyCodeLine{1222 }
\DoxyCodeLine{1223 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable_a6ad09c81e1ffd3a9d71ba1db9073e6cc}{Molecule::EdgeIterable::begin}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1224     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}}(*\textcolor{keyword}{this}, 0);}
\DoxyCodeLine{1225 \}}
\DoxyCodeLine{1226 }
\DoxyCodeLine{1227 \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable_a25744b1ee7e22c419406eed7c40c8e29}{Molecule::EdgeIterable::end}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1228     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterator}{Molecule::EdgeIterator}}(*\textcolor{keyword}{this}, edges.size());}
\DoxyCodeLine{1229 \}}
\DoxyCodeLine{1230 }
\DoxyCodeLine{1231 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_molecule_1_1_edge_iterable_af058dfb0b3208a64abd7d1c5ace96783}{Molecule::EdgeIterable::size}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1232     \textcolor{keywordflow}{return} edges.size();}
\DoxyCodeLine{1233 \}}
\DoxyCodeLine{1234 }
\DoxyCodeLine{1235 Molecule::Instance::Instance(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{Molecule}} \&prototype, \mbox{\hyperlink{namespace_m_s_d}{MSD}} \&msd, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z,}
\DoxyCodeLine{1236         \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&initSpin, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&initFlux)}
\DoxyCodeLine{1237 : prototype(prototype), msd(msd), y(y), z(z)}
\DoxyCodeLine{1238 \{}
\DoxyCodeLine{1239     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} N = prototype.nodes.size();}
\DoxyCodeLine{1240 }
\DoxyCodeLine{1241     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = initSpin;}
\DoxyCodeLine{1242     s.\mbox{\hyperlink{classudc_1_1_vector_ac385aa5781a8b72847e6b28dcaa5e917}{normalize}}();}
\DoxyCodeLine{1243     spins.reserve(N);}
\DoxyCodeLine{1244     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < N; i++)}
\DoxyCodeLine{1245         spins.push\_back(s * prototype.nodes[i].parameters.Sm);}
\DoxyCodeLine{1246     }
\DoxyCodeLine{1247     \textcolor{keywordflow}{if} (initFlux == \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}}) \{}
\DoxyCodeLine{1248         fluxes.assign(N, \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}});}
\DoxyCodeLine{1249     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1250         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f = initFlux;}
\DoxyCodeLine{1251         f.\mbox{\hyperlink{classudc_1_1_vector_ac385aa5781a8b72847e6b28dcaa5e917}{normalize}}();}
\DoxyCodeLine{1252         fluxes.reserve(N);}
\DoxyCodeLine{1253         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < N; i++) \{}
\DoxyCodeLine{1254             \textcolor{keyword}{const} \textcolor{keywordtype}{double} Fm = prototype.nodes[i].parameters.Fm;}
\DoxyCodeLine{1255             fluxes.push\_back(initFlux.\mbox{\hyperlink{classudc_1_1_vector_a5c3eb6000799a6fc4756f029b9b67e98}{normSq}}() <= \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(Fm) ? initFlux : f * Fm);}
\DoxyCodeLine{1256         \}}
\DoxyCodeLine{1257     \}}
\DoxyCodeLine{1258 \}}
\DoxyCodeLine{1259 }
\DoxyCodeLine{1260 Molecule::Instance::Instance(\textcolor{keyword}{const} Instance \&other)}
\DoxyCodeLine{1261 : prototype(other.prototype), msd(other.msd), y(y), z(z), spins(other.spins), fluxes(other.fluxes)}
\DoxyCodeLine{1262 \{\}}
\DoxyCodeLine{1263 }
\DoxyCodeLine{1264 Molecule::Instance\& Molecule::Instance::operator=(\textcolor{keyword}{const} Molecule::Instance \&other) \{}
\DoxyCodeLine{1265     this-\/>spins = other.spins;}
\DoxyCodeLine{1266     this-\/>fluxes = other.fluxes;}
\DoxyCodeLine{1267     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1268 \}}
\DoxyCodeLine{1269 }
\DoxyCodeLine{1270 \textcolor{keywordtype}{void} Molecule::Instance::setLocalM(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} Vector \&spin, \textcolor{keyword}{const} Vector \&flux) \{}
\DoxyCodeLine{1271     Vector \&s = spins.at(a);   \textcolor{comment}{// previous spin}}
\DoxyCodeLine{1272     Vector \&f = fluxes.at(a);  \textcolor{comment}{// previous flux}}
\DoxyCodeLine{1273 }
\DoxyCodeLine{1274     Vector m = s + f;          \textcolor{comment}{// previous local mag.}}
\DoxyCodeLine{1275     Vector mag = spin + flux;  \textcolor{comment}{// new local mag.}}
\DoxyCodeLine{1276 }
\DoxyCodeLine{1277     Vector deltaS = spin -\/ s;}
\DoxyCodeLine{1278     Vector deltaF = flux -\/ f;}
\DoxyCodeLine{1279     Vector deltaM = mag -\/ m;}
\DoxyCodeLine{1280 }
\DoxyCodeLine{1281     \textcolor{keyword}{const} Node \&node = prototype.nodes[a];}
\DoxyCodeLine{1282     \textcolor{keyword}{const} MSD::Parameters \&msdParams = msd.parameters;}
\DoxyCodeLine{1283     \textcolor{keyword}{const} \mbox{\hyperlink{_m_s_d-export_8cpp_a3ff276dcf7d10876c4783799c899bfd9}{NodeParameters}} \&nodeParams = node.parameters;}
\DoxyCodeLine{1284 }
\DoxyCodeLine{1285     MSD::Results \&results = msd.results;}
\DoxyCodeLine{1286 }
\DoxyCodeLine{1287     \textcolor{comment}{// -\/-\/-\/-\/ update magnetization, M -\/-\/-\/-\/}}
\DoxyCodeLine{1288     results.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}} += deltaM;}
\DoxyCodeLine{1289     results.MS += deltaS;}
\DoxyCodeLine{1290     results.MF += deltaF;}
\DoxyCodeLine{1291 }
\DoxyCodeLine{1292     results.Mm += deltaM;}
\DoxyCodeLine{1293     results.MSm += deltaS;}
\DoxyCodeLine{1294     results.MFm += deltaF;}
\DoxyCodeLine{1295 }
\DoxyCodeLine{1296     \textcolor{comment}{// -\/-\/-\/-\/ update energy, U -\/-\/-\/-\/}}
\DoxyCodeLine{1297     \textcolor{comment}{// local energy}}
\DoxyCodeLine{1298     \{   \textcolor{keywordtype}{double} deltaU = msdParams.B * deltaM}
\DoxyCodeLine{1299                       + nodeParams.Am * ( Vector(\mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.x), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.y), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.z)) -\/ Vector(\mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.x), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.y), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.z)) )}
\DoxyCodeLine{1300                       + nodeParams.Je0m * ( spin * flux -\/ s * f );}
\DoxyCodeLine{1301         results.U -\/= deltaU;}
\DoxyCodeLine{1302         results.Um -\/= deltaU;}
\DoxyCodeLine{1303     \}}
\DoxyCodeLine{1304 }
\DoxyCodeLine{1305     \textcolor{comment}{// energy from edges (i.e. bonds)}}
\DoxyCodeLine{1306     \textcolor{keywordflow}{for} (\textcolor{keyword}{const} Edge \&edge : node.neighbors) \{}
\DoxyCodeLine{1307         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = edge.nodeIndex;  \textcolor{comment}{// index of neighbor}}
\DoxyCodeLine{1308         Vector neighbor\_s = spins[a1];}
\DoxyCodeLine{1309         Vector neighbor\_f = fluxes[a1];}
\DoxyCodeLine{1310         Vector neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{1311         \textcolor{keyword}{const} \mbox{\hyperlink{_m_s_d-export_8cpp_a96023113198b7a6641f22f1a6b05d84a}{EdgeParameters}} \&edgeParams = prototype.edgeParameters[edge.edgeIndex];}
\DoxyCodeLine{1312         \textcolor{keywordtype}{double} deltaU = edgeParams.Jm * ( neighbor\_s * deltaS )}
\DoxyCodeLine{1313                       + edgeParams.Je1m * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{1314                       + edgeParams.Jeem * ( neighbor\_f * deltaF )}
\DoxyCodeLine{1315                       + edgeParams.bm * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{1316                       + edgeParams.Dm * (edge.direction * deltaM.crossProduct(neighbor\_m));  \textcolor{comment}{// uses edge.direction to solve anti-\/communative property of crossProduct}}
\DoxyCodeLine{1317         results.U -\/= deltaU;}
\DoxyCodeLine{1318         results.Um -\/= deltaU;}
\DoxyCodeLine{1319     \}}
\DoxyCodeLine{1320 }
\DoxyCodeLine{1321     \textcolor{comment}{// energy from leads}}
\DoxyCodeLine{1322     \textcolor{keywordflow}{if} (msd.mol\_exists) \{}
\DoxyCodeLine{1323         \textcolor{keyword}{const} \textcolor{keyword}{auto} \&msdSpins = msd.spins;}
\DoxyCodeLine{1324         \textcolor{keyword}{const} \textcolor{keyword}{auto} \&msdFluxes = msd.fluxes;}
\DoxyCodeLine{1325 }
\DoxyCodeLine{1326         \textcolor{comment}{// left lead}}
\DoxyCodeLine{1327         \textcolor{keywordflow}{if} (a == prototype.leftLead \&\& msd.FM\_L\_exists) \{}
\DoxyCodeLine{1328             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = msd.index(msd.molPosL -\/ 1, y, z);}
\DoxyCodeLine{1329             Vector neighbor\_s = msdSpins[a1];}
\DoxyCodeLine{1330             Vector neighbor\_f = msdFluxes[a1];}
\DoxyCodeLine{1331             Vector neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{1332             \textcolor{keywordtype}{double} deltaU = msdParams.JmL * ( neighbor\_s * deltaS )}
\DoxyCodeLine{1333                           + msdParams.Je1mL * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{1334                           + msdParams.JeemL * ( neighbor\_f * deltaF )}
\DoxyCodeLine{1335                           + msdParams.bmL * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{1336                           + msdParams.DmL * neighbor\_m.crossProduct(deltaM);  \textcolor{comment}{// pos(neighbor\_m) < pos(deltaM)}}
\DoxyCodeLine{1337             results.U -\/= deltaU;}
\DoxyCodeLine{1338             results.UmL -\/= deltaU;}
\DoxyCodeLine{1339         \}}
\DoxyCodeLine{1340 }
\DoxyCodeLine{1341         \textcolor{comment}{// right lead}}
\DoxyCodeLine{1342         \textcolor{keywordflow}{if} (a == prototype.rightLead \&\& msd.FM\_R\_exists) \{}
\DoxyCodeLine{1343             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = msd.index(msd.molPosR + 1, y, z);}
\DoxyCodeLine{1344             Vector neighbor\_s = msdSpins[a1];}
\DoxyCodeLine{1345             Vector neighbor\_f = msdFluxes[a1];}
\DoxyCodeLine{1346             Vector neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{1347             \textcolor{keywordtype}{double} deltaU = msdParams.JmR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{1348                           + msdParams.Je1mR * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{1349                           + msdParams.JeemR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{1350                           + msdParams.bmR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{1351                           + msdParams.DmR * deltaM.crossProduct(neighbor\_m);  \textcolor{comment}{// pos(deltaM) < pos(neighbor\_m)}}
\DoxyCodeLine{1352             results.U -\/= deltaU;}
\DoxyCodeLine{1353             results.UmR -\/= deltaU;}
\DoxyCodeLine{1354         \}}
\DoxyCodeLine{1355     \}}
\DoxyCodeLine{1356 }
\DoxyCodeLine{1357     \textcolor{comment}{// -\/-\/-\/-\/ Done: update spin and flux values -\/-\/-\/-\/}}
\DoxyCodeLine{1358     s = spin;}
\DoxyCodeLine{1359     f = flux;}
\DoxyCodeLine{1360 \}}
\DoxyCodeLine{1361 }
\DoxyCodeLine{1362 \textcolor{keywordtype}{void} Molecule::Instance::setSpin(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} Vector \&spin) \{}
\DoxyCodeLine{1363     setLocalM(a, spin, getFlux(a));}
\DoxyCodeLine{1364 \}}
\DoxyCodeLine{1365 }
\DoxyCodeLine{1366 \textcolor{keywordtype}{void} Molecule::Instance::setFlux(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} Vector \&flux) \{}
\DoxyCodeLine{1367     setLocalM(a, getSpin(a), flux);}
\DoxyCodeLine{1368 \}}
\DoxyCodeLine{1369 }
\DoxyCodeLine{1370 Vector Molecule::Instance::getSpin(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1371     \textcolor{keywordflow}{return} spins.at(a);}
\DoxyCodeLine{1372 \}}
\DoxyCodeLine{1373 }
\DoxyCodeLine{1374 Vector Molecule::Instance::getFlux(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1375     \textcolor{keywordflow}{return} fluxes.at(a);}
\DoxyCodeLine{1376 \}}
\DoxyCodeLine{1377 }
\DoxyCodeLine{1378 \textcolor{keywordtype}{void} Molecule::Instance::getLocalM(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, Vector \&spin, Vector \&flux)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1379     spin = spins.at(a);}
\DoxyCodeLine{1380     flux = fluxes.at(a);}
\DoxyCodeLine{1381 \}}
\DoxyCodeLine{1382 }
\DoxyCodeLine{1383 Molecule::Instance Molecule::instantiate(\mbox{\hyperlink{namespace_m_s_d}{MSD}} \&msd, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1384     \textcolor{keywordflow}{return} Instance(*\textcolor{keyword}{this}, msd, y, z);}
\DoxyCodeLine{1385 \}}
\DoxyCodeLine{1386 }
\DoxyCodeLine{1387 }
\DoxyCodeLine{1388 \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ad972cfd353c72aa28063ac74d9bed3cf}{MSD::Parameters::Parameters}}()}
\DoxyCodeLine{1389 : kT(0.25), B(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}),}
\DoxyCodeLine{1390   SL(1), SR(1), FL(0), FR(0),}
\DoxyCodeLine{1391   JL(1), JR(1), JmL(1), JmR(-\/1), JLR(0),}
\DoxyCodeLine{1392   Je0L(0), Je0R(0),}
\DoxyCodeLine{1393   Je1L(0), Je1R(0), Je1mL(0), Je1mR(0), Je1LR(0),}
\DoxyCodeLine{1394   JeeL(0), JeeR(0), JeemL(0), JeemR(0), JeeLR(0),}
\DoxyCodeLine{1395   bL(0), bR(0), bmL(0), bmR(0), bLR(0),}
\DoxyCodeLine{1396   AL(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), AR(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}),}
\DoxyCodeLine{1397   DL(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), DR(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), DmL(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), DmR(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), DLR(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}) \{}
\DoxyCodeLine{1398 \}}
\DoxyCodeLine{1399 }
\DoxyCodeLine{1400 \textcolor{keywordtype}{bool} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a7a0a0b93af506366c206f39a8adabfa9}{MSD::Parameters::operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{Parameters}} \&p)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1401     \textcolor{keywordflow}{return}  kT == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aea19a4bd6b6b630bb5255c6f3206d67d}{kT}}}
\DoxyCodeLine{1402         \&\&  B  == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a7df654a8138c850e64de4adea7c5776a}{B}}}
\DoxyCodeLine{1403 }
\DoxyCodeLine{1404         \&\&  SL    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9347bd5ecace963e09c974e2e6236f40}{SL}}    \&\&  SR    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aad0f4bd2d0ba9b01de8f6830b4d77f09}{SR}}}
\DoxyCodeLine{1405         \&\&  FL    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a55712b42b9d9460519b2ffc4a24cdd96}{FL}}    \&\&  FR    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a3b84c7bdff2e5acbf7e2aee9f4f87380}{FR}}}
\DoxyCodeLine{1406         \&\&  JL    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a4de534ffb37d66a609206ecfbc79a4a3}{JL}}    \&\&  JR    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a626eb888da1ae30b0fd04fd60bbf5b4a}{JR}}    \&\&  JmL   == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a570769f809bfc17b833b760025d54635}{JmL}}    \&\&  JmR  == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a11d9a80a263371635f53ad14232b7c10}{JmR}}     \&\&  JLR   == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a876665131291f40627d234de2636e7a5}{JLR}}}
\DoxyCodeLine{1407         \&\&  Je0L  == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a38fbdb6de5465d21767e5acdd70e4e46}{Je0L}}  \&\&  Je0R  == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a0fd1a65ab83a4cfc0aed753762a71f1c}{Je0R}}}
\DoxyCodeLine{1408         \&\&  Je1L  == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_adab3e0cfbf9f3c60b828d70e9a7853cd}{Je1L}}  \&\&  Je1R  == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a1f5a1b2902f4152f4027c9a6d66546dd}{Je1R}}  \&\&  Je1mL == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_acf66b51f1494866fe609eabf57790989}{Je1mL}}  \&\&  Je1mR == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a6357fcbf8fe7d799c10bb33853fe5fd7}{Je1mR}}  \&\&  Je1LR == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_afe51f061d0cda85616e3a04ecb34cb85}{Je1LR}}}
\DoxyCodeLine{1409         \&\&  JeeL  == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a01e7b66d243045c1253a7f2e8c70ab03}{JeeL}}  \&\&  JeeR  == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a4d3e4c3b64dfded7ac1c07c45f71fb6e}{JeeR}}  \&\&  JeemL == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aed49e5aed77920be09b8323a0cee2781}{JeemL}}  \&\&  JeemR == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aa2775ee2661215984de3caf7832c0f13}{JeemR}}  \&\&  JeeLR == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a316117cf75ee335416c34e938960b8a1}{JeeLR}}}
\DoxyCodeLine{1410         \&\&  bL    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_afe3cfa8886ebb734fbe817c8dd254d8f}{bL}}    \&\&  bR    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9e807cec26c1219ef16f3e26f67a926a}{bR}}    \&\&  bmL   == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ac35c301b854f5d76621b39774776bf22}{bmL}}    \&\&  bmR   == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a0f4027af582ca01b7db0941641227ac5}{bmR}}    \&\&  bLR   == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a022b5b93636d04f81172635825796469}{bLR}}}
\DoxyCodeLine{1411         \&\&  AL    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a9d8c4ad2396d258736c0d5985feaca55}{AL}}    \&\&  AR    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_aa97373f0348686a6f2c1abbbf35aeb1a}{AR}}}
\DoxyCodeLine{1412         \&\&  DL    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_af8bbfb0d4941170abb9cb20874d37177}{DL}}    \&\&  DR    == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a6c585701e1e89a881bbfe9d1eee5d64c}{DR}}    \&\&  DmL   == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_af0493729f1925de734f4d595643fa09f}{DmL}}    \&\&  DmR   == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a2bf4786615f44fd118d255aa59bf8190}{DmR}}    \&\&  DLR   == p.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ab293ea7698715b6f29b0c0b007a85a4e}{DLR}};}
\DoxyCodeLine{1413 \}}
\DoxyCodeLine{1414 }
\DoxyCodeLine{1415 \textcolor{keywordtype}{bool} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_ae6d8e34b3fb5bf65b69b8fd7b870d71a}{MSD::Parameters::operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{Parameters}} \&p)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1416     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} == p);}
\DoxyCodeLine{1417 \}}
\DoxyCodeLine{1418 }
\DoxyCodeLine{1419 }
\DoxyCodeLine{1420 \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_acab69dbb27e71f71fd874272e036dcc6}{MSD::Results::Results}}()}
\DoxyCodeLine{1421 : t(0), M(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), ML(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), MR(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), Mm(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}),}
\DoxyCodeLine{1422   MS(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), MSL(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), MSR(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), MSm(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}),}
\DoxyCodeLine{1423   MF(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), MFL(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), MFR(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}), MFm(\mbox{\hyperlink{classudc_1_1_vector}{Vector}}::\mbox{\hyperlink{_m_s_d-export_8cpp_a83fb9b8b75a91604f1a1f39dc898cf9e}{ZERO}}),}
\DoxyCodeLine{1424   U(0), UL(0), UR(0), Um(0), UmL(0), UmR(0), ULR(0) \{}
\DoxyCodeLine{1425 \}}
\DoxyCodeLine{1426 }
\DoxyCodeLine{1427 \textcolor{keywordtype}{bool} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab6fb2b0afd66ea58ae596c7d34bd42f0}{MSD::Results::operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1428     \textcolor{keywordflow}{return} t == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}}
\DoxyCodeLine{1429 }
\DoxyCodeLine{1430         \&\&  M   == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}}    \&\&  ML  == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}}   \&\&  MR  == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}}   \&\&  Mm  == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}}}
\DoxyCodeLine{1431         \&\&  MS  == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_aeae2f7666be87f8d4499d612567fe71a}{MS}}   \&\&  MSL == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a020102ea8f3621b4791a75de90624ade}{MSL}}  \&\&  MSR == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66823c7a278ea165067eadaf62c976d0}{MSR}}  \&\&  MSm == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a42f24fd034f5acf41d415093def18fa5}{MSm}}}
\DoxyCodeLine{1432         \&\&  MF  == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a789b09f14dc037a00b59733ef5e6b8fe}{MF}}   \&\&  MFL == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1a6be402d985814748b000dce6b983e9}{MFL}}  \&\&  MFR == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66d2b20d7c955c704ce31b355419ee45}{MFR}}  \&\&  MFm == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac3c2f0d86900c360181e14073842f9a5}{MFm}}}
\DoxyCodeLine{1433         \&\&  U   == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}}    \&\&  UL  == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}}   \&\&  UR  == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}}   \&\&  Um  == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}}  \&\&  UmL == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}}  \&\&  UmR == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}}  \&\&  ULR == r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}};}
\DoxyCodeLine{1434 \}}
\DoxyCodeLine{1435 }
\DoxyCodeLine{1436 \textcolor{keywordtype}{bool} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_aedd99e890f8609ae49464003794fd263}{MSD::Results::operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1437     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} == r);}
\DoxyCodeLine{1438 \}}
\DoxyCodeLine{1439 }
\DoxyCodeLine{1440 }
\DoxyCodeLine{1441 MSD::Iterator::Iterator(\textcolor{keyword}{const} \mbox{\hyperlink{namespace_m_s_d}{MSD}} \&msd, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i) : msd(msd), i(i) \{}
\DoxyCodeLine{1442 \}}
\DoxyCodeLine{1443 }
\DoxyCodeLine{1444 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a8ad36deb75ea34c351470a210dc5f8df}{MSD::Iterator::getIndex}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1445     \textcolor{keywordflow}{return} msd.indices.at(i);}
\DoxyCodeLine{1446 \}}
\DoxyCodeLine{1447 }
\DoxyCodeLine{1448 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aff3d00d1f3d3abc57ab3e1708f22046e}{MSD::Iterator::getX}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1449     \textcolor{keywordflow}{return} msd.x( getIndex() );}
\DoxyCodeLine{1450 \}}
\DoxyCodeLine{1451 }
\DoxyCodeLine{1452 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a74a04cdef90898fe9ecac8fe91a67cec}{MSD::Iterator::getY}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1453     \textcolor{keywordflow}{return} msd.y( getIndex() );}
\DoxyCodeLine{1454 \}}
\DoxyCodeLine{1455 }
\DoxyCodeLine{1456 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a6b7cdba16db28e6b16dbf1f60361a83b}{MSD::Iterator::getZ}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1457     \textcolor{keywordflow}{return} msd.z( getIndex() );}
\DoxyCodeLine{1458 \}}
\DoxyCodeLine{1459 }
\DoxyCodeLine{1460 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_afea68bb7dba79b2747964d9d1d52cdfe}{MSD::Iterator::getSpin}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1461     \textcolor{keywordflow}{return} msd.\mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}( this-\/>getIndex() );}
\DoxyCodeLine{1462 \}}
\DoxyCodeLine{1463 }
\DoxyCodeLine{1464 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_abd996192129eb23f7679d731bb831e08}{MSD::Iterator::getFlux}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1465     \textcolor{keywordflow}{return} msd.\mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}( this-\/>getIndex() );}
\DoxyCodeLine{1466 \}}
\DoxyCodeLine{1467 }
\DoxyCodeLine{1468 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a8c8ea6d938c5e7497e26d36bd603c7b3}{MSD::Iterator::getLocalM}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1469     \textcolor{keywordflow}{return} msd.\mbox{\hyperlink{classudc_1_1_m_s_d_af0cad12dfc8de11dfbbb600672b94a53}{getLocalM}}( this-\/>getIndex() );}
\DoxyCodeLine{1470 \}}
\DoxyCodeLine{1471 }
\DoxyCodeLine{1472 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_abb6e962e7a330c8a6deb53b4af1a33eb}{MSD::Iterator::operator*}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1473     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_af0cad12dfc8de11dfbbb600672b94a53}{getLocalM}}();}
\DoxyCodeLine{1474 \}}
\DoxyCodeLine{1475 }
\DoxyCodeLine{1476 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a9d84bb256488be2f19c519c1edc94bf2}{MSD::Iterator::operator[]}}(\textcolor{keywordtype}{int} n)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1477     \textcolor{keywordflow}{return} *(*\textcolor{keyword}{this} + n);}
\DoxyCodeLine{1478 \}}
\DoxyCodeLine{1479 }
\DoxyCodeLine{1480 MSD::Iterator::operator \textcolor{keywordtype}{unsigned} int()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1481     \textcolor{keywordflow}{return} getIndex();}
\DoxyCodeLine{1482 \}}
\DoxyCodeLine{1483 }
\DoxyCodeLine{1484 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}}\& \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aa2acdacfb5a3b245e86d52caf6ccee5b}{MSD::Iterator::operator++}}() \{}
\DoxyCodeLine{1485     \textcolor{keywordflow}{if} (i >= msd.indices.size())}
\DoxyCodeLine{1486         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}can't increment MSD::Iterator == msd.end()"{}});}
\DoxyCodeLine{1487     ++i;}
\DoxyCodeLine{1488     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1489 \}}
\DoxyCodeLine{1490 }
\DoxyCodeLine{1491 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aa2acdacfb5a3b245e86d52caf6ccee5b}{MSD::Iterator::operator++}}(\textcolor{keywordtype}{int}) \{}
\DoxyCodeLine{1492     \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} prev = *\textcolor{keyword}{this};}
\DoxyCodeLine{1493     ++(*this);}
\DoxyCodeLine{1494     \textcolor{keywordflow}{return} prev;}
\DoxyCodeLine{1495 \}}
\DoxyCodeLine{1496 }
\DoxyCodeLine{1497 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}}\& \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a9b7068af2426eff599c7898cc556d80c}{MSD::Iterator::operator-\/-\/}}() \{}
\DoxyCodeLine{1498     \textcolor{keywordflow}{if} (i <= 0)}
\DoxyCodeLine{1499         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}can't decrement MSD::Iterator == msd.begin()"{}});}
\DoxyCodeLine{1500     -\/-\/i;}
\DoxyCodeLine{1501     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1502 \}}
\DoxyCodeLine{1503 }
\DoxyCodeLine{1504 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a9b7068af2426eff599c7898cc556d80c}{MSD::Iterator::operator-\/-\/}}(\textcolor{keywordtype}{int}) \{}
\DoxyCodeLine{1505     \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} prev = *\textcolor{keyword}{this};}
\DoxyCodeLine{1506     -\/-\/(*this);}
\DoxyCodeLine{1507     \textcolor{keywordflow}{return} prev;}
\DoxyCodeLine{1508 \}}
\DoxyCodeLine{1509 }
\DoxyCodeLine{1510 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}}\& \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_ae6a30558ca84c5c83e220f5f565c9337}{MSD::Iterator::operator+=}}(\textcolor{keywordtype}{int} n) \{}
\DoxyCodeLine{1511     \textcolor{keywordflow}{if}( n < 0 )}
\DoxyCodeLine{1512         \textcolor{keywordflow}{return} *\textcolor{keyword}{this} -\/= -\/n;}
\DoxyCodeLine{1513     }
\DoxyCodeLine{1514     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} sum = i + n; }
\DoxyCodeLine{1515     \textcolor{keywordflow}{if} (sum > msd.indices.size())}
\DoxyCodeLine{1516         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}can't increment past msd.end()"{}});}
\DoxyCodeLine{1517     i = sum;}
\DoxyCodeLine{1518     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1519 \}}
\DoxyCodeLine{1520 }
\DoxyCodeLine{1521 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}}\& \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_ae815a105b76ecd74ffbca42059dd66d5}{MSD::Iterator::operator-\/=}}(\textcolor{keywordtype}{int} n) \{}
\DoxyCodeLine{1522     \textcolor{keywordflow}{if}( n < 0 )}
\DoxyCodeLine{1523         \textcolor{keywordflow}{return} *\textcolor{keyword}{this} += -\/n;}
\DoxyCodeLine{1524     }
\DoxyCodeLine{1525     \textcolor{keywordflow}{if} (n > i)}
\DoxyCodeLine{1526         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}can't decrement past msd.begin()"{}});}
\DoxyCodeLine{1527     i -\/= n;}
\DoxyCodeLine{1528     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{1529 \}}
\DoxyCodeLine{1530 }
\DoxyCodeLine{1531 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a36610ced86cca4e0b20b3cae881bc949}{MSD::Iterator::operator+}}(\textcolor{keywordtype}{int} n)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1532     \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} iter = *\textcolor{keyword}{this};}
\DoxyCodeLine{1533     iter += n;}
\DoxyCodeLine{1534     \textcolor{keywordflow}{return} iter;}
\DoxyCodeLine{1535 \}}
\DoxyCodeLine{1536 }
\DoxyCodeLine{1537 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_ad552ff63add04ee2f65ce2b635c82a3f}{MSD::Iterator::operator-\/}}(\textcolor{keywordtype}{int} n)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1538     \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} iter = *\textcolor{keyword}{this};}
\DoxyCodeLine{1539     iter -\/= n;}
\DoxyCodeLine{1540     \textcolor{keywordflow}{return} iter;}
\DoxyCodeLine{1541 \}}
\DoxyCodeLine{1542 }
\DoxyCodeLine{1543 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aa5f4db2e3ab06026529de54a9c22b7a4}{MSD::Iterator::operator==}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1544     \textcolor{keywordflow}{if}( \&msd != \&iter.msd )}
\DoxyCodeLine{1545         \textcolor{keywordflow}{throw} invalid\_argument(\textcolor{stringliteral}{"{}must compare two iterators from the same MSD"{}});}
\DoxyCodeLine{1546     \textcolor{keywordflow}{return} i == iter.i;}
\DoxyCodeLine{1547 \}}
\DoxyCodeLine{1548 }
\DoxyCodeLine{1549 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_abfe94ce7e6d750efea5d32a705fe3cd3}{MSD::Iterator::operator!=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1550     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} == iter);}
\DoxyCodeLine{1551 \}}
\DoxyCodeLine{1552 }
\DoxyCodeLine{1553 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a066d2acce9354012cdbf70dcc7b4cc99}{MSD::Iterator::operator>}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1554     \textcolor{keywordflow}{if}( \&msd != \&iter.msd )}
\DoxyCodeLine{1555         \textcolor{keywordflow}{throw} invalid\_argument(\textcolor{stringliteral}{"{}must compare two iterators from the same MSD"{}});}
\DoxyCodeLine{1556     \textcolor{keywordflow}{return} i > iter.i;}
\DoxyCodeLine{1557 \}}
\DoxyCodeLine{1558 }
\DoxyCodeLine{1559 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_aa1571de940e3cd6061568b26f6fd27c8}{MSD::Iterator::operator<}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1560     \textcolor{keywordflow}{if}( \&msd != \&iter.msd )}
\DoxyCodeLine{1561         \textcolor{keywordflow}{throw} invalid\_argument(\textcolor{stringliteral}{"{}must compare two iterators from the same MSD"{}});}
\DoxyCodeLine{1562     \textcolor{keywordflow}{return} i < iter.i;}
\DoxyCodeLine{1563 \}}
\DoxyCodeLine{1564 }
\DoxyCodeLine{1565 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a62aed3f164b19a1581de95ddee11cde9}{MSD::Iterator::operator>=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1566     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} < iter);}
\DoxyCodeLine{1567 \}}
\DoxyCodeLine{1568 }
\DoxyCodeLine{1569 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator_a7c6a05177dd8932f7baa9aa441a59096}{MSD::Iterator::operator<=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}} \&iter)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1570     \textcolor{keywordflow}{return} !(*\textcolor{keyword}{this} > iter);}
\DoxyCodeLine{1571 \}}
\DoxyCodeLine{1572 }
\DoxyCodeLine{1573 }
\DoxyCodeLine{1574 \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_a3d235795ecc459cc0c2069c3f05d089d}{MSD::FlippingAlgorithm}} \mbox{\hyperlink{classudc_1_1_m_s_d_a7010b43c1e96eca520bcefba7aa36ad3}{MSD::UP\_DOWN\_MODEL}} = [](\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin, function<double()> rand) \{}
\DoxyCodeLine{1575     \textcolor{keywordflow}{return} -\/spin;}
\DoxyCodeLine{1576 \};}
\DoxyCodeLine{1577 }
\DoxyCodeLine{1578 \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_a3d235795ecc459cc0c2069c3f05d089d}{MSD::FlippingAlgorithm}} \mbox{\hyperlink{classudc_1_1_m_s_d_a82cedfe873fa654afa32ab3d1b6f3ead}{MSD::CONTINUOUS\_SPIN\_MODEL}} = [](\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin, function<double()> rand) \{}
\DoxyCodeLine{1579     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_vector_a89b43ddd10a372d584a03a5583ad5652}{Vector::sphericalForm}}( spin.\mbox{\hyperlink{classudc_1_1_vector_ad0a32e923bceab96a3a1eb36b9cc5e3a}{norm}}(), 2 * PI * rand(), asin(2 * rand() -\/ 1) );}
\DoxyCodeLine{1580 \};}
\DoxyCodeLine{1581 }
\DoxyCodeLine{1582 \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MSD::MolProtoFactory}} \mbox{\hyperlink{classudc_1_1_m_s_d_ac578f0076fce752e661058c648d88997}{MSD::LINEAR\_MOL}} = [](\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}) \{}
\DoxyCodeLine{1583     \mbox{\hyperlink{_m_s_d-export_8cpp_aec2cc3918e5933a0bad019dd661cdbef}{MolProto}} mol(\mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}});}
\DoxyCodeLine{1584     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 1; i < \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}; i++)}
\DoxyCodeLine{1585         mol.connectNodes(i -\/ 1, i);}
\DoxyCodeLine{1586     mol.setLeads(0, \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}} -\/ 1);}
\DoxyCodeLine{1587     \textcolor{keywordflow}{return} mol;}
\DoxyCodeLine{1588 \};}
\DoxyCodeLine{1589 }
\DoxyCodeLine{1590 \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MSD::MolProtoFactory}} \mbox{\hyperlink{classudc_1_1_m_s_d_a72708188b46e1ddffb7c6e2fec96c587}{MSD::CIRCULAR\_MOL}} = [](\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}) \{}
\DoxyCodeLine{1591     \mbox{\hyperlink{_m_s_d-export_8cpp_aec2cc3918e5933a0bad019dd661cdbef}{MolProto}} mol(\mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}});}
\DoxyCodeLine{1592     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 1; i < \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}; i++)}
\DoxyCodeLine{1593         mol.connectNodes(i -\/ 1, i);}
\DoxyCodeLine{1594     \textcolor{keywordflow}{if} (\mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}} >= 2)}
\DoxyCodeLine{1595         mol.connectNodes(\mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}} -\/ 1, 0);}
\DoxyCodeLine{1596     mol.setLeads(0, \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}} / 2);}
\DoxyCodeLine{1597     \textcolor{keywordflow}{return} mol;}
\DoxyCodeLine{1598 \};}
\DoxyCodeLine{1599 }
\DoxyCodeLine{1600 }
\DoxyCodeLine{1601 Vector MSD::initSpin = \mbox{\hyperlink{classudc_1_1_vector_a969618e05cff7f052ae3e9fcf7b49104}{Vector::J}};}
\DoxyCodeLine{1602 Vector MSD::initFlux = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{1603 }
\DoxyCodeLine{1604 }
\DoxyCodeLine{1605 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} MSD::index(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1606     \textcolor{keywordflow}{return} (z * height + y) * width + x;}
\DoxyCodeLine{1607 \}}
\DoxyCodeLine{1608 }
\DoxyCodeLine{1609 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} MSD::x(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1610     \textcolor{keywordflow}{return} a \% width;}
\DoxyCodeLine{1611 \}}
\DoxyCodeLine{1612 }
\DoxyCodeLine{1613 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} MSD::y(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1614     \textcolor{keywordflow}{return} a \% (width * height) / width;}
\DoxyCodeLine{1615 \}}
\DoxyCodeLine{1616 }
\DoxyCodeLine{1617 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} MSD::z(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1618     \textcolor{keywordflow}{return} a / (width * height);}
\DoxyCodeLine{1619 \}}
\DoxyCodeLine{1620 }
\DoxyCodeLine{1621 }
\DoxyCodeLine{1622 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} MSD::genSeed() \{}
\DoxyCodeLine{1623     \textcolor{keywordflow}{return} (  \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\textcolor{keyword}{>}(time(NULL))      << 16 )}
\DoxyCodeLine{1624          | ( (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\textcolor{keyword}{>}(clock()) \& 0xFF) << 8  )}
\DoxyCodeLine{1625          | ( (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\textcolor{keyword}{>}(seed\_count++) \& 0xFF) );}
\DoxyCodeLine{1626 \}}
\DoxyCodeLine{1627 }
\DoxyCodeLine{1628 }
\DoxyCodeLine{1629 \textcolor{comment}{// Note: "{}molProtoFactory"{} is a pointer so that it can be NULL}}
\DoxyCodeLine{1630 \textcolor{keywordtype}{void} MSD::init(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MolProtoFactory}} *molProtoFactory) \{}
\DoxyCodeLine{1631     \textcolor{comment}{// preconditions:}}
\DoxyCodeLine{1632     \textcolor{keywordflow}{if} (width == 0)         width = 1;}
\DoxyCodeLine{1633     \textcolor{keywordflow}{if} (height == 0)        height = 1;}
\DoxyCodeLine{1634     \textcolor{keywordflow}{if} (depth == 0)         depth = 1;}
\DoxyCodeLine{1635     \textcolor{keywordflow}{if} (molPosR >= width)   molPosR = width -\/ 1;}
\DoxyCodeLine{1636     \textcolor{keywordflow}{if} (molPosL > width)    molPosL = width;}
\DoxyCodeLine{1637     \textcolor{keywordflow}{if} (molPosR < molPosL)  molPosR = molPosL -\/ 1;}
\DoxyCodeLine{1638     \textcolor{keywordflow}{if} (bottomL >= height)  bottomL = height -\/ 1;}
\DoxyCodeLine{1639     \textcolor{keywordflow}{if} (topL > height)      topL = height;}
\DoxyCodeLine{1640     \textcolor{keywordflow}{if} (bottomL < topL)     topL = bottomL -\/ 1;}
\DoxyCodeLine{1641     \textcolor{keywordflow}{if} (backR >= depth)     backR = depth -\/ 1;}
\DoxyCodeLine{1642     \textcolor{keywordflow}{if} (frontR > depth)     frontR = depth;}
\DoxyCodeLine{1643     \textcolor{keywordflow}{if} (backR < frontR)     backR = frontR -\/ 1;}
\DoxyCodeLine{1644 }
\DoxyCodeLine{1645     spins.resize(width * height * depth);}
\DoxyCodeLine{1646     fluxes.resize(width * height * depth);}
\DoxyCodeLine{1647 }
\DoxyCodeLine{1648     FM\_L\_exists = (molPosL != 0);}
\DoxyCodeLine{1649     FM\_R\_exists = (molPosR + 1 < width);}
\DoxyCodeLine{1650     mol\_exists = (molPosL <= molPosR);}
\DoxyCodeLine{1651 }
\DoxyCodeLine{1652     \textcolor{keywordflow}{if} (mol\_exists) \{}
\DoxyCodeLine{1653         mols.\mbox{\hyperlink{classudc_1_1_sparse_array_afdf642eb989638bb62e21563f83baa1c}{resize}}(width * height * depth);}
\DoxyCodeLine{1654         \textcolor{keywordflow}{if} (molProtoFactory != NULL)}
\DoxyCodeLine{1655             molProto = (*molProtoFactory)(molPosR -\/ molPosL + 1);}
\DoxyCodeLine{1656     \}}
\DoxyCodeLine{1657 }
\DoxyCodeLine{1658     seed = genSeed();}
\DoxyCodeLine{1659     prng.seed(seed);}
\DoxyCodeLine{1660     }
\DoxyCodeLine{1661     n = nL = nR = n\_m = n\_mL = n\_mR = nLR = 0;}
\DoxyCodeLine{1662     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a;}
\DoxyCodeLine{1663     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = 0; z < depth; z++ )}
\DoxyCodeLine{1664         \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = 0; y < height; y++ ) \{}
\DoxyCodeLine{1665             \textcolor{comment}{// left}}
\DoxyCodeLine{1666             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = 0; x < molPosL; x++ )}
\DoxyCodeLine{1667                 \textcolor{keywordflow}{if} (topL <= y \&\& y <= bottomL) \{}
\DoxyCodeLine{1668                     a = index(x, y, z);}
\DoxyCodeLine{1669                     indices.push\_back(a);}
\DoxyCodeLine{1670                     spins[a] = initSpin;}
\DoxyCodeLine{1671                     fluxes[a] = initFlux;}
\DoxyCodeLine{1672                     n++;}
\DoxyCodeLine{1673                     nL++;}
\DoxyCodeLine{1674                     \textcolor{keywordflow}{if} (x + 1 == molPosL) \{}
\DoxyCodeLine{1675                         \textcolor{keywordflow}{if} (mol\_exists)}
\DoxyCodeLine{1676                             n\_mL++;}
\DoxyCodeLine{1677                         \textcolor{keywordflow}{if} (FM\_R\_exists)}
\DoxyCodeLine{1678                             nLR++;}
\DoxyCodeLine{1679                     \}}
\DoxyCodeLine{1680                 \}}
\DoxyCodeLine{1681             \textcolor{comment}{// mol}}
\DoxyCodeLine{1682             \textcolor{keywordflow}{if}( mol\_exists \&\& (((y == topL || y == bottomL) \&\& (frontR <= z \&\& z <= backR)) || ((z == frontR || z == backR) \&\& (topL <= y \&\& y <= bottomL))) ) \{}
\DoxyCodeLine{1683                 shared\_ptr<Mol> mol = shared\_ptr<Mol>(\textcolor{keyword}{new} \mbox{\hyperlink{classudc_1_1_m_s_d_ab3c0b3e8474e18cb213f79d66f221b67}{Mol}}(molProto, *\textcolor{keyword}{this}, y, z, initSpin, initFlux));}
\DoxyCodeLine{1684                 unique\_mol\_indices.push\_back(index(molPosL, y, z));  \textcolor{comment}{// store the indices for all unique Mol (Molecule::Instance) objects}}
\DoxyCodeLine{1685                 \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = molPosL; x <= molPosR; x++ ) \{}
\DoxyCodeLine{1686                     a = index(x, y, z);}
\DoxyCodeLine{1687                     indices.push\_back(a);}
\DoxyCodeLine{1688                     mols[a] = mol;}
\DoxyCodeLine{1689                     n++;}
\DoxyCodeLine{1690                     n\_m++;}
\DoxyCodeLine{1691                     \textcolor{keywordflow}{if} (x == molPosL \&\& FM\_L\_exists)}
\DoxyCodeLine{1692                         n\_mL++;}
\DoxyCodeLine{1693                     \textcolor{keywordflow}{if} (x == molPosR \&\& FM\_R\_exists)}
\DoxyCodeLine{1694                         n\_mR++;}
\DoxyCodeLine{1695                 \}}
\DoxyCodeLine{1696             \}}
\DoxyCodeLine{1697             \textcolor{comment}{// right}}
\DoxyCodeLine{1698             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = molPosR + 1; x < width; x++ )}
\DoxyCodeLine{1699                 \textcolor{keywordflow}{if} (frontR <= z \&\& z <= backR) \{}
\DoxyCodeLine{1700                     a = index(x, y, z);}
\DoxyCodeLine{1701                     indices.push\_back(a);}
\DoxyCodeLine{1702                     spins[a] = initSpin;}
\DoxyCodeLine{1703                     fluxes[a] = initFlux;}
\DoxyCodeLine{1704                     n++;}
\DoxyCodeLine{1705                     nR++;}
\DoxyCodeLine{1706                     \textcolor{keywordflow}{if} (x == molPosR + 1) \{}
\DoxyCodeLine{1707                         \textcolor{keywordflow}{if} (mol\_exists)}
\DoxyCodeLine{1708                             n\_mR++;}
\DoxyCodeLine{1709                         \textcolor{keywordflow}{if} (FM\_L\_exists)}
\DoxyCodeLine{1710                             nLR++;}
\DoxyCodeLine{1711                     \}}
\DoxyCodeLine{1712                 \}}
\DoxyCodeLine{1713         \}}
\DoxyCodeLine{1714     }
\DoxyCodeLine{1715     \mbox{\hyperlink{classudc_1_1_m_s_d_a2ccd325cf09e82420004de9702894de5}{flippingAlgorithm}} = \mbox{\hyperlink{classudc_1_1_m_s_d_a82cedfe873fa654afa32ab3d1b6f3ead}{CONTINUOUS\_SPIN\_MODEL}}; \textcolor{comment}{// set default "{}flipping"{} algorithm}}
\DoxyCodeLine{1716 }
\DoxyCodeLine{1717     \mbox{\hyperlink{classudc_1_1_m_s_d_aa1513f639c10ca29773ea287ae104121}{setParameters}}(parameters); \textcolor{comment}{// calculate initial state ("{}Results"{}) for FM sections}}
\DoxyCodeLine{1718     \mbox{\hyperlink{classudc_1_1_m_s_d_aa8ed0dab0705b810e4d14215b488fb43}{setMolProto}}(molProto);     \textcolor{comment}{// calculate initial state ("{}Results"{}) for mol. section}}
\DoxyCodeLine{1719 \}}
\DoxyCodeLine{1720 }
\DoxyCodeLine{1721 \mbox{\hyperlink{class_m_s_d_1_1_m_s_d}{MSD::MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth,}
\DoxyCodeLine{1722         \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{MolProto}} \&molProto, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosL,}
\DoxyCodeLine{1723         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} topL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bottomL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} frontR, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} backR)}
\DoxyCodeLine{1724 : width(width), height(height), depth(depth), molPosL(molPosL), molPosR(molProto.\mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}() -\/ 1),}
\DoxyCodeLine{1725         topL(topL), bottomL(bottomL), frontR(frontR), backR(backR), molProto(molProto)}
\DoxyCodeLine{1726 \{}
\DoxyCodeLine{1727     init();}
\DoxyCodeLine{1728 \}}
\DoxyCodeLine{1729 }
\DoxyCodeLine{1730 \mbox{\hyperlink{class_m_s_d_1_1_m_s_d}{MSD::MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth,}
\DoxyCodeLine{1731             \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_aa5aef25b88fee8190e1ac32070d06d66}{MolProtoFactory}} \&molType, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosR,}
\DoxyCodeLine{1732             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} topL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bottomL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} frontR, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} backR)}
\DoxyCodeLine{1733 : width(width), height(height), depth(depth), molPosL(molPosL), molPosR(molPosR),}
\DoxyCodeLine{1734         topL(topL), bottomL(bottomL), frontR(frontR), backR(backR)}
\DoxyCodeLine{1735 \{}
\DoxyCodeLine{1736     init(\&molType);}
\DoxyCodeLine{1737 \}}
\DoxyCodeLine{1738 }
\DoxyCodeLine{1739 \mbox{\hyperlink{class_m_s_d_1_1_m_s_d}{MSD::MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth,}
\DoxyCodeLine{1740         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} molPosR,}
\DoxyCodeLine{1741         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} topL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bottomL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} frontR, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} backR)}
\DoxyCodeLine{1742 : width(width), height(height), depth(depth), molPosL(molPosL), molPosR(molPosR),}
\DoxyCodeLine{1743         topL(topL), bottomL(bottomL), frontR(frontR), backR(backR)}
\DoxyCodeLine{1744 \{}
\DoxyCodeLine{1745     init(\&\mbox{\hyperlink{classudc_1_1_m_s_d_ac578f0076fce752e661058c648d88997}{LINEAR\_MOL}});}
\DoxyCodeLine{1746 \}}
\DoxyCodeLine{1747 }
\DoxyCodeLine{1748 }
\DoxyCodeLine{1749 \mbox{\hyperlink{class_m_s_d_1_1_m_s_d}{MSD::MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth,}
\DoxyCodeLine{1750         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} heightL, \textcolor{keywordtype}{unsigned} depthR)}
\DoxyCodeLine{1751 : width(width), height(height), depth(depth), molPosL((width -\/ 1) / 2), molPosR((width -\/ 1) / 2),}
\DoxyCodeLine{1752         topL( (unsigned int) ceil((height -\/ 1 -\/ heightL) / 2.0) ),}
\DoxyCodeLine{1753         bottomL( (unsigned int) floor((height -\/ 1 + heightL) / 2.0) ),}
\DoxyCodeLine{1754         frontR( (unsigned int) ceil((depth -\/ 1 -\/ depthR) / 2.0) ),}
\DoxyCodeLine{1755         backR( (unsigned int) floor((depth -\/ 1 + depthR) / 2.0) )}
\DoxyCodeLine{1756 \{}
\DoxyCodeLine{1757     init(\&\mbox{\hyperlink{classudc_1_1_m_s_d_ac578f0076fce752e661058c648d88997}{LINEAR\_MOL}});}
\DoxyCodeLine{1758 \}}
\DoxyCodeLine{1759 }
\DoxyCodeLine{1760 }
\DoxyCodeLine{1761 \mbox{\hyperlink{class_m_s_d_1_1_m_s_d}{MSD::MSD}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} depth)}
\DoxyCodeLine{1762 : width(width), height(height), depth(depth), molPosL((width -\/ 1) / 2), molPosR(width / 2),}
\DoxyCodeLine{1763         topL(0), bottomL(height -\/ 1), frontR(0), backR(depth -\/ 1)}
\DoxyCodeLine{1764 \{}
\DoxyCodeLine{1765     init(\&\mbox{\hyperlink{classudc_1_1_m_s_d_ac578f0076fce752e661058c648d88997}{LINEAR\_MOL}});}
\DoxyCodeLine{1766 \}}
\DoxyCodeLine{1767 }
\DoxyCodeLine{1768 \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{MSD::Parameters}} \mbox{\hyperlink{classudc_1_1_m_s_d_abfa4f6883d0b4677ab7b70c1adf06066}{MSD::getParameters}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{1769     \textcolor{keywordflow}{return} parameters;}
\DoxyCodeLine{1770 \}}
\DoxyCodeLine{1771 }
\DoxyCodeLine{1772 \textcolor{comment}{// Molecule parameters can no longer be changed with MSD::setParameters().}}
\DoxyCodeLine{1773 \textcolor{comment}{// Instead use MSD::setMolProto() to change mol type.}}
\DoxyCodeLine{1774 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_aa1513f639c10ca29773ea287ae104121}{MSD::setParameters}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{MSD::Parameters}} \&p) \{}
\DoxyCodeLine{1775     \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters}{MSD::Parameters}} p0 = parameters;  \textcolor{comment}{// old parameters}}
\DoxyCodeLine{1776     parameters = p;  \textcolor{comment}{// update to new parameters}}
\DoxyCodeLine{1777     }
\DoxyCodeLine{1778     \textcolor{comment}{// -\/-\/-\/-\/-\/ Spin and Spin Flux Magnitudes -\/-\/-\/-\/-\/}}
\DoxyCodeLine{1779     \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iter = \mbox{\hyperlink{classudc_1_1_m_s_d_afb91b037de5315bfde0159ee591267a3}{begin}}(); iter != \mbox{\hyperlink{classudc_1_1_m_s_d_a917317363ac8e2e78840845d6fc49f91}{end}}(); ++iter ) \{}
\DoxyCodeLine{1780         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = iter.getIndex();}
\DoxyCodeLine{1781         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = iter.getX();}
\DoxyCodeLine{1782         \textcolor{keywordflow}{if}( x < molPosL ) \{}
\DoxyCodeLine{1783             spins[i].normalize() *= parameters.SL;}
\DoxyCodeLine{1784             fluxes[i] *= p0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a55712b42b9d9460519b2ffc4a24cdd96}{FL}} != 0 ? parameters.FL / p0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a55712b42b9d9460519b2ffc4a24cdd96}{FL}} : 0;}
\DoxyCodeLine{1785         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( x > molPosR ) \{}
\DoxyCodeLine{1786             spins[i].normalize() *= parameters.SR;}
\DoxyCodeLine{1787             fluxes[i] *= p0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a3b84c7bdff2e5acbf7e2aee9f4f87380}{FR}} != 0 ? parameters.FR / p0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_parameters_a3b84c7bdff2e5acbf7e2aee9f4f87380}{FR}} : 0;}
\DoxyCodeLine{1788         \} \textcolor{comment}{// else, mol: do nothing (see: MSD::setMolProto)}}
\DoxyCodeLine{1789     \}}
\DoxyCodeLine{1790     }
\DoxyCodeLine{1791     \textcolor{comment}{// -\/-\/-\/-\/-\/ Magnetization, Anisotropy, and other local phenomenon -\/-\/-\/-\/-\/}}
\DoxyCodeLine{1792     results.MSL = results.MSR = results.MFL = results.MFR = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{1793     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} anisotropy\_L = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}}, anisotropy\_R = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{1794     \textcolor{keywordtype}{double} couple\_e0\_L = 0, couple\_e0\_R = 0;  \textcolor{comment}{// sum(s\_i * f\_i)}}
\DoxyCodeLine{1795     \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} iter = \mbox{\hyperlink{classudc_1_1_m_s_d_afb91b037de5315bfde0159ee591267a3}{begin}}(); iter != \mbox{\hyperlink{classudc_1_1_m_s_d_a917317363ac8e2e78840845d6fc49f91}{end}}(); ++iter ) \{}
\DoxyCodeLine{1796         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = iter.getX();}
\DoxyCodeLine{1797         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = iter.getSpin();}
\DoxyCodeLine{1798         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f = iter.getFlux();}
\DoxyCodeLine{1799         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} localM = s + f;}
\DoxyCodeLine{1800         \textcolor{keywordflow}{if}( x < molPosL ) \{}
\DoxyCodeLine{1801             results.MSL += s;}
\DoxyCodeLine{1802             results.MFL += f;}
\DoxyCodeLine{1803             anisotropy\_L.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}} += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}( localM.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}} );}
\DoxyCodeLine{1804             anisotropy\_L.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}} += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}( localM.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}} );}
\DoxyCodeLine{1805             anisotropy\_L.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}} += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}( localM.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}} );}
\DoxyCodeLine{1806             couple\_e0\_L += s * f;}
\DoxyCodeLine{1807         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( x > molPosR ) \{}
\DoxyCodeLine{1808             results.MSR += s;}
\DoxyCodeLine{1809             results.MFR += f;}
\DoxyCodeLine{1810             anisotropy\_R.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}} += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}( localM.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}} );}
\DoxyCodeLine{1811             anisotropy\_R.y += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}( localM.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}} );}
\DoxyCodeLine{1812             anisotropy\_R.z += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}( localM.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}} );}
\DoxyCodeLine{1813             couple\_e0\_R += s * f;}
\DoxyCodeLine{1814         \} \textcolor{comment}{// else, mol: do nothing (see: MSD::setMolProto)}}
\DoxyCodeLine{1815     \}}
\DoxyCodeLine{1816     results.MS = results.MSL + results.MSR + results.MSm;  \textcolor{comment}{// aggregate spins}}
\DoxyCodeLine{1817     results.MF = results.MFL + results.MFR + results.MFm;  \textcolor{comment}{// aggregate fluxes}}
\DoxyCodeLine{1818     results.ML = results.MSL + results.MFL;  \textcolor{comment}{// aggregate Left FM}}
\DoxyCodeLine{1819     results.MR = results.MSR + results.MFR;  \textcolor{comment}{// aggregate Right FM}}
\DoxyCodeLine{1820     results.M = results.ML + results.MR + results.Mm;  \textcolor{comment}{// aggregate total}}
\DoxyCodeLine{1821     }
\DoxyCodeLine{1822 }
\DoxyCodeLine{1823     \textcolor{comment}{// -\/-\/-\/-\/-\/ Internal Energy -\/-\/-\/-\/-\/}}
\DoxyCodeLine{1824     \textcolor{comment}{// left section (FM\_L)}}
\DoxyCodeLine{1825     \textcolor{keywordtype}{double} couple\_ss\_L = 0;  \textcolor{comment}{// sum(s\_i * s\_j)}}
\DoxyCodeLine{1826     \textcolor{keywordtype}{double} couple\_e1\_L = 0;  \textcolor{comment}{// sum(s\_i * f\_j)}}
\DoxyCodeLine{1827     \textcolor{keywordtype}{double} couple\_ee\_L = 0;  \textcolor{comment}{// sum(f\_i * f\_j)}}
\DoxyCodeLine{1828     \textcolor{keywordtype}{double} biquad\_L = 0;}
\DoxyCodeLine{1829     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dmi\_L = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};  \textcolor{comment}{// sum(m\_i x m\_j);  where x is cross product, and i < j}}
\DoxyCodeLine{1830     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = 0; z < depth; z++ )}
\DoxyCodeLine{1831         \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = topL; y <= bottomL; y++ )}
\DoxyCodeLine{1832             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = 0; x < molPosL; x++ ) \{}
\DoxyCodeLine{1833                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a = index(x, y, z);}
\DoxyCodeLine{1834                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a);}
\DoxyCodeLine{1835                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a);}
\DoxyCodeLine{1836                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m = s + f;}
\DoxyCodeLine{1837                 \textcolor{keywordflow}{if}( x + 1 < molPosL ) \{}
\DoxyCodeLine{1838                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(x + 1, y, z);}
\DoxyCodeLine{1839                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{1840                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{1841                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{1842                     couple\_ss\_L += s * spin;}
\DoxyCodeLine{1843                     couple\_e1\_L += s * flux;}
\DoxyCodeLine{1844                     couple\_e1\_L += f * spin;}
\DoxyCodeLine{1845                     couple\_ee\_L += f * flux;}
\DoxyCodeLine{1846                     biquad\_L += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{1847                     dmi\_L += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag);}
\DoxyCodeLine{1848                 \}}
\DoxyCodeLine{1849                 \textcolor{keywordflow}{if}( y + 1 <= bottomL ) \{}
\DoxyCodeLine{1850                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(x, y + 1, z);}
\DoxyCodeLine{1851                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{1852                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{1853                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{1854                     couple\_ss\_L += s * spin;}
\DoxyCodeLine{1855                     couple\_e1\_L += s * flux;}
\DoxyCodeLine{1856                     couple\_e1\_L += f * spin;}
\DoxyCodeLine{1857                     couple\_ee\_L += f * flux;}
\DoxyCodeLine{1858                     biquad\_L += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{1859                     dmi\_L += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag);}
\DoxyCodeLine{1860                 \}}
\DoxyCodeLine{1861                 \textcolor{keywordflow}{if}( z + 1 < depth ) \{}
\DoxyCodeLine{1862                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(x, y, z + 1);}
\DoxyCodeLine{1863                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{1864                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{1865                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{1866                     couple\_ss\_L += s * spin;}
\DoxyCodeLine{1867                     couple\_e1\_L += s * flux;}
\DoxyCodeLine{1868                     couple\_e1\_L += f * spin;}
\DoxyCodeLine{1869                     couple\_ee\_L += f * flux;}
\DoxyCodeLine{1870                     biquad\_L += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{1871                     dmi\_L += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag);}
\DoxyCodeLine{1872                 \}}
\DoxyCodeLine{1873             \}}
\DoxyCodeLine{1874     results.UL = 0;}
\DoxyCodeLine{1875     results.UL -\/= parameters.JL * couple\_ss\_L;}
\DoxyCodeLine{1876     results.UL -\/= parameters.Je0L * couple\_e0\_L;}
\DoxyCodeLine{1877     results.UL -\/= parameters.Je1L * couple\_e1\_L;}
\DoxyCodeLine{1878     results.UL -\/= parameters.JeeL * couple\_ee\_L;}
\DoxyCodeLine{1879     results.UL -\/= parameters.B * results.ML;}
\DoxyCodeLine{1880     results.UL -\/= parameters.AL * anisotropy\_L;}
\DoxyCodeLine{1881     results.UL -\/= parameters.bL * biquad\_L;}
\DoxyCodeLine{1882     results.UL -\/= parameters.DL * dmi\_L;}
\DoxyCodeLine{1883     }
\DoxyCodeLine{1884     \textcolor{comment}{// right section (FM\_R)}}
\DoxyCodeLine{1885     \textcolor{keywordtype}{double} couple\_ss\_R = 0;  \textcolor{comment}{// sum(s\_i * s\_j)}}
\DoxyCodeLine{1886     \textcolor{keywordtype}{double} couple\_e1\_R = 0;  \textcolor{comment}{// sum(s\_i * f\_j)}}
\DoxyCodeLine{1887     \textcolor{keywordtype}{double} couple\_ee\_R = 0;  \textcolor{comment}{// sum(f\_i * f\_j)}}
\DoxyCodeLine{1888     \textcolor{keywordtype}{double} biquad\_R = 0;}
\DoxyCodeLine{1889     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dmi\_R = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};  \textcolor{comment}{// sum(m\_i x m\_j);  where x is cross product, and i < j}}
\DoxyCodeLine{1890     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = frontR; z <= backR; z++ )}
\DoxyCodeLine{1891         \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = 0; y < height; y++ )}
\DoxyCodeLine{1892             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = molPosR + 1; x < width; x++ ) \{}
\DoxyCodeLine{1893                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a = index(x, y, z);}
\DoxyCodeLine{1894                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a);}
\DoxyCodeLine{1895                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a);}
\DoxyCodeLine{1896                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m = s + f;}
\DoxyCodeLine{1897                 \textcolor{keywordflow}{if}( x + 1 < width ) \{}
\DoxyCodeLine{1898                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(x + 1, y, z);}
\DoxyCodeLine{1899                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{1900                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{1901                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{1902                     couple\_ss\_R += s * spin;}
\DoxyCodeLine{1903                     couple\_e1\_R += s * flux;}
\DoxyCodeLine{1904                     couple\_e1\_R += f * spin;}
\DoxyCodeLine{1905                     couple\_ee\_R += f * flux;}
\DoxyCodeLine{1906                     biquad\_R += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{1907                     dmi\_R += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag);}
\DoxyCodeLine{1908                 \}}
\DoxyCodeLine{1909                 \textcolor{keywordflow}{if}( y + 1 < height ) \{}
\DoxyCodeLine{1910                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(x, y + 1, z);}
\DoxyCodeLine{1911                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{1912                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{1913                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{1914                     couple\_ss\_R += s * spin;}
\DoxyCodeLine{1915                     couple\_e1\_R += s * flux;}
\DoxyCodeLine{1916                     couple\_e1\_R += f * spin;}
\DoxyCodeLine{1917                     couple\_ee\_R += f * flux;}
\DoxyCodeLine{1918                     biquad\_R += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{1919                     dmi\_R += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag);}
\DoxyCodeLine{1920                 \}}
\DoxyCodeLine{1921                 \textcolor{keywordflow}{if}( z + 1 <= backR ) \{}
\DoxyCodeLine{1922                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(x, y, z + 1);}
\DoxyCodeLine{1923                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{1924                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{1925                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{1926                     couple\_ss\_R += s * spin;}
\DoxyCodeLine{1927                     couple\_e1\_R += s * flux;}
\DoxyCodeLine{1928                     couple\_e1\_R += f * spin;}
\DoxyCodeLine{1929                     couple\_ee\_R += f * flux;}
\DoxyCodeLine{1930                     biquad\_R += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{1931                     dmi\_R += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag);}
\DoxyCodeLine{1932                 \}}
\DoxyCodeLine{1933             \}}
\DoxyCodeLine{1934     results.UR = 0;}
\DoxyCodeLine{1935     results.UR -\/= parameters.JR * couple\_ss\_R;}
\DoxyCodeLine{1936     results.UR -\/= parameters.Je0R * couple\_e0\_R;}
\DoxyCodeLine{1937     results.UR -\/= parameters.Je1R * couple\_e1\_R;}
\DoxyCodeLine{1938     results.UR -\/= parameters.JeeR * couple\_ee\_R;}
\DoxyCodeLine{1939     results.UR -\/= parameters.B * results.MR;}
\DoxyCodeLine{1940     results.UR -\/= parameters.AR * anisotropy\_R;}
\DoxyCodeLine{1941     results.UR -\/= parameters.bR * biquad\_R;}
\DoxyCodeLine{1942     results.UR -\/= parameters.DR * dmi\_R;}
\DoxyCodeLine{1943 }
\DoxyCodeLine{1944     \textcolor{comment}{// no need to re-\/compute results.Um (see: MSD::setMolProto)}}
\DoxyCodeLine{1945     }
\DoxyCodeLine{1946     \textcolor{comment}{// "{}mL"{} secttion (coupling between FM\_L and mol.)}}
\DoxyCodeLine{1947     \textcolor{keywordtype}{double} couple\_ss\_mL = 0;  \textcolor{comment}{// sum(s\_i * s\_j)}}
\DoxyCodeLine{1948     \textcolor{keywordtype}{double} couple\_e1\_mL = 0;  \textcolor{comment}{// sum(s\_i * f\_j)}}
\DoxyCodeLine{1949     \textcolor{keywordtype}{double} couple\_ee\_mL = 0;  \textcolor{comment}{// sum(f\_i * f\_j)}}
\DoxyCodeLine{1950     \textcolor{keywordtype}{double} biquad\_mL = 0;}
\DoxyCodeLine{1951     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dmi\_mL = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};  \textcolor{comment}{// sum(m\_i x m\_j);  where x is cross product, and i < j}}
\DoxyCodeLine{1952     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x1 = molPosL -\/ 1; \textcolor{comment}{// only useful if( molPosL != 0 ); i.e. FM\_L\_exists}}
\DoxyCodeLine{1953     \textcolor{keywordflow}{if}( FM\_L\_exists \&\& mol\_exists )}
\DoxyCodeLine{1954         \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = topL; y <= bottomL; y++ )}
\DoxyCodeLine{1955             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = frontR; z <= backR; z++ )}
\DoxyCodeLine{1956                 \textcolor{keywordflow}{if}( y == topL || z == frontR || y == bottomL || z == backR ) \{}
\DoxyCodeLine{1957                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a = index(x1, y, z);}
\DoxyCodeLine{1958                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a);}
\DoxyCodeLine{1959                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a);}
\DoxyCodeLine{1960                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m = s + f;}
\DoxyCodeLine{1961                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(molPosL + molProto.leftLead, y, z);}
\DoxyCodeLine{1962                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{1963                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{1964                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{1965                     couple\_ss\_mL += s * spin;}
\DoxyCodeLine{1966                     couple\_e1\_mL += s * flux;}
\DoxyCodeLine{1967                     couple\_e1\_mL += f * spin;}
\DoxyCodeLine{1968                     couple\_ee\_mL += f * flux;}
\DoxyCodeLine{1969                     biquad\_mL += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{1970                     dmi\_mL += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag);  \textcolor{comment}{// location(m)=x1 in FM\_L < location(mag)=molPosL + leftLead in mol.}}
\DoxyCodeLine{1971                 \}}
\DoxyCodeLine{1972     results.UmL = 0;}
\DoxyCodeLine{1973     results.UmL -\/= parameters.JmL * couple\_ss\_mL;}
\DoxyCodeLine{1974     results.UmL -\/= parameters.Je1mL * couple\_e1\_mL;}
\DoxyCodeLine{1975     results.UmL -\/= parameters.JeemL * couple\_ee\_mL;}
\DoxyCodeLine{1976     results.UmL -\/= parameters.bmL * biquad\_mL;}
\DoxyCodeLine{1977     results.UmL -\/= parameters.DmL * dmi\_mL;}
\DoxyCodeLine{1978     }
\DoxyCodeLine{1979     \textcolor{comment}{// "{}mR"{} section (coupling between mol. and FM\_R)}}
\DoxyCodeLine{1980     \textcolor{keywordtype}{double} couple\_ss\_mR = 0;  \textcolor{comment}{// sum(s\_i * s\_j)}}
\DoxyCodeLine{1981     \textcolor{keywordtype}{double} couple\_e1\_mR = 0;  \textcolor{comment}{// sum(s\_i * f\_j)}}
\DoxyCodeLine{1982     \textcolor{keywordtype}{double} couple\_ee\_mR = 0;  \textcolor{comment}{// sum(f\_i * f\_j)}}
\DoxyCodeLine{1983     \textcolor{keywordtype}{double} biquad\_mR = 0;}
\DoxyCodeLine{1984     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dmi\_mR = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};  \textcolor{comment}{// sum(m\_i x m\_j);  where x is cross product, and i < j}}
\DoxyCodeLine{1985     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x2 = molPosR + 1; \textcolor{comment}{// only useful if( molPosR != width -\/ 1 ); i.e. FM\_R\_exists}}
\DoxyCodeLine{1986     \textcolor{keywordflow}{if}( FM\_R\_exists \&\& mol\_exists )}
\DoxyCodeLine{1987         \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = topL; y <= bottomL; y++ )}
\DoxyCodeLine{1988             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = frontR; z <= backR; z++ )}
\DoxyCodeLine{1989                 \textcolor{keywordflow}{if}( y == topL || z == frontR || y == bottomL || z == backR ) \{}
\DoxyCodeLine{1990                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a = index(molPosL + molProto.rightLead, y, z);}
\DoxyCodeLine{1991                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a);}
\DoxyCodeLine{1992                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a);}
\DoxyCodeLine{1993                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m = s + f;}
\DoxyCodeLine{1994                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(x2, y, z);}
\DoxyCodeLine{1995                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{1996                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{1997                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{1998                     couple\_ss\_mR += s * spin;}
\DoxyCodeLine{1999                     couple\_e1\_mR += s * flux;}
\DoxyCodeLine{2000                     couple\_e1\_mR += f * spin;}
\DoxyCodeLine{2001                     couple\_ee\_mR += f * flux;}
\DoxyCodeLine{2002                     biquad\_mR += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{2003                     dmi\_mR += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag); \textcolor{comment}{// location(m)=molPosL + rightLead in mol. < location(mag)=x2 in FM\_R}}
\DoxyCodeLine{2004                 \}}
\DoxyCodeLine{2005     results.UmR = 0;}
\DoxyCodeLine{2006     results.UmR -\/= parameters.JmR * couple\_ss\_mR;}
\DoxyCodeLine{2007     results.UmR -\/= parameters.Je1mR * couple\_e1\_mR;}
\DoxyCodeLine{2008     results.UmR -\/= parameters.JeemR * couple\_ee\_mR;}
\DoxyCodeLine{2009     results.UmR -\/= parameters.bmR * biquad\_mR;}
\DoxyCodeLine{2010     results.UmR -\/= parameters.DmR * dmi\_mR;}
\DoxyCodeLine{2011     }
\DoxyCodeLine{2012     \textcolor{comment}{// "{}LR"{} section (coupling between FM\_L and FM\_R)}}
\DoxyCodeLine{2013     \textcolor{keywordtype}{double} couple\_ss\_LR = 0;  \textcolor{comment}{// sum(s\_i * s\_j)}}
\DoxyCodeLine{2014     \textcolor{keywordtype}{double} couple\_e1\_LR = 0;  \textcolor{comment}{// sum(s\_i * f\_j)}}
\DoxyCodeLine{2015     \textcolor{keywordtype}{double} couple\_ee\_LR = 0;  \textcolor{comment}{// sum(f\_i * f\_j)}}
\DoxyCodeLine{2016     \textcolor{keywordtype}{double} biquad\_LR = 0;}
\DoxyCodeLine{2017     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dmi\_LR = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};  \textcolor{comment}{// sum(m\_i x m\_j);  where x is cross product, and i < j}}
\DoxyCodeLine{2018     \textcolor{keywordflow}{if}( FM\_L\_exists \&\& FM\_R\_exists )}
\DoxyCodeLine{2019         \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = frontR; z <= backR; z++ )}
\DoxyCodeLine{2020             \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = topL; y <= bottomL; y++ ) \{}
\DoxyCodeLine{2021                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a = index(x1, y, z);}
\DoxyCodeLine{2022                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a);}
\DoxyCodeLine{2023                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a);}
\DoxyCodeLine{2024                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m = s + f;}
\DoxyCodeLine{2025                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighbor = index(x2, y, z);}
\DoxyCodeLine{2026                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} spin = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(neighbor);}
\DoxyCodeLine{2027                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} flux = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(neighbor);}
\DoxyCodeLine{2028                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux;}
\DoxyCodeLine{2029                 couple\_ss\_LR += s * spin;}
\DoxyCodeLine{2030                 couple\_e1\_LR += s * flux;}
\DoxyCodeLine{2031                 couple\_e1\_LR += f * spin;}
\DoxyCodeLine{2032                 couple\_ee\_LR += f * flux;}
\DoxyCodeLine{2033                 biquad\_LR += \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m * mag);}
\DoxyCodeLine{2034                 dmi\_LR += m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(mag); \textcolor{comment}{// location(m) = x1 in FM\_L < location(mag) = x2 in FM\_R}}
\DoxyCodeLine{2035             \}}
\DoxyCodeLine{2036     results.ULR = 0;}
\DoxyCodeLine{2037     results.ULR -\/= parameters.JLR * couple\_ss\_LR;}
\DoxyCodeLine{2038     results.ULR -\/= parameters.Je1LR * couple\_e1\_LR;}
\DoxyCodeLine{2039     results.ULR -\/= parameters.JeeLR * couple\_ee\_LR;}
\DoxyCodeLine{2040     results.ULR -\/= parameters.bLR * biquad\_LR;}
\DoxyCodeLine{2041     results.ULR -\/= parameters.DLR * dmi\_LR;}
\DoxyCodeLine{2042      }
\DoxyCodeLine{2043     results.U = results.UL + results.UR + results.Um + results.UmL + results.UmR + results.ULR;}
\DoxyCodeLine{2044 \}}
\DoxyCodeLine{2045 }
\DoxyCodeLine{2046 \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{MSD::Results}} \mbox{\hyperlink{classudc_1_1_m_s_d_ae1bee2a207b40720156243ed19eed671}{MSD::getResults}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2047     \textcolor{keywordflow}{return} results;}
\DoxyCodeLine{2048 \}}
\DoxyCodeLine{2049 }
\DoxyCodeLine{2050 }
\DoxyCodeLine{2051 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a5c1d308f90d10072e5288685ba4d58db}{MSD::set\_kT}}(\textcolor{keywordtype}{double} kT) \{}
\DoxyCodeLine{2052     \textcolor{comment}{// kT doesn't effect energy (U)}}
\DoxyCodeLine{2053     parameters.kT = kT;}
\DoxyCodeLine{2054 \}}
\DoxyCodeLine{2055 }
\DoxyCodeLine{2056 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a18aa13537e0deda7d1263c1fd8d8228a}{MSD::setB}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&B) \{}
\DoxyCodeLine{2057     \textcolor{comment}{// optimized energy recalculation when only changing magnetic field}}
\DoxyCodeLine{2058     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} deltaB = B -\/ parameters.B;}
\DoxyCodeLine{2059     }
\DoxyCodeLine{2060     results.UL -\/= deltaB * results.ML;}
\DoxyCodeLine{2061     results.UR -\/= deltaB * results.MR;}
\DoxyCodeLine{2062     results.Um -\/= deltaB * results.Mm;}
\DoxyCodeLine{2063     results.U = results.UL + results.UR + results.Um + results.UmL + results.UmR + results.ULR;}
\DoxyCodeLine{2064     }
\DoxyCodeLine{2065     parameters.B = B;}
\DoxyCodeLine{2066 \}}
\DoxyCodeLine{2067 }
\DoxyCodeLine{2068 }
\DoxyCodeLine{2069 \mbox{\hyperlink{classudc_1_1_molecule}{MSD::MolProto}} \mbox{\hyperlink{classudc_1_1_m_s_d_a77dce5d8c1a874c47acfbc69d5a867ab}{MSD::getMolProto}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2070     \textcolor{keywordflow}{return} molProto;}
\DoxyCodeLine{2071 \}}
\DoxyCodeLine{2072 }
\DoxyCodeLine{2073 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_aa8ed0dab0705b810e4d14215b488fb43}{MSD::setMolProto}}(\textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_molecule}{MolProto}} \&molProto) \{}
\DoxyCodeLine{2074     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}} = this-\/>molProto.\mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}}();}
\DoxyCodeLine{2075     \textcolor{keywordflow}{if} (molProto.\mbox{\hyperlink{classudc_1_1_molecule_abedb9f1c61ee095af402a365207eacef}{nodeCount}}() != \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}})}
\DoxyCodeLine{2076         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_molecule_exception}{MSD::MoleculeException}}(\textcolor{stringliteral}{"{}Can not change the number of nodes in the molecule after MSD creation. Must create a new MSD."{}});}
\DoxyCodeLine{2077 }
\DoxyCodeLine{2078     \textcolor{comment}{// -\/-\/-\/-\/-\/ remove energy caused by previous mol. and leads from aggregate: U -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2079     results.U -\/= results.Um + results.UmL + results.UmR;}
\DoxyCodeLine{2080 }
\DoxyCodeLine{2081     \textcolor{comment}{// -\/-\/-\/-\/-\/ reset some Results -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2082     results.MSm = results.MFm = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{2083     results.Um = results.UmL = results.UmR = 0;}
\DoxyCodeLine{2084 }
\DoxyCodeLine{2085     \textcolor{comment}{// NodeParameters: Sm, Fm, Je0m, Am}}
\DoxyCodeLine{2086     \textcolor{comment}{// -\/-\/-\/-\/-\/ Update spin and flux Vectors (Sm, Fm), and Calculate local Energy and Magnetization (B, Je0m, Am) -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2087     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a : unique\_mol\_indices) \{}
\DoxyCodeLine{2088         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = this-\/>y(a);}
\DoxyCodeLine{2089         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = this-\/>z(a);}
\DoxyCodeLine{2090 }
\DoxyCodeLine{2091         \textcolor{comment}{// Note: because Mol::prototype is a reference (acting like a pointer), it must refer to the global field: this-\/>molProto}}
\DoxyCodeLine{2092         \textcolor{comment}{// This field will be updated to the new molProto before this function returns}}
\DoxyCodeLine{2093         shared\_ptr<Mol> oldMol = mols[a];}
\DoxyCodeLine{2094         shared\_ptr<Mol> mol = shared\_ptr<Mol>(\textcolor{keyword}{new} \mbox{\hyperlink{classudc_1_1_m_s_d_ab3c0b3e8474e18cb213f79d66f221b67}{Mol}}(this-\/>molProto, *\textcolor{keyword}{this}, y, z, initSpin, initFlux));}
\DoxyCodeLine{2095         }
\DoxyCodeLine{2096         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} n = 0; n < \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}; n++) \{}
\DoxyCodeLine{2097             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&s = mol-\/>spins[n];}
\DoxyCodeLine{2098             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&f = mol-\/>fluxes[n];}
\DoxyCodeLine{2099 }
\DoxyCodeLine{2100             \textcolor{keyword}{const} \textcolor{keyword}{auto} \&parameters = molProto.nodes[n].parameters;}
\DoxyCodeLine{2101 }
\DoxyCodeLine{2102             \textcolor{comment}{// scale spin Vector}}
\DoxyCodeLine{2103             s = oldMol-\/>spins[n].\mbox{\hyperlink{classudc_1_1_vector_ac385aa5781a8b72847e6b28dcaa5e917}{normalize}}() * parameters.Sm;}
\DoxyCodeLine{2104             }
\DoxyCodeLine{2105             \textcolor{comment}{// scale flux Vector}}
\DoxyCodeLine{2106             \{   \textcolor{keywordtype}{double} oldFm = this-\/>molProto.nodes[n].parameters.Fm;}
\DoxyCodeLine{2107                 f = oldFm != 0 ? oldMol-\/>fluxes[n] * (parameters.Fm / oldFm) : \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{2108             \}}
\DoxyCodeLine{2109 }
\DoxyCodeLine{2110             \textcolor{comment}{// store new Mol (Molecule::Instance) over old one. old pointer should be destructed!}}
\DoxyCodeLine{2111             mols[index(molPosL + n, y, z)] = mol;}
\DoxyCodeLine{2112 }
\DoxyCodeLine{2113             \textcolor{comment}{// calculate "{}Results"{}}}
\DoxyCodeLine{2114             results.MSm += s;}
\DoxyCodeLine{2115             results.MFm += f;}
\DoxyCodeLine{2116 }
\DoxyCodeLine{2117             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m = s + f;}
\DoxyCodeLine{2118             results.Um -\/= this-\/>parameters.B * m;}
\DoxyCodeLine{2119             results.Um -\/= parameters.Am * \mbox{\hyperlink{classudc_1_1_vector}{Vector}}(\mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}}));}
\DoxyCodeLine{2120             results.Um -\/= parameters.Je0m * (s * f);}
\DoxyCodeLine{2121         \}}
\DoxyCodeLine{2122 }
\DoxyCodeLine{2123         \textcolor{comment}{// delete oldMol;  // not needed because of shared\_ptr}}
\DoxyCodeLine{2124     \}}
\DoxyCodeLine{2125 }
\DoxyCodeLine{2126     \textcolor{comment}{// EdgeParameters: Jm, Je1m, Jeem, bm, Dm}}
\DoxyCodeLine{2127     \textcolor{comment}{// -\/-\/-\/-\/-\/ Calculate bond energy (Jm, Je1m, Jeem, bm, Dm) -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2128     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a : unique\_mol\_indices) \{}
\DoxyCodeLine{2129         \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_m_s_d_ab3c0b3e8474e18cb213f79d66f221b67}{Mol}} \&mol = *mols[a];}
\DoxyCodeLine{2130 }
\DoxyCodeLine{2131         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} n = 0; n < \mbox{\hyperlink{_m_s_d-export_8cpp_a16c69478280e0f9d6898c700f3b51574}{nodeCount}}; n++) \{  \textcolor{comment}{// for each node}}
\DoxyCodeLine{2132             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s\_i = mol.spins[n];}
\DoxyCodeLine{2133             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f\_i = mol.fluxes[n];}
\DoxyCodeLine{2134             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m\_i = s\_i + f\_i;}
\DoxyCodeLine{2135 }
\DoxyCodeLine{2136             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&edge : molProto.nodes[n].neighbors) \{  \textcolor{comment}{// for each edge of node}}
\DoxyCodeLine{2137                 \textcolor{comment}{// skip if(selfIndex > nodeIndex) to avoid duplicating calculations}}
\DoxyCodeLine{2138                 \textcolor{comment}{// since each edge exists twice: once in each direction.}}
\DoxyCodeLine{2139                 \textcolor{comment}{// Also, ignore "{}loops"{} (edges which connect to themselves).}}
\DoxyCodeLine{2140                 \textcolor{keywordflow}{if} (edge.selfIndex >= edge.nodeIndex)}
\DoxyCodeLine{2141                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{2142                 }
\DoxyCodeLine{2143                 \textcolor{keyword}{auto} parameters = molProto.edgeParameters[edge.edgeIndex];}
\DoxyCodeLine{2144 }
\DoxyCodeLine{2145                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s\_j = mol.spins[edge.nodeIndex];}
\DoxyCodeLine{2146                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f\_j = mol.fluxes[edge.nodeIndex];}
\DoxyCodeLine{2147                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m\_j = s\_j + f\_j;}
\DoxyCodeLine{2148 }
\DoxyCodeLine{2149                 \textcolor{comment}{// calculate "{}Results"{}}}
\DoxyCodeLine{2150                 results.Um -\/= parameters.Jm * (s\_i * s\_j);}
\DoxyCodeLine{2151                 results.Um -\/= parameters.Je1m * (s\_i * f\_j + f\_i * s\_j);}
\DoxyCodeLine{2152                 results.Um -\/= parameters.Jeem * (f\_i * f\_j);}
\DoxyCodeLine{2153                 results.Um -\/= parameters.bm * \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m\_i * m\_j);}
\DoxyCodeLine{2154                 results.Um -\/= parameters.Dm * (edge.direction * m\_i.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(m\_j));}
\DoxyCodeLine{2155             \}}
\DoxyCodeLine{2156         \}}
\DoxyCodeLine{2157     \}}
\DoxyCodeLine{2158 }
\DoxyCodeLine{2159     \textcolor{comment}{// -\/-\/-\/-\/-\/ Calculate energy at leads (*mL, *mR) -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2160     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a : unique\_mol\_indices) \{}
\DoxyCodeLine{2161         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = this-\/>y(a);}
\DoxyCodeLine{2162         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = this-\/>z(a);}
\DoxyCodeLine{2163 }
\DoxyCodeLine{2164         \textcolor{keywordflow}{if} (FM\_L\_exists) \{}
\DoxyCodeLine{2165             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} FML\_idx = index(molPosL -\/ 1, y, z);}
\DoxyCodeLine{2166             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} mol\_idx = index(molPosL + molProto.leftLead, y, z);}
\DoxyCodeLine{2167             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s\_i = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(FML\_idx);}
\DoxyCodeLine{2168             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f\_i = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(FML\_idx);}
\DoxyCodeLine{2169             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m\_i = s\_i + f\_i;}
\DoxyCodeLine{2170             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s\_j = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(mol\_idx);}
\DoxyCodeLine{2171             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f\_j = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(mol\_idx);}
\DoxyCodeLine{2172             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m\_j = s\_j + f\_j;}
\DoxyCodeLine{2173 }
\DoxyCodeLine{2174             results.UmL -\/= parameters.JmL * (s\_i * s\_j);}
\DoxyCodeLine{2175             results.UmL -\/= parameters.Je1mL * (s\_i * f\_j + f\_i * s\_j);}
\DoxyCodeLine{2176             results.UmL -\/= parameters.JeemL * (f\_i * f\_j);}
\DoxyCodeLine{2177             results.UmL -\/= parameters.bmL * \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m\_i * m\_j);}
\DoxyCodeLine{2178             results.UmL -\/= parameters.DmL * m\_i.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(m\_j);}
\DoxyCodeLine{2179         \}}
\DoxyCodeLine{2180 }
\DoxyCodeLine{2181         \textcolor{keywordflow}{if} (FM\_R\_exists) \{}
\DoxyCodeLine{2182             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} FMR\_idx = index(molPosR + 1, y, z);}
\DoxyCodeLine{2183             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} mol\_idx = index(molPosL + molProto.rightLead, y, z);}
\DoxyCodeLine{2184             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s\_i = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(mol\_idx);}
\DoxyCodeLine{2185             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f\_i = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(mol\_idx);}
\DoxyCodeLine{2186             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m\_i = s\_i + f\_i;}
\DoxyCodeLine{2187             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s\_j = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(FMR\_idx);}
\DoxyCodeLine{2188             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f\_j = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(FMR\_idx);}
\DoxyCodeLine{2189             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m\_j = s\_j + f\_j;}
\DoxyCodeLine{2190 }
\DoxyCodeLine{2191             results.UmR -\/= parameters.JmR * (s\_i * s\_j);}
\DoxyCodeLine{2192             results.UmR -\/= parameters.Je1mR * (s\_i * f\_j + f\_i * s\_j);}
\DoxyCodeLine{2193             results.UmR -\/= parameters.JeemR * (f\_i * f\_j);}
\DoxyCodeLine{2194             results.UmR -\/= parameters.bmR * \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m\_i * m\_j);}
\DoxyCodeLine{2195             results.UmR -\/= parameters.DmR * m\_i.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(m\_j);}
\DoxyCodeLine{2196         \}}
\DoxyCodeLine{2197     \}}
\DoxyCodeLine{2198 }
\DoxyCodeLine{2199     \textcolor{comment}{// -\/-\/-\/-\/-\/ update aggregate energy (U) and magnetizations (Mm, MS, MF, M) -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2200     results.Mm = results.MSm + results.MFm;}
\DoxyCodeLine{2201     results.MS = results.MSL + results.MSR + results.MSm;}
\DoxyCodeLine{2202     results.MF = results.MFL + results.MFR + results.MFm;}
\DoxyCodeLine{2203     results.M = results.MS + results.MF;}
\DoxyCodeLine{2204     results.U += results.Um + results.UmR + results.UmL;}
\DoxyCodeLine{2205     }
\DoxyCodeLine{2206     \textcolor{comment}{// Done: copy new mol. prototype to MSD::molProto field}}
\DoxyCodeLine{2207     this-\/>molProto = molProto;}
\DoxyCodeLine{2208 \}}
\DoxyCodeLine{2209 }
\DoxyCodeLine{2210 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_aade85204d30f826444572e41f27613aa}{MSD::setMolParameters}}(\textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters}{MolProto::NodeParameters}} \&nodeParams, \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_molecule_1_1_edge_parameters}{MolProto::EdgeParameters}} \&edgeParams) \{}
\DoxyCodeLine{2211     \mbox{\hyperlink{classudc_1_1_molecule}{MolProto}} molProto = this-\/>molProto;}
\DoxyCodeLine{2212     molProto.\mbox{\hyperlink{classudc_1_1_molecule_a401ed0509649570cc636b5a08735cbd6}{setAllParameters}}(nodeParams, edgeParams);}
\DoxyCodeLine{2213     \mbox{\hyperlink{classudc_1_1_m_s_d_aa8ed0dab0705b810e4d14215b488fb43}{setMolProto}}(molProto);  \textcolor{comment}{// update Results (i.e. energy and magnetization)}}
\DoxyCodeLine{2214 \}}
\DoxyCodeLine{2215 }
\DoxyCodeLine{2216 }
\DoxyCodeLine{2217 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{MSD::getSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2218     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = this-\/>x(a);}
\DoxyCodeLine{2219     \textcolor{keywordflow}{return} (x < molPosL || x > molPosR) ? spins.at(a) : mols.\mbox{\hyperlink{classudc_1_1_sparse_array_a9a89430f9cb6b03bfaf249a0ebcbfc8c}{at}}(a)-\/>spins[x -\/ molPosL];}
\DoxyCodeLine{2220 \}}
\DoxyCodeLine{2221 }
\DoxyCodeLine{2222 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{MSD::getSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2223     \textcolor{keywordflow}{if}( x >= width || y >= height || z >= depth )}
\DoxyCodeLine{2224         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}(x,y,z) coordinate not in range"{}});}
\DoxyCodeLine{2225     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}( index(x, y, z) );}
\DoxyCodeLine{2226 \}}
\DoxyCodeLine{2227 }
\DoxyCodeLine{2228 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{MSD::getFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2229     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = this-\/>x(a);}
\DoxyCodeLine{2230     \textcolor{keywordflow}{return} (x < molPosL || x > molPosR) ? fluxes.at(a) : mols.\mbox{\hyperlink{classudc_1_1_sparse_array_a9a89430f9cb6b03bfaf249a0ebcbfc8c}{at}}(a)-\/>fluxes[x -\/ molPosL];}
\DoxyCodeLine{2231 \}}
\DoxyCodeLine{2232 }
\DoxyCodeLine{2233 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{MSD::getFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2234     \textcolor{keywordflow}{if}( x >= width || y >= height || z >= depth )}
\DoxyCodeLine{2235         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}(x,y,z) coordinate not in range"{}});}
\DoxyCodeLine{2236     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}( index(x, y, z) );}
\DoxyCodeLine{2237 \}}
\DoxyCodeLine{2238 }
\DoxyCodeLine{2239 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_af0cad12dfc8de11dfbbb600672b94a53}{MSD::getLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2240     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a) + \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a);}
\DoxyCodeLine{2241 \}}
\DoxyCodeLine{2242 }
\DoxyCodeLine{2243 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_af0cad12dfc8de11dfbbb600672b94a53}{MSD::getLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2244     \textcolor{keywordflow}{if}( x >= width || y >= height || z >= depth )}
\DoxyCodeLine{2245         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}(x,y,z) coordinate not in range"{}});}
\DoxyCodeLine{2246     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_af0cad12dfc8de11dfbbb600672b94a53}{getLocalM}}( index(x, y, z) );}
\DoxyCodeLine{2247 \}}
\DoxyCodeLine{2248 }
\DoxyCodeLine{2249 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a4d4a91fd46eec66e753dfa2642c25068}{MSD::setSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin) \{}
\DoxyCodeLine{2250     \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{setLocalM}}( a, spin, \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a) );}
\DoxyCodeLine{2251 \}}
\DoxyCodeLine{2252 }
\DoxyCodeLine{2253 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a4d4a91fd46eec66e753dfa2642c25068}{MSD::setSpin}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin) \{}
\DoxyCodeLine{2254     \textcolor{keywordflow}{if}( x >= width || y >= height || z >= depth )}
\DoxyCodeLine{2255         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}(x,y,z) coordinate not in range"{}});}
\DoxyCodeLine{2256     \mbox{\hyperlink{classudc_1_1_m_s_d_a4d4a91fd46eec66e753dfa2642c25068}{setSpin}}( index(x, y, z), spin );}
\DoxyCodeLine{2257 \}}
\DoxyCodeLine{2258 }
\DoxyCodeLine{2259 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a0bb8c1e9fef1960578abc46446380dbf}{MSD::setFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux) \{}
\DoxyCodeLine{2260     \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{setLocalM}}( a, \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a), flux );}
\DoxyCodeLine{2261 \}}
\DoxyCodeLine{2262 }
\DoxyCodeLine{2263 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a0bb8c1e9fef1960578abc46446380dbf}{MSD::setFlux}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux) \{}
\DoxyCodeLine{2264     \textcolor{keywordflow}{if}( x >= width || y >= height || z >= depth )}
\DoxyCodeLine{2265         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}(x,y,z) coordinate not in range"{}});}
\DoxyCodeLine{2266     \mbox{\hyperlink{classudc_1_1_m_s_d_a0bb8c1e9fef1960578abc46446380dbf}{setFlux}}( index(x, y, z), flux );}
\DoxyCodeLine{2267 \}}
\DoxyCodeLine{2268 }
\DoxyCodeLine{2269 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{MSD::setLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux) \{}
\DoxyCodeLine{2270     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{2271     }
\DoxyCodeLine{2272     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = this-\/>x(a);}
\DoxyCodeLine{2273     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y = this-\/>y(a);}
\DoxyCodeLine{2274     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z = this-\/>z(a);}
\DoxyCodeLine{2275 }
\DoxyCodeLine{2276     \textcolor{comment}{// if position "{}a"{} is within the mol., bybass this function and call Mol::setLocalM instead. }}
\DoxyCodeLine{2277     \textcolor{keywordflow}{if} (molPosL <= x \&\& x <= molPosR) \{}
\DoxyCodeLine{2278         mols.\mbox{\hyperlink{classudc_1_1_sparse_array_a9a89430f9cb6b03bfaf249a0ebcbfc8c}{at}}(a)-\/>setLocalM(x -\/ molPosL, spin, flux);}
\DoxyCodeLine{2279         \textcolor{keywordflow}{return};}
\DoxyCodeLine{2280     \}}
\DoxyCodeLine{2281     \textcolor{comment}{// else, we are definately in one of the FMs}}
\DoxyCodeLine{2282 }
\DoxyCodeLine{2283     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&s = spins.at(a); \textcolor{comment}{//previous spin}}
\DoxyCodeLine{2284     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&f = fluxes.at(a); \textcolor{comment}{//previous spin fluctuation}}
\DoxyCodeLine{2285     }
\DoxyCodeLine{2286     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} m = s + f; \textcolor{comment}{// previous local magnetization}}
\DoxyCodeLine{2287     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} mag = spin + flux; \textcolor{comment}{// new local magnetization}}
\DoxyCodeLine{2288     }
\DoxyCodeLine{2289     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} deltaS = spin -\/ s;}
\DoxyCodeLine{2290     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} deltaF = flux -\/ f;}
\DoxyCodeLine{2291     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} deltaM = mag -\/ m;}
\DoxyCodeLine{2292     results.M += deltaM;}
\DoxyCodeLine{2293     results.MS += deltaS;}
\DoxyCodeLine{2294     results.MF += deltaF;}
\DoxyCodeLine{2295     }
\DoxyCodeLine{2296     \textcolor{comment}{// delta U's are actually negative, simply grouping the negatives in front of each energy coefficient into deltaU -\/= ... (instead of +=)}}
\DoxyCodeLine{2297     \textcolor{keywordtype}{double} deltaU\_B = parameters.B * deltaM;}
\DoxyCodeLine{2298     results.U -\/= deltaU\_B;}
\DoxyCodeLine{2299     }
\DoxyCodeLine{2300     \textcolor{comment}{// -\/-\/-\/-\/-\/ left section (FM\_L) -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2301     \textcolor{keywordflow}{if}( x < molPosL ) \{}
\DoxyCodeLine{2302     }
\DoxyCodeLine{2303         results.ML += deltaM;}
\DoxyCodeLine{2304         results.MSL += deltaS;}
\DoxyCodeLine{2305         results.MFL += deltaF;}
\DoxyCodeLine{2306         results.UL -\/= deltaU\_B;}
\DoxyCodeLine{2307         }
\DoxyCodeLine{2308         \{   \textcolor{keywordtype}{double} deltaU = parameters.AL * ( \mbox{\hyperlink{classudc_1_1_vector}{Vector}}(\mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}})) -\/ \mbox{\hyperlink{classudc_1_1_vector}{Vector}}(\mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}})) )}
\DoxyCodeLine{2309                           + parameters.Je0L * ( spin * flux -\/ s * f );}
\DoxyCodeLine{2310             results.U -\/= deltaU;}
\DoxyCodeLine{2311             results.UL -\/= deltaU;}
\DoxyCodeLine{2312         \}}
\DoxyCodeLine{2313         }
\DoxyCodeLine{2314         \textcolor{comment}{// [5 neighbors stay only within FM\_L: left, above, below, front, back]}}
\DoxyCodeLine{2315         \textcolor{keywordflow}{if}( x != 0 ) \{}
\DoxyCodeLine{2316             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x -\/ 1, y, z);  \textcolor{comment}{// left neighbor}}
\DoxyCodeLine{2317             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2318             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2319             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2320             \textcolor{keywordtype}{double} deltaU = parameters.JL * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2321                           + parameters.Je1L * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2322                           + parameters.JeeL * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2323                           + parameters.bL * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2324                           + parameters.DL * neighbor\_m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(deltaM);  \textcolor{comment}{// (a1 < a): right vector changed}}
\DoxyCodeLine{2325             results.U -\/= deltaU;}
\DoxyCodeLine{2326             results.UL -\/= deltaU;}
\DoxyCodeLine{2327         \} \textcolor{comment}{// else, x -\/ 1 neighbor doesn't exist}}
\DoxyCodeLine{2328         \textcolor{keywordflow}{if}( y != topL ) \{}
\DoxyCodeLine{2329             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x, y -\/ 1, z);  \textcolor{comment}{// above neighbor}}
\DoxyCodeLine{2330             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2331             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2332             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2333             \textcolor{keywordtype}{double} deltaU = parameters.JL * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2334                           + parameters.Je1L * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2335                           + parameters.JeeL * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2336                           + parameters.bL * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2337                           + parameters.DL * neighbor\_m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(deltaM);  \textcolor{comment}{// (a1 < a): right vector changed}}
\DoxyCodeLine{2338             results.U -\/= deltaU;}
\DoxyCodeLine{2339             results.UL -\/= deltaU;}
\DoxyCodeLine{2340         \} \textcolor{comment}{// else, y -\/ 1 neighbor doesn't exist}}
\DoxyCodeLine{2341         \textcolor{keywordflow}{if}( y != bottomL ) \{}
\DoxyCodeLine{2342             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x, y + 1, z);  \textcolor{comment}{// below neighbor}}
\DoxyCodeLine{2343             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2344             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2345             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2346             \textcolor{keywordtype}{double} deltaU = parameters.JL * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2347                           + parameters.Je1L * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2348                           + parameters.JeeL * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2349                           + parameters.bL * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2350                           + parameters.DL * deltaM.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(neighbor\_m);  \textcolor{comment}{// (a < a1): left vector changed}}
\DoxyCodeLine{2351             results.U -\/= deltaU;}
\DoxyCodeLine{2352             results.UL -\/= deltaU;}
\DoxyCodeLine{2353         \} \textcolor{comment}{// else, y + 1 neighbor doesn't exist}}
\DoxyCodeLine{2354         \textcolor{keywordflow}{if}( z != 0 ) \{}
\DoxyCodeLine{2355             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x, y, z -\/ 1);  \textcolor{comment}{// front neighbor}}
\DoxyCodeLine{2356             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2357             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2358             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2359             \textcolor{keywordtype}{double} deltaU = parameters.JL * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2360                           + parameters.Je1L * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2361                           + parameters.JeeL * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2362                           + parameters.bL * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2363                           + parameters.DL * neighbor\_m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(deltaM);  \textcolor{comment}{// (a1 < a): right vector changed}}
\DoxyCodeLine{2364             results.U -\/= deltaU;}
\DoxyCodeLine{2365             results.UL -\/= deltaU;}
\DoxyCodeLine{2366         \} \textcolor{comment}{// else, z -\/ 1 neighbor doesn't exist}}
\DoxyCodeLine{2367         \textcolor{keywordflow}{if}( z + 1 != depth ) \{}
\DoxyCodeLine{2368             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x, y, z + 1);  \textcolor{comment}{// back neighbor}}
\DoxyCodeLine{2369             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2370             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2371             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2372             \textcolor{keywordtype}{double} deltaU = parameters.JL * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2373                           + parameters.Je1L * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2374                           + parameters.JeeL * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2375                           + parameters.bL * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2376                           + parameters.DL * deltaM.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(neighbor\_m);  \textcolor{comment}{// (a < a1): left vector changed}}
\DoxyCodeLine{2377             results.U -\/= deltaU;}
\DoxyCodeLine{2378             results.UL -\/= deltaU;}
\DoxyCodeLine{2379         \} \textcolor{comment}{// else, z + 1 neighbor doesn't exist}}
\DoxyCodeLine{2380         }
\DoxyCodeLine{2381         \textcolor{comment}{// [2 neighbors may leave FM\_L: right, LR (direct coupling)]}}
\DoxyCodeLine{2382         \textcolor{keywordflow}{if}( x + 1 != width )  \textcolor{comment}{// do these neighbors exist?}}
\DoxyCodeLine{2383             \textcolor{keywordflow}{if}( x + 1 == molPosL ) \{  \textcolor{comment}{// are we next to the mol.?}}
\DoxyCodeLine{2384                 \textcolor{keywordflow}{if}( mol\_exists )}
\DoxyCodeLine{2385                     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{2386                         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(molPosL + molProto.leftLead, y, z);  \textcolor{comment}{// right neighbor (in mol.)}}
\DoxyCodeLine{2387                         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2388                         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2389                         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2390                         \textcolor{keywordtype}{double} deltaU = parameters.JmL * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2391                                       + parameters.Je1mL * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2392                                       + parameters.JeemL * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2393                                       + parameters.bmL * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2394                                       + parameters.DmL * deltaM.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(neighbor\_m);  \textcolor{comment}{// (a < a1): left vector changed}}
\DoxyCodeLine{2395                         results.U -\/= deltaU;}
\DoxyCodeLine{2396                         results.UmL -\/= deltaU;}
\DoxyCodeLine{2397                     \} \textcolor{keywordflow}{catch}(\textcolor{keyword}{const} out\_of\_range \&e) \{\} \textcolor{comment}{// x + 1 neighbor doesn't exist because it's in the buffer zone}}
\DoxyCodeLine{2398                 }
\DoxyCodeLine{2399                 \textcolor{keywordflow}{if}( FM\_R\_exists )}
\DoxyCodeLine{2400                     \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{2401                         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(molPosR + 1, y, z);  \textcolor{comment}{// LR (direct coupling) neighbor}}
\DoxyCodeLine{2402                         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2403                         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2404                         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2405                         \textcolor{keywordtype}{double} deltaU = parameters.JLR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2406                                       + parameters.Je1LR * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2407                                       + parameters.JeeLR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2408                                       + parameters.bLR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2409                                       + parameters.DLR * deltaM.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(neighbor\_m);  \textcolor{comment}{// (a < a1): left vector changed}}
\DoxyCodeLine{2410                         results.U -\/= deltaU;}
\DoxyCodeLine{2411                         results.ULR -\/= deltaU;}
\DoxyCodeLine{2412                     \} \textcolor{keywordflow}{catch}(\textcolor{keyword}{const} out\_of\_range \&e) \{\} \textcolor{comment}{// molPosR + 1 atom doesn't exist because we're not in the center}}
\DoxyCodeLine{2413                 }
\DoxyCodeLine{2414             \} \textcolor{keywordflow}{else} \{  \textcolor{comment}{// we are not next to the mol.}}
\DoxyCodeLine{2415                 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x + 1, y, z);  \textcolor{comment}{// right neighbor (also in FM\_L)}}
\DoxyCodeLine{2416                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2417                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2418                 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2419                 \textcolor{keywordtype}{double} deltaU = parameters.JL * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2420                               + parameters.Je1L * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2421                               + parameters.JeeL * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2422                               + parameters.bL * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2423                               + parameters.DL * deltaM.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(neighbor\_m);  \textcolor{comment}{// (a < a1): left vector changed}}
\DoxyCodeLine{2424                 results.U -\/= deltaU;}
\DoxyCodeLine{2425                 results.UL -\/= deltaU;}
\DoxyCodeLine{2426             \}}
\DoxyCodeLine{2427         \textcolor{comment}{// else, x + 1 neighbor doesn't exist (because molPosL == width)}}
\DoxyCodeLine{2428     }
\DoxyCodeLine{2429     \textcolor{comment}{// -\/-\/-\/-\/-\/ right section (FM\_R) -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2430     \} \textcolor{keywordflow}{else} \{  \textcolor{comment}{// x > molPosR}}
\DoxyCodeLine{2431     }
\DoxyCodeLine{2432         results.MR += deltaM;}
\DoxyCodeLine{2433         results.MSR += deltaS;}
\DoxyCodeLine{2434         results.MFR += deltaF;}
\DoxyCodeLine{2435         results.UR -\/= deltaU\_B;}
\DoxyCodeLine{2436         }
\DoxyCodeLine{2437         \{   \textcolor{keywordtype}{double} deltaU = parameters.AR * ( \mbox{\hyperlink{classudc_1_1_vector}{Vector}}(\mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(mag.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}})) -\/ \mbox{\hyperlink{classudc_1_1_vector}{Vector}}(\mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_ab974b6088fa419c17752cdf46fffd09c}{x}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_a136129725de33fe61592c3d5c5a485eb}{y}}), \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(m.\mbox{\hyperlink{classudc_1_1_vector_af5787922cda40c2139abdd31cd2f6251}{z}})) )}
\DoxyCodeLine{2438                           + parameters.Je0R * ( spin * flux -\/ s * f );}
\DoxyCodeLine{2439             results.U -\/= deltaU;}
\DoxyCodeLine{2440             results.UR -\/= deltaU;}
\DoxyCodeLine{2441         \}}
\DoxyCodeLine{2442         }
\DoxyCodeLine{2443         \textcolor{comment}{// [5 neighbors stay only within FM\_R: right, above, below, front, back]}}
\DoxyCodeLine{2444         \textcolor{keywordflow}{if}( x + 1 != width ) \{}
\DoxyCodeLine{2445             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x + 1, y, z);  \textcolor{comment}{// right neighbor}}
\DoxyCodeLine{2446             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2447             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2448             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2449             \textcolor{keywordtype}{double} deltaU = parameters.JR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2450                           + parameters.Je1R * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2451                           + parameters.JeeR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2452                           + parameters.bR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2453                           + parameters.DR * deltaM.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(neighbor\_m);  \textcolor{comment}{// (a < a1): left vector changed}}
\DoxyCodeLine{2454             results.U -\/= deltaU;}
\DoxyCodeLine{2455             results.UR -\/= deltaU;}
\DoxyCodeLine{2456         \} \textcolor{comment}{// else, x + 1 neighbor doesn't exist}}
\DoxyCodeLine{2457         \textcolor{keywordflow}{if}( y != 0 ) \{}
\DoxyCodeLine{2458             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x, y -\/ 1, z);  \textcolor{comment}{// above neighbor}}
\DoxyCodeLine{2459             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2460             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2461             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2462             \textcolor{keywordtype}{double} deltaU = parameters.JR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2463                           + parameters.Je1R * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2464                           + parameters.JeeR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2465                           + parameters.bR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2466                           + parameters.DR * neighbor\_m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(deltaM);  \textcolor{comment}{// (a1 < a): right vector changed}}
\DoxyCodeLine{2467             results.U -\/= deltaU;}
\DoxyCodeLine{2468             results.UR -\/= deltaU;}
\DoxyCodeLine{2469         \} \textcolor{comment}{// else, y -\/ 1 neighbor doesn't exist}}
\DoxyCodeLine{2470         \textcolor{keywordflow}{if}( y + 1 != height ) \{}
\DoxyCodeLine{2471             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x, y + 1, z);  \textcolor{comment}{// below neighbor}}
\DoxyCodeLine{2472             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2473             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2474             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2475             \textcolor{keywordtype}{double} deltaU = parameters.JR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2476                           + parameters.Je1R * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2477                           + parameters.JeeR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2478                           + parameters.bR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2479                           + parameters.DR * deltaM.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(neighbor\_m);  \textcolor{comment}{// (a < a1): left vector changed}}
\DoxyCodeLine{2480             results.U -\/= deltaU;}
\DoxyCodeLine{2481             results.UR -\/= deltaU;}
\DoxyCodeLine{2482         \} \textcolor{comment}{// else, y + 1 neighbor doesn't exist}}
\DoxyCodeLine{2483         \textcolor{keywordflow}{if}( z != frontR ) \{}
\DoxyCodeLine{2484             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x, y, z -\/ 1);  \textcolor{comment}{// front neighbor}}
\DoxyCodeLine{2485             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2486             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2487             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2488             \textcolor{keywordtype}{double} deltaU = parameters.JR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2489                           + parameters.Je1R * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2490                           + parameters.JeeR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2491                           + parameters.bR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2492                           + parameters.DR * neighbor\_m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(deltaM);  \textcolor{comment}{// (a1 < a): right vector changed}}
\DoxyCodeLine{2493             results.U -\/= deltaU;}
\DoxyCodeLine{2494             results.UR -\/= deltaU;}
\DoxyCodeLine{2495         \} \textcolor{comment}{// else, z -\/ 1 neighbor doesn't exist}}
\DoxyCodeLine{2496         \textcolor{keywordflow}{if}( z != backR ) \{}
\DoxyCodeLine{2497             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x, y, z + 1);  \textcolor{comment}{// back neighbor}}
\DoxyCodeLine{2498             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2499             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2500             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2501             \textcolor{keywordtype}{double} deltaU = parameters.JR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2502                           + parameters.Je1R * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2503                           + parameters.JeeR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2504                           + parameters.bR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2505                           + parameters.DR * deltaM.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(neighbor\_m);  \textcolor{comment}{// (a < a1): left vector changed}}
\DoxyCodeLine{2506             results.U -\/= deltaU;}
\DoxyCodeLine{2507             results.UR -\/= deltaU;}
\DoxyCodeLine{2508         \} \textcolor{comment}{// else, z + 1 neighbor doesn't exist}}
\DoxyCodeLine{2509         }
\DoxyCodeLine{2510         \textcolor{comment}{// [2 neighbors may leave FM\_L: left, LR (direct coupling)]}}
\DoxyCodeLine{2511         \textcolor{comment}{// x != 0, because x > (unsigned molPosR) >= 0}}
\DoxyCodeLine{2512         \textcolor{keywordflow}{if}( x -\/ 1 == molPosR ) \{  \textcolor{comment}{// are we next to the mol.?}}
\DoxyCodeLine{2513             \textcolor{keywordflow}{if}( mol\_exists )}
\DoxyCodeLine{2514                 \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{2515                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(molPosL + molProto.rightLead, y, z);  \textcolor{comment}{// left neighbor (in mol.)}}
\DoxyCodeLine{2516                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2517                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2518                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2519                     \textcolor{keywordtype}{double} deltaU = parameters.JmR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2520                                   + parameters.Je1mR * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2521                                   + parameters.JeemR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2522                                   + parameters.bmR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2523                                   + parameters.DmR * neighbor\_m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(deltaM);  \textcolor{comment}{// (a1 < a): right vector changed}}
\DoxyCodeLine{2524                     results.U -\/= deltaU;}
\DoxyCodeLine{2525                     results.UmR -\/= deltaU;}
\DoxyCodeLine{2526                 \} \textcolor{keywordflow}{catch}(\textcolor{keyword}{const} out\_of\_range \&e) \{\} \textcolor{comment}{// x -\/ 1 neighbor doesn't exist because it's in the buffer zone}}
\DoxyCodeLine{2527             }
\DoxyCodeLine{2528             \textcolor{keywordflow}{if}( FM\_L\_exists )}
\DoxyCodeLine{2529                 \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{2530                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(molPosL -\/ 1, y, z);  \textcolor{comment}{// LR (direct coupling) neighbor}}
\DoxyCodeLine{2531                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2532                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2533                     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2534                     \textcolor{keywordtype}{double} deltaU = parameters.JLR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2535                                   + parameters.Je1LR * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2536                                   + parameters.JeeLR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2537                                   + parameters.bLR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2538                                   + parameters.DLR * neighbor\_m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(deltaM);  \textcolor{comment}{// (a1 < a): right vector changed}}
\DoxyCodeLine{2539                     results.U -\/= deltaU;}
\DoxyCodeLine{2540                     results.ULR -\/= deltaU;}
\DoxyCodeLine{2541                 \} \textcolor{keywordflow}{catch}(\textcolor{keyword}{const} out\_of\_range \&e) \{\} \textcolor{comment}{// molPos -\/ 1 atom doesn't exist because we're not in the center}}
\DoxyCodeLine{2542 }
\DoxyCodeLine{2543         \} \textcolor{keywordflow}{else} \{  \textcolor{comment}{// we are not next to the mol.}}
\DoxyCodeLine{2544             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a1 = index(x -\/ 1, y, z);  \textcolor{comment}{// left neighbor (also in FM\_R)}}
\DoxyCodeLine{2545             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a1);}
\DoxyCodeLine{2546             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a1);}
\DoxyCodeLine{2547             \mbox{\hyperlink{classudc_1_1_vector}{Vector}} neighbor\_m = neighbor\_s + neighbor\_f;}
\DoxyCodeLine{2548             \textcolor{keywordtype}{double} deltaU = parameters.JR * ( neighbor\_s * deltaS )}
\DoxyCodeLine{2549                           + parameters.Je1R * ( neighbor\_f * deltaS + neighbor\_s * deltaF )}
\DoxyCodeLine{2550                           + parameters.JeeR * ( neighbor\_f * deltaF )}
\DoxyCodeLine{2551                           + parameters.bR * ( \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * mag) -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(neighbor\_m * m) )}
\DoxyCodeLine{2552                           + parameters.DR * neighbor\_m.\mbox{\hyperlink{classudc_1_1_vector_a5e5018a08cc0c3988f7a47243943e530}{crossProduct}}(deltaM);  \textcolor{comment}{// (a1 < a): right vector changed}}
\DoxyCodeLine{2553             results.U -\/= deltaU;}
\DoxyCodeLine{2554             results.UR -\/= deltaU;}
\DoxyCodeLine{2555         \}}
\DoxyCodeLine{2556     }
\DoxyCodeLine{2557     \}}
\DoxyCodeLine{2558     }
\DoxyCodeLine{2559     \textcolor{comment}{// -\/-\/-\/-\/-\/ update vectors -\/-\/-\/-\/-\/}}
\DoxyCodeLine{2560     s = spin;}
\DoxyCodeLine{2561     f = flux;}
\DoxyCodeLine{2562 }
\DoxyCodeLine{2563     \} \textcolor{keywordflow}{catch}(\textcolor{keyword}{const} out\_of\_range \&ex) \{}
\DoxyCodeLine{2564         \textcolor{comment}{// For debugging. This exception should not happen in production!}}
\DoxyCodeLine{2565         std::cerr << \textcolor{stringliteral}{"{}ERROR in MSD::setLocalM(unsigned int, udc::Vector, udc::Vector)\(\backslash\)n"{}};}
\DoxyCodeLine{2566         std::cerr << a << \textcolor{stringliteral}{"{} == ("{}} << x(a) << \textcolor{stringliteral}{"{}, "{}} << y(a) << \textcolor{stringliteral}{"{}, "{}} << z(a) << \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{2567         std::cerr << ex.what() << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{2568         std::cerr << \textcolor{stringliteral}{"{}topL="{}} << topL << \textcolor{stringliteral}{"{}, bottomL="{}} << bottomL << \textcolor{stringliteral}{"{}, frontR="{}} << frontR << \textcolor{stringliteral}{"{}, backR="{}} << backR << \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{2569         std::cerr << \textcolor{stringliteral}{"{}Valid Indicies:\(\backslash\)n"{}};}
\DoxyCodeLine{2570         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} iter = indices.begin(); iter != indices.end(); ++iter)}
\DoxyCodeLine{2571             std::cerr << *iter << \textcolor{stringliteral}{"{} == ("{}} << x(*iter) << \textcolor{stringliteral}{"{}, "{}} << y(*iter) << \textcolor{stringliteral}{"{}, "{}} << z(*iter) << \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{2572         exit(200);}
\DoxyCodeLine{2573     \}}
\DoxyCodeLine{2574 \}}
\DoxyCodeLine{2575 }
\DoxyCodeLine{2576 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{MSD::setLocalM}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} z, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&spin, \textcolor{keyword}{const} \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \&flux) \{}
\DoxyCodeLine{2577     \textcolor{keywordflow}{if}( x >= width || y >= height || z >= depth )}
\DoxyCodeLine{2578         \textcolor{keywordflow}{throw} out\_of\_range(\textcolor{stringliteral}{"{}(x,y,z) coordinate not in range"{}});}
\DoxyCodeLine{2579     \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{setLocalM}}( index(x, y, z), spin, flux );}
\DoxyCodeLine{2580 \}}
\DoxyCodeLine{2581 }
\DoxyCodeLine{2582 }
\DoxyCodeLine{2583 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a762738c5f2b8e17f526c6138fcf89872}{MSD::getN}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2584     \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{2585 \}}
\DoxyCodeLine{2586 }
\DoxyCodeLine{2587 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_adc9f743ee13e82becfe0a2c50ee52ec1}{MSD::getNL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2588     \textcolor{keywordflow}{return} nL;}
\DoxyCodeLine{2589 \}}
\DoxyCodeLine{2590 }
\DoxyCodeLine{2591 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_ae18b1502712c3ac5314dbb6130c354ed}{MSD::getNR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2592     \textcolor{keywordflow}{return} nR;}
\DoxyCodeLine{2593 \}}
\DoxyCodeLine{2594 }
\DoxyCodeLine{2595 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a100e8176f61523c520c546149d9014a6}{MSD::getNm}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2596     \textcolor{keywordflow}{return} n\_m;}
\DoxyCodeLine{2597 \}}
\DoxyCodeLine{2598 }
\DoxyCodeLine{2599 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a3a90533d4764c960d421ccf254696133}{MSD::getNmL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2600     \textcolor{keywordflow}{return} n\_mL;}
\DoxyCodeLine{2601 \}}
\DoxyCodeLine{2602 }
\DoxyCodeLine{2603 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_ad5c8743bd63fd3cdbb0361233e405c0b}{MSD::getNmR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2604     \textcolor{keywordflow}{return} n\_mR;}
\DoxyCodeLine{2605 \}}
\DoxyCodeLine{2606 }
\DoxyCodeLine{2607 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a7add4bc60686c62e73343afa6092b017}{MSD::getNLR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2608     \textcolor{keywordflow}{return} nLR;}
\DoxyCodeLine{2609 \}}
\DoxyCodeLine{2610 }
\DoxyCodeLine{2611 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a3ece5c5f34abcc06fef11fc96189895d}{MSD::getWidth}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2612     \textcolor{keywordflow}{return} width;}
\DoxyCodeLine{2613 \}}
\DoxyCodeLine{2614 }
\DoxyCodeLine{2615 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a536ab447508f890fd16272995c6fae8b}{MSD::getHeight}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2616     \textcolor{keywordflow}{return} height;}
\DoxyCodeLine{2617 \}}
\DoxyCodeLine{2618 }
\DoxyCodeLine{2619 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_aefb9f78944562ded126ec46485319557}{MSD::getDepth}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2620     \textcolor{keywordflow}{return} depth;}
\DoxyCodeLine{2621 \}}
\DoxyCodeLine{2622 }
\DoxyCodeLine{2623 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a939846baeed48015266b707a703ef15f}{MSD::getDimensions}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&width, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&height, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&depth)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2624     width = this-\/>width;}
\DoxyCodeLine{2625     height = this-\/>height;}
\DoxyCodeLine{2626     depth = this-\/>depth;}
\DoxyCodeLine{2627 \}}
\DoxyCodeLine{2628 }
\DoxyCodeLine{2629 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a2c5e7ed01ae1e5e5e6157e76748f88ab}{MSD::getMolPosL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2630     \textcolor{keywordflow}{return} molPosL;}
\DoxyCodeLine{2631 \}}
\DoxyCodeLine{2632 }
\DoxyCodeLine{2633 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a158fcf1df8fc10e66257138df6e4a60e}{MSD::getMolPosR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2634     \textcolor{keywordflow}{return} molPosR;}
\DoxyCodeLine{2635 \}}
\DoxyCodeLine{2636 }
\DoxyCodeLine{2637 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a52a344961c0464197bc0936e24ec1107}{MSD::getMolPos}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&molPosL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&molPosR)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2638     molPosL = this-\/>molPosL;}
\DoxyCodeLine{2639     molPosR = this-\/>molPosR;}
\DoxyCodeLine{2640 \}}
\DoxyCodeLine{2641 }
\DoxyCodeLine{2642 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a9d5727849f685e6cccb5e5a0a3818cb3}{MSD::getTopL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2643     \textcolor{keywordflow}{return} topL;}
\DoxyCodeLine{2644 \}}
\DoxyCodeLine{2645 }
\DoxyCodeLine{2646 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a66200786b332ed413fa3e29a7ecedad3}{MSD::getBottomL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2647     \textcolor{keywordflow}{return} bottomL;}
\DoxyCodeLine{2648 \}}
\DoxyCodeLine{2649 }
\DoxyCodeLine{2650 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a7de138059fe647ec24a50d3b98ecdfe8}{MSD::getFrontR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2651     \textcolor{keywordflow}{return} frontR;}
\DoxyCodeLine{2652 \}}
\DoxyCodeLine{2653 }
\DoxyCodeLine{2654 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classudc_1_1_m_s_d_a368da5ea0c007b29f0c18a4415b2d1f6}{MSD::getBackR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2655     \textcolor{keywordflow}{return} backR;}
\DoxyCodeLine{2656 \}}
\DoxyCodeLine{2657 }
\DoxyCodeLine{2658 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a54c6db2f1ffe3cb9de31b2e278ae2335}{MSD::getInnerBounds}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&topL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&bottomL, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&frontR, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \&backR)\textcolor{keyword}{ const}\{}
\DoxyCodeLine{2659     topL = this-\/>topL;}
\DoxyCodeLine{2660     bottomL = this-\/>bottomL;}
\DoxyCodeLine{2661     frontR = this-\/>frontR;}
\DoxyCodeLine{2662     backR = this-\/>backR;}
\DoxyCodeLine{2663 \}}
\DoxyCodeLine{2664 }
\DoxyCodeLine{2665 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_af17782522b81ac6827d6874ae6aa5018}{MSD::getFM\_L\_exists}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2666     \textcolor{keywordflow}{return} FM\_L\_exists;}
\DoxyCodeLine{2667 \}}
\DoxyCodeLine{2668 }
\DoxyCodeLine{2669 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_ac7b197dca279f02512882dc173a70aaf}{MSD::getFM\_R\_exists}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2670     \textcolor{keywordflow}{return} FM\_R\_exists;}
\DoxyCodeLine{2671 \}}
\DoxyCodeLine{2672 }
\DoxyCodeLine{2673 \textcolor{keywordtype}{bool} \mbox{\hyperlink{classudc_1_1_m_s_d_a87c3cff4cf2db6a08fa6d7f184500eea}{MSD::getMol\_exists}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2674     \textcolor{keywordflow}{return} mol\_exists;}
\DoxyCodeLine{2675 \}}
\DoxyCodeLine{2676 }
\DoxyCodeLine{2677 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a61db2cb3389641129ce97c0613917ec5}{MSD::getRegions}}(\textcolor{keywordtype}{bool} \&FM\_L\_exists, \textcolor{keywordtype}{bool} \&FM\_R\_exists, \textcolor{keywordtype}{bool} \&mol\_exists)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2678     FM\_L\_exists = this-\/>FM\_L\_exists;}
\DoxyCodeLine{2679     FM\_R\_exists = this-\/>FM\_R\_exists;}
\DoxyCodeLine{2680     mol\_exists = this-\/>mol\_exists;}
\DoxyCodeLine{2681 \}}
\DoxyCodeLine{2682 }
\DoxyCodeLine{2683 }
\DoxyCodeLine{2684 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a3cb49ad4ca11278ed81998a8efd3ce68}{MSD::setSeed}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} seed) \{}
\DoxyCodeLine{2685     this-\/>seed = seed;}
\DoxyCodeLine{2686     prng.seed(seed);}
\DoxyCodeLine{2687 \}}
\DoxyCodeLine{2688 }
\DoxyCodeLine{2689 \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classudc_1_1_m_s_d_adedd5f97461ea96c685923b45b49d91b}{MSD::getSeed}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2690     \textcolor{keywordflow}{return} seed;}
\DoxyCodeLine{2691 \}}
\DoxyCodeLine{2692 }
\DoxyCodeLine{2693 }
\DoxyCodeLine{2694 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a82b75829d72149de1992f198ad3c73b6}{MSD::reinitialize}}(\textcolor{keywordtype}{bool} reseed) \{}
\DoxyCodeLine{2695     \textcolor{keywordflow}{if}( reseed )}
\DoxyCodeLine{2696         seed = genSeed();}
\DoxyCodeLine{2697     prng.seed(seed);}
\DoxyCodeLine{2698     \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} i = \mbox{\hyperlink{classudc_1_1_m_s_d_afb91b037de5315bfde0159ee591267a3}{begin}}(); i != \mbox{\hyperlink{classudc_1_1_m_s_d_a917317363ac8e2e78840845d6fc49f91}{end}}(); i++ )}
\DoxyCodeLine{2699         \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{setLocalM}}( i, initSpin, initFlux );}
\DoxyCodeLine{2700     \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.clear();}
\DoxyCodeLine{2701     \mbox{\hyperlink{classudc_1_1_m_s_d_aa1513f639c10ca29773ea287ae104121}{setParameters}}(parameters);  \textcolor{comment}{// TODO: do we need this? Yes, but I think only because we}}
\DoxyCodeLine{2702     \mbox{\hyperlink{classudc_1_1_m_s_d_aa8ed0dab0705b810e4d14215b488fb43}{setMolProto}}(molProto);  \textcolor{comment}{// need to rescale Spin and Flux vectors to match S and F params}}
\DoxyCodeLine{2703     results.t = 0;}
\DoxyCodeLine{2704 \}}
\DoxyCodeLine{2705 }
\DoxyCodeLine{2706 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a9b89ead4fcfc2c0ead59dcb33538a334}{MSD::randomize}}(\textcolor{keywordtype}{bool} reseed) \{}
\DoxyCodeLine{2707     \textcolor{keywordflow}{if}( reseed )}
\DoxyCodeLine{2708         seed = genSeed();}
\DoxyCodeLine{2709     prng.seed(seed);}
\DoxyCodeLine{2710     \textcolor{keywordflow}{for}( \textcolor{keyword}{auto} i = \mbox{\hyperlink{classudc_1_1_m_s_d_afb91b037de5315bfde0159ee591267a3}{begin}}(); i != \mbox{\hyperlink{classudc_1_1_m_s_d_a917317363ac8e2e78840845d6fc49f91}{end}}(); i++ )}
\DoxyCodeLine{2711         \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{setLocalM}}( i,  \textcolor{comment}{// TODO: this calculation isn't uniform. It favors F close to 0}}
\DoxyCodeLine{2712                 \mbox{\hyperlink{classudc_1_1_vector_a89b43ddd10a372d584a03a5583ad5652}{Vector::sphericalForm}}(1, 2 * \mbox{\hyperlink{namespaceudc_a1757f9fc50446243658974977dd95e7c}{PI}} * rand(prng), asin(2 * rand(prng) -\/ 1)),}
\DoxyCodeLine{2713                 \mbox{\hyperlink{classudc_1_1_vector_a89b43ddd10a372d584a03a5583ad5652}{Vector::sphericalForm}}(rand(prng), 2 * \mbox{\hyperlink{namespaceudc_a1757f9fc50446243658974977dd95e7c}{PI}} * rand(prng), asin(2 * rand(prng) -\/ 1)) );}
\DoxyCodeLine{2714     \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.clear();}
\DoxyCodeLine{2715     \mbox{\hyperlink{classudc_1_1_m_s_d_aa1513f639c10ca29773ea287ae104121}{setParameters}}(parameters);  \textcolor{comment}{// TODO: do we still need this? Yes. (See comment in MSD::reinitialize())}}
\DoxyCodeLine{2716     \mbox{\hyperlink{classudc_1_1_m_s_d_aa8ed0dab0705b810e4d14215b488fb43}{setMolProto}}(molProto);}
\DoxyCodeLine{2717     results.t = 0;}
\DoxyCodeLine{2718 \}}
\DoxyCodeLine{2719 }
\DoxyCodeLine{2720 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a3da3a656fdd0a10f6bbc819935c9fa1d}{MSD::metropolis}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} N) \{}
\DoxyCodeLine{2721     function<double()> random = bind( rand, ref(prng) );}
\DoxyCodeLine{2722     \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} r = \mbox{\hyperlink{classudc_1_1_m_s_d_ae1bee2a207b40720156243ed19eed671}{getResults}}(); \textcolor{comment}{//get the energy of the system}}
\DoxyCodeLine{2723     \textcolor{comment}{//start loop (will iterate N times)}}
\DoxyCodeLine{2724     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} i = 0; i < N; i++ ) \{}
\DoxyCodeLine{2725         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} a = indices[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}\textcolor{keyword}{>}( random() * indices.size() )]; \textcolor{comment}{//pick an atom (pseudo) randomly}}
\DoxyCodeLine{2726         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_m_s_d_a9719db02665a291111d9dd887be6538f}{getSpin}}(a);  \textcolor{comment}{// TODO: do we need the bounds checking?}}
\DoxyCodeLine{2727         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} f = \mbox{\hyperlink{classudc_1_1_m_s_d_a5296876f3e8cc8b963c0daa773f9f3a7}{getFlux}}(a);  \textcolor{comment}{// TODO: do we need the bounds checking?}}
\DoxyCodeLine{2728         }
\DoxyCodeLine{2729         \textcolor{comment}{// remeber if we are in a mol. in case we need to revert state}}
\DoxyCodeLine{2730         \textcolor{keywordtype}{bool} inMol = \textcolor{keyword}{false};}
\DoxyCodeLine{2731         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} n;  \textcolor{comment}{// only defined if isMol==true}}
\DoxyCodeLine{2732 }
\DoxyCodeLine{2733         \textcolor{comment}{// pick the correct F coeficient to determine new flux magnitude}}
\DoxyCodeLine{2734         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x = this-\/>x(a);}
\DoxyCodeLine{2735         \textcolor{keywordtype}{double} F;}
\DoxyCodeLine{2736         \textcolor{keywordflow}{if} (x < molPosL) \{}
\DoxyCodeLine{2737             F = parameters.FL;}
\DoxyCodeLine{2738         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x > molPosR) \{}
\DoxyCodeLine{2739             F = parameters.FR;}
\DoxyCodeLine{2740         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2741             n = x -\/ molPosL;}
\DoxyCodeLine{2742             F = molProto.\mbox{\hyperlink{classudc_1_1_molecule_aee4baa13cfc0b0584ec8e2c5000a76be}{getNodeParameters}}(n).\mbox{\hyperlink{structudc_1_1_molecule_1_1_node_parameters_a0a56503fd7eb794ba63f04a1ec25238e}{Fm}};  \textcolor{comment}{// TODO: do we need the bounds checking?}}
\DoxyCodeLine{2743             inMol = \textcolor{keyword}{true};}
\DoxyCodeLine{2744         \}}
\DoxyCodeLine{2745 }
\DoxyCodeLine{2746         \textcolor{comment}{//"{}flip"{} that atom}}
\DoxyCodeLine{2747         \mbox{\hyperlink{classudc_1_1_m_s_d_a01c9eff4fc0c233e1aafc04ea6271036}{setLocalM}}( a, \mbox{\hyperlink{classudc_1_1_m_s_d_a2ccd325cf09e82420004de9702894de5}{flippingAlgorithm}}(s, random),}
\DoxyCodeLine{2748                 \mbox{\hyperlink{classudc_1_1_vector_a89b43ddd10a372d584a03a5583ad5652}{Vector::sphericalForm}}(F * random(), 2 * \mbox{\hyperlink{namespaceudc_a1757f9fc50446243658974977dd95e7c}{PI}} * random(), asin(2 * random() -\/ 1)) );}
\DoxyCodeLine{2749         }
\DoxyCodeLine{2750         \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} r2 = \mbox{\hyperlink{classudc_1_1_m_s_d_ae1bee2a207b40720156243ed19eed671}{getResults}}(); \textcolor{comment}{//get the energy of the system (for the new state)}}
\DoxyCodeLine{2751         \textcolor{keywordtype}{double} dU = r2.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}} -\/ r.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}};  \textcolor{comment}{// delta-\/U (change in energy)}}
\DoxyCodeLine{2752         \textcolor{keywordflow}{if}( dU <= 0 || random() < pow( \mbox{\hyperlink{namespaceudc_aa4b4d55516f1e34de5dc8b228f160597}{E}}, -\/dU / parameters.kT ) ) \{}
\DoxyCodeLine{2753             \textcolor{comment}{//either the new system requires less energy or external energy (kT) is disrupting it}}
\DoxyCodeLine{2754             r = r2; \textcolor{comment}{//in either case we keep the new system}}
\DoxyCodeLine{2755         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2756             \textcolor{comment}{//neither thing (above) happened so we revert the system}}
\DoxyCodeLine{2757             \textcolor{keywordflow}{if} (inMol) \{}
\DoxyCodeLine{2758                 shared\_ptr<Mol> mol = mols[a];}
\DoxyCodeLine{2759                 mol-\/>spins[n] = s;}
\DoxyCodeLine{2760                 mol-\/>fluxes[n] = f;}
\DoxyCodeLine{2761             \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2762                 spins[a] = s; \textcolor{comment}{//revert the system by flipping the atom back}}
\DoxyCodeLine{2763                 fluxes[a] = f;}
\DoxyCodeLine{2764             \}}
\DoxyCodeLine{2765             results = r;}
\DoxyCodeLine{2766         \}}
\DoxyCodeLine{2767     \}}
\DoxyCodeLine{2768     results.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} += N;}
\DoxyCodeLine{2769 \}}
\DoxyCodeLine{2770 }
\DoxyCodeLine{2771 \textcolor{keywordtype}{void} \mbox{\hyperlink{classudc_1_1_m_s_d_a3da3a656fdd0a10f6bbc819935c9fa1d}{MSD::metropolis}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} N, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} freq) \{}
\DoxyCodeLine{2772     \textcolor{keywordflow}{if}( freq == 0 ) \{}
\DoxyCodeLine{2773         \mbox{\hyperlink{classudc_1_1_m_s_d_a3da3a656fdd0a10f6bbc819935c9fa1d}{metropolis}}(N);}
\DoxyCodeLine{2774         \textcolor{keywordflow}{return};}
\DoxyCodeLine{2775     \}}
\DoxyCodeLine{2776     \textcolor{keywordflow}{while}(\textcolor{keyword}{true}) \{}
\DoxyCodeLine{2777         \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.push\_back( \mbox{\hyperlink{classudc_1_1_m_s_d_ae1bee2a207b40720156243ed19eed671}{getResults}}() );}
\DoxyCodeLine{2778         \textcolor{keywordflow}{if}( N >= freq ) \{}
\DoxyCodeLine{2779             \mbox{\hyperlink{classudc_1_1_m_s_d_a3da3a656fdd0a10f6bbc819935c9fa1d}{metropolis}}(freq);}
\DoxyCodeLine{2780             N -\/= freq;}
\DoxyCodeLine{2781         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{2782             \textcolor{keywordflow}{if}( N != 0 )}
\DoxyCodeLine{2783                 \mbox{\hyperlink{classudc_1_1_m_s_d_a3da3a656fdd0a10f6bbc819935c9fa1d}{metropolis}}(N);}
\DoxyCodeLine{2784             \textcolor{keywordflow}{break};}
\DoxyCodeLine{2785         \}}
\DoxyCodeLine{2786     \}}
\DoxyCodeLine{2787 \}}
\DoxyCodeLine{2788 }
\DoxyCodeLine{2789 }
\DoxyCodeLine{2790 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_aca1fecf2568de928a441aa031280fc49}{MSD::specificHeat}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2791     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2792         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2793     \}}
\DoxyCodeLine{2794 }
\DoxyCodeLine{2795     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2796     \textcolor{keywordtype}{double} s = 0, s2 = 0;}
\DoxyCodeLine{2797     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{2798         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{2799         }
\DoxyCodeLine{2800         \textcolor{keywordtype}{double} dU = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}};}
\DoxyCodeLine{2801         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{2802         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{2803         s2 += ((dt/3 * dU + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}}) * dU + \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}})) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{2804 }
\DoxyCodeLine{2805         r0 = r1;}
\DoxyCodeLine{2806     \}}
\DoxyCodeLine{2807     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{2808     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{2809     \textcolor{keywordtype}{double} avg = 0.5 * s / dt;}
\DoxyCodeLine{2810     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{2811 }
\DoxyCodeLine{2812     \textcolor{keywordflow}{return} (avgSq -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(avg)) / (n * parameters.kT * parameters.kT);}
\DoxyCodeLine{2813 \}}
\DoxyCodeLine{2814 }
\DoxyCodeLine{2815 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a0b14f09fe74231e5f9981b1571666ce5}{MSD::specificHeat\_L}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2816     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2817         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2818     \}}
\DoxyCodeLine{2819 }
\DoxyCodeLine{2820     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2821     \textcolor{keywordtype}{double} s = 0, s2 = 0;}
\DoxyCodeLine{2822     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{2823         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{2824         }
\DoxyCodeLine{2825         \textcolor{keywordtype}{double} dU = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}};}
\DoxyCodeLine{2826         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{2827         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{2828         s2 += ((dt/3 * dU + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}}) * dU + \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}})) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{2829 }
\DoxyCodeLine{2830         r0 = r1;}
\DoxyCodeLine{2831     \}}
\DoxyCodeLine{2832     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{2833     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{2834     \textcolor{keywordtype}{double} avg = 0.5 * s / dt;}
\DoxyCodeLine{2835     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{2836 }
\DoxyCodeLine{2837     \textcolor{keywordflow}{return} (avgSq -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(avg)) / (nL * parameters.kT * parameters.kT);}
\DoxyCodeLine{2838 \}}
\DoxyCodeLine{2839 }
\DoxyCodeLine{2840 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a8c62ebc53fe5f1d620785ad492b27414}{MSD::specificHeat\_R}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2841     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2842         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2843     \}}
\DoxyCodeLine{2844 }
\DoxyCodeLine{2845     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2846     \textcolor{keywordtype}{double} s = 0, s2 = 0;}
\DoxyCodeLine{2847     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{2848         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{2849         }
\DoxyCodeLine{2850         \textcolor{keywordtype}{double} dU = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}};}
\DoxyCodeLine{2851         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{2852         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{2853         s2 += ((dt/3 * dU + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}}) * dU + \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}})) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{2854 }
\DoxyCodeLine{2855         r0 = r1;}
\DoxyCodeLine{2856     \}}
\DoxyCodeLine{2857     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{2858     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{2859     \textcolor{keywordtype}{double} avg = 0.5 * s / dt;}
\DoxyCodeLine{2860     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{2861 }
\DoxyCodeLine{2862     \textcolor{keywordflow}{return} (avgSq -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(avg)) / (nR * parameters.kT * parameters.kT);}
\DoxyCodeLine{2863 \}}
\DoxyCodeLine{2864 }
\DoxyCodeLine{2865 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_abb96b180a4960bf101178aa01701b3cc}{MSD::specificHeat\_m}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2866     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2867         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2868     \}}
\DoxyCodeLine{2869 }
\DoxyCodeLine{2870     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2871     \textcolor{keywordtype}{double} s = 0, s2 = 0;}
\DoxyCodeLine{2872     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{2873         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{2874         }
\DoxyCodeLine{2875         \textcolor{keywordtype}{double} dU = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}};}
\DoxyCodeLine{2876         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{2877         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{2878         s2 += ((dt/3 * dU + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}}) * dU + \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}})) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{2879 }
\DoxyCodeLine{2880         r0 = r1;}
\DoxyCodeLine{2881     \}}
\DoxyCodeLine{2882     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{2883     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{2884     \textcolor{keywordtype}{double} avg = 0.5 * s / dt;}
\DoxyCodeLine{2885     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{2886 }
\DoxyCodeLine{2887     \textcolor{keywordflow}{return} (avgSq -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(avg)) / (n\_m * parameters.kT * parameters.kT);}
\DoxyCodeLine{2888 \}}
\DoxyCodeLine{2889 }
\DoxyCodeLine{2890 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a2d9850c33757ced8ae7c7b4b5de5afb2}{MSD::specificHeat\_mL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2891     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2892         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2893     \}}
\DoxyCodeLine{2894 }
\DoxyCodeLine{2895     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2896     \textcolor{keywordtype}{double} s = 0, s2 = 0;}
\DoxyCodeLine{2897     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{2898         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{2899         }
\DoxyCodeLine{2900         \textcolor{keywordtype}{double} dU = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}};}
\DoxyCodeLine{2901         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{2902         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{2903         s2 += ((dt/3 * dU + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}}) * dU + \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}})) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{2904 }
\DoxyCodeLine{2905         r0 = r1;}
\DoxyCodeLine{2906     \}}
\DoxyCodeLine{2907     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{2908     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{2909     \textcolor{keywordtype}{double} avg = 0.5 * s / dt;}
\DoxyCodeLine{2910     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{2911 }
\DoxyCodeLine{2912     \textcolor{keywordflow}{return} (avgSq -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(avg)) / (n\_mL * parameters.kT * parameters.kT);}
\DoxyCodeLine{2913 \}}
\DoxyCodeLine{2914 }
\DoxyCodeLine{2915 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a162b9154b562fb1f70e128eb9f0b9c46}{MSD::specificHeat\_mR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2916     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2917         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2918     \}}
\DoxyCodeLine{2919 }
\DoxyCodeLine{2920     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2921     \textcolor{keywordtype}{double} s = 0, s2 = 0;}
\DoxyCodeLine{2922     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{2923         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{2924         }
\DoxyCodeLine{2925         \textcolor{keywordtype}{double} dU = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}};}
\DoxyCodeLine{2926         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{2927         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{2928         s2 += ((dt/3 * dU + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}}) * dU + \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}})) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{2929 }
\DoxyCodeLine{2930         r0 = r1;}
\DoxyCodeLine{2931     \}}
\DoxyCodeLine{2932     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{2933     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{2934     \textcolor{keywordtype}{double} avg = 0.5 * s / dt;}
\DoxyCodeLine{2935     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{2936 }
\DoxyCodeLine{2937     \textcolor{keywordflow}{return} (avgSq -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(avg)) / (n\_mR * parameters.kT * parameters.kT);}
\DoxyCodeLine{2938 \}}
\DoxyCodeLine{2939 }
\DoxyCodeLine{2940 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_ab0205d423d26ab312fe9d612eb6b82e4}{MSD::specificHeat\_LR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2941     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2942         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2943     \}}
\DoxyCodeLine{2944 }
\DoxyCodeLine{2945     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2946     \textcolor{keywordtype}{double} s = 0, s2 = 0;}
\DoxyCodeLine{2947     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{2948         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{2949         }
\DoxyCodeLine{2950         \textcolor{keywordtype}{double} dU = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}};}
\DoxyCodeLine{2951         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{2952         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{2953         s2 += ((dt/3 * dU + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}}) * dU + \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}})) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{2954 }
\DoxyCodeLine{2955         r0 = r1;}
\DoxyCodeLine{2956     \}}
\DoxyCodeLine{2957     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{2958     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{2959     \textcolor{keywordtype}{double} avg = 0.5 * s / dt;}
\DoxyCodeLine{2960     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{2961 }
\DoxyCodeLine{2962     \textcolor{keywordflow}{return} (avgSq -\/ \mbox{\hyperlink{namespaceudc_aa7cee595bc6a15bdd189f00553c92349}{sq}}(avg)) / (nLR * parameters.kT * parameters.kT);}
\DoxyCodeLine{2963 \}}
\DoxyCodeLine{2964 }
\DoxyCodeLine{2965 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_ac8f8afe5da02b14af09b1b4861a274e1}{MSD::magneticSusceptibility}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2966     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2967         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2968     \}}
\DoxyCodeLine{2969 }
\DoxyCodeLine{2970     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2971     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{2972     \textcolor{keywordtype}{double} s2 = 0;}
\DoxyCodeLine{2973     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{2974         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{2975         }
\DoxyCodeLine{2976         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dM = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}};}
\DoxyCodeLine{2977         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{2978         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{2979         s2 += ((dt/3 * dM + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}}) * dM + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}} * r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}}) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{2980 }
\DoxyCodeLine{2981         r0 = r1;}
\DoxyCodeLine{2982     \}}
\DoxyCodeLine{2983     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{2984     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{2985     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} avg = 0.5 / dt * s;}
\DoxyCodeLine{2986     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{2987 }
\DoxyCodeLine{2988     \textcolor{keywordflow}{return} (avgSq -\/ avg * avg) / (n * parameters.kT * parameters.kT);}
\DoxyCodeLine{2989 \}}
\DoxyCodeLine{2990 }
\DoxyCodeLine{2991 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a3a7e3fa4340af6fe33cf2daceb37f656}{MSD::magneticSusceptibility\_L}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{2992     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{2993         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{2994     \}}
\DoxyCodeLine{2995 }
\DoxyCodeLine{2996     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{2997     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{2998     \textcolor{keywordtype}{double} s2 = 0;}
\DoxyCodeLine{2999     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3000         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3001         }
\DoxyCodeLine{3002         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dM = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}};}
\DoxyCodeLine{3003         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{3004         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{3005         s2 += ((dt/3 * dM + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}}) * dM + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}} * r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}}) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{3006 }
\DoxyCodeLine{3007         r0 = r1;}
\DoxyCodeLine{3008     \}}
\DoxyCodeLine{3009     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{3010     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{3011     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} avg = 0.5 / dt * s;}
\DoxyCodeLine{3012     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{3013 }
\DoxyCodeLine{3014     \textcolor{keywordflow}{return} (avgSq -\/ avg * avg) / (nL * parameters.kT * parameters.kT);}
\DoxyCodeLine{3015 \}}
\DoxyCodeLine{3016 }
\DoxyCodeLine{3017 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_acb90487ccf1985ac1045c7762fa4f42f}{MSD::magneticSusceptibility\_R}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3018     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{3019         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{3020     \}}
\DoxyCodeLine{3021 }
\DoxyCodeLine{3022     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{3023     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3024     \textcolor{keywordtype}{double} s2 = 0;}
\DoxyCodeLine{3025     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3026         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3027         }
\DoxyCodeLine{3028         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dM = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}};}
\DoxyCodeLine{3029         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{3030         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{3031         s2 += ((dt/3 * dM + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}}) * dM + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}} * r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}}) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{3032 }
\DoxyCodeLine{3033         r0 = r1;}
\DoxyCodeLine{3034     \}}
\DoxyCodeLine{3035     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{3036     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{3037     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} avg = 0.5 / dt * s;}
\DoxyCodeLine{3038     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{3039 }
\DoxyCodeLine{3040     \textcolor{keywordflow}{return} (avgSq -\/ avg * avg) / (nR * parameters.kT * parameters.kT);}
\DoxyCodeLine{3041 \}}
\DoxyCodeLine{3042 }
\DoxyCodeLine{3043 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a215acad84017f65c72a1abcb504b12ea}{MSD::magneticSusceptibility\_m}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3044     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1) \{}
\DoxyCodeLine{3045         \textcolor{keywordflow}{return} 0;  \textcolor{comment}{// <U\string^2> -\/ <U>\string^2 == 0 if there is only 1 data point}}
\DoxyCodeLine{3046     \}}
\DoxyCodeLine{3047 }
\DoxyCodeLine{3048     \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r0 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0);}
\DoxyCodeLine{3049     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3050     \textcolor{keywordtype}{double} s2 = 0;}
\DoxyCodeLine{3051     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3052         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} *r1 = \&\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3053         }
\DoxyCodeLine{3054         \mbox{\hyperlink{classudc_1_1_vector}{Vector}} dM = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}};}
\DoxyCodeLine{3055         \textcolor{keywordtype}{double} dt = r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}};}
\DoxyCodeLine{3056         s += (r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}} + r1-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}}) * dt;  \textcolor{comment}{// trapizoidal rule (1/2 factored out)}}
\DoxyCodeLine{3057         s2 += ((dt/3 * dM + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}}) * dM + r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}} * r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}}) * dt;  \textcolor{comment}{// square of trapizoidal rule (linear interpolation)}}
\DoxyCodeLine{3058 }
\DoxyCodeLine{3059         r0 = r1;}
\DoxyCodeLine{3060     \}}
\DoxyCodeLine{3061     \textcolor{comment}{// Note: r0 = \& last record}}
\DoxyCodeLine{3062     \textcolor{keywordtype}{double} dt = r0-\/>\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t;}
\DoxyCodeLine{3063     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} avg = 0.5 / dt * s;}
\DoxyCodeLine{3064     \textcolor{keywordtype}{double} avgSq = s2 / dt;}
\DoxyCodeLine{3065 }
\DoxyCodeLine{3066     \textcolor{keywordflow}{return} (avgSq -\/ avg * avg) / (n\_m * parameters.kT * parameters.kT);}
\DoxyCodeLine{3067 \}}
\DoxyCodeLine{3068 }
\DoxyCodeLine{3069 }
\DoxyCodeLine{3070 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a4b9e7018e4245eaf23d4e01d0b582cc3}{MSD::meanM}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3071     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3072         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).M;}
\DoxyCodeLine{3073     \textcolor{comment}{//compensates for t by using the trapezoidal rule; (and the same below)}}
\DoxyCodeLine{3074     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3075     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3076         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3077         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3078         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_add17a888eb16b943590de93a0b3e91b1}{M}});}
\DoxyCodeLine{3079     \}}
\DoxyCodeLine{3080     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3081 \}}
\DoxyCodeLine{3082 }
\DoxyCodeLine{3083 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a8fe5c6f539ba5f128d89f6c32e42a81b}{MSD::meanML}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3084     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3085         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).ML;}
\DoxyCodeLine{3086     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3087     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3088         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3089         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3090         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab999831d99fdbe251e9b42f285a55de3}{ML}});}
\DoxyCodeLine{3091     \}}
\DoxyCodeLine{3092     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3093 \}}
\DoxyCodeLine{3094 }
\DoxyCodeLine{3095 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a75a2a166c7a100d23729914893024e8b}{MSD::meanMR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3096     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3097         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MR;}
\DoxyCodeLine{3098     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3099     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3100         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3101         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3102         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a02e81e4c6b257f5cdd5cbadcf8c2a932}{MR}});}
\DoxyCodeLine{3103     \}}
\DoxyCodeLine{3104     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3105 \}}
\DoxyCodeLine{3106 }
\DoxyCodeLine{3107 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a7b1361f8f8a4c2782e16f4885860160d}{MSD::meanMm}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3108     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3109         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).Mm;}
\DoxyCodeLine{3110     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3111     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3112         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3113         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3114         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a34c69209bbac659c712c77d8c3e2b579}{Mm}});}
\DoxyCodeLine{3115     \}}
\DoxyCodeLine{3116     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3117 \}}
\DoxyCodeLine{3118 }
\DoxyCodeLine{3119 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a4c23d2ce55dbe92303a93b0f04247d6a}{MSD::meanMS}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3120     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3121         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MS;}
\DoxyCodeLine{3122     \textcolor{comment}{//compensates for t by using the trapezoidal rule; (and the same below)}}
\DoxyCodeLine{3123     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3124     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3125         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3126         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3127         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_aeae2f7666be87f8d4499d612567fe71a}{MS}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_aeae2f7666be87f8d4499d612567fe71a}{MS}});}
\DoxyCodeLine{3128     \}}
\DoxyCodeLine{3129     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3130 \}}
\DoxyCodeLine{3131 }
\DoxyCodeLine{3132 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a6c769149852b83b104041036684cc3b5}{MSD::meanMSL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3133     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3134         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MSL;}
\DoxyCodeLine{3135     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3136     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3137         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3138         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3139         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a020102ea8f3621b4791a75de90624ade}{MSL}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a020102ea8f3621b4791a75de90624ade}{MSL}});}
\DoxyCodeLine{3140     \}}
\DoxyCodeLine{3141     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3142 \}}
\DoxyCodeLine{3143 }
\DoxyCodeLine{3144 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_af32676ff5839b6a89cae38003cf392a5}{MSD::meanMSR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3145     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3146         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MSR;}
\DoxyCodeLine{3147     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3148     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3149         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3150         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3151         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66823c7a278ea165067eadaf62c976d0}{MSR}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66823c7a278ea165067eadaf62c976d0}{MSR}});}
\DoxyCodeLine{3152     \}}
\DoxyCodeLine{3153     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3154 \}}
\DoxyCodeLine{3155 }
\DoxyCodeLine{3156 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a0d9c252051a14d75fbfdab2e3ba0f1e5}{MSD::meanMSm}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3157     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3158         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MSm;}
\DoxyCodeLine{3159     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3160     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3161         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3162         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3163         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a42f24fd034f5acf41d415093def18fa5}{MSm}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a42f24fd034f5acf41d415093def18fa5}{MSm}});}
\DoxyCodeLine{3164     \}}
\DoxyCodeLine{3165     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3166 \}}
\DoxyCodeLine{3167 }
\DoxyCodeLine{3168 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a195fcd710a651679837fe247ba037e65}{MSD::meanMF}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3169     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3170         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MF;}
\DoxyCodeLine{3171     \textcolor{comment}{//compensates for t by using the trapezoidal rule; (and the same below)}}
\DoxyCodeLine{3172     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3173     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3174         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3175         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3176         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a789b09f14dc037a00b59733ef5e6b8fe}{MF}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a789b09f14dc037a00b59733ef5e6b8fe}{MF}});}
\DoxyCodeLine{3177     \}}
\DoxyCodeLine{3178     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3179 \}}
\DoxyCodeLine{3180 }
\DoxyCodeLine{3181 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_aa996c134623e5f28bb2d599088f4cd56}{MSD::meanMFL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3182     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3183         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MFL;}
\DoxyCodeLine{3184     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3185     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3186         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3187         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3188         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1a6be402d985814748b000dce6b983e9}{MFL}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1a6be402d985814748b000dce6b983e9}{MFL}});}
\DoxyCodeLine{3189     \}}
\DoxyCodeLine{3190     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3191 \}}
\DoxyCodeLine{3192 }
\DoxyCodeLine{3193 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_ab4b2b0695b3e6143c44b6ab391f9890d}{MSD::meanMFR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3194     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3195         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MFR;}
\DoxyCodeLine{3196     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3197     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3198         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3199         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3200         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66d2b20d7c955c704ce31b355419ee45}{MFR}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a66d2b20d7c955c704ce31b355419ee45}{MFR}});}
\DoxyCodeLine{3201     \}}
\DoxyCodeLine{3202     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3203 \}}
\DoxyCodeLine{3204 }
\DoxyCodeLine{3205 \mbox{\hyperlink{classudc_1_1_vector}{Vector}} \mbox{\hyperlink{classudc_1_1_m_s_d_a9aac2bad16a926cd6ac24e3c4291325f}{MSD::meanMFm}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3206     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3207         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).MFm;}
\DoxyCodeLine{3208     \mbox{\hyperlink{classudc_1_1_vector}{Vector}} s = \mbox{\hyperlink{classudc_1_1_vector_a9e75b0360efe22b62f12b7988cac26b8}{Vector::ZERO}};}
\DoxyCodeLine{3209     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3210         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3211         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3212         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac3c2f0d86900c360181e14073842f9a5}{MFm}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac3c2f0d86900c360181e14073842f9a5}{MFm}});}
\DoxyCodeLine{3213     \}}
\DoxyCodeLine{3214     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3215 \}}
\DoxyCodeLine{3216 }
\DoxyCodeLine{3217 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a07edbbd70d154577745c22e5ec7bdee4}{MSD::meanU}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3218     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3219         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).U;}
\DoxyCodeLine{3220     \textcolor{keywordtype}{double} s = 0;}
\DoxyCodeLine{3221     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3222         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3223         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3224         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ac2f34ae8ef9e61293384e1df5331d77f}{U}});}
\DoxyCodeLine{3225     \}}
\DoxyCodeLine{3226     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3227 \}}
\DoxyCodeLine{3228 }
\DoxyCodeLine{3229 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_aec1081b7cc26892ee7bc9399f1fadbb2}{MSD::meanUL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3230     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3231         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).UL;}
\DoxyCodeLine{3232     \textcolor{keywordtype}{double} s = 0;}
\DoxyCodeLine{3233     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3234         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3235         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3236         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_ab96ad5750fd4adbabc28d6164a3c09e5}{UL}});}
\DoxyCodeLine{3237     \}}
\DoxyCodeLine{3238     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3239 \}}
\DoxyCodeLine{3240 }
\DoxyCodeLine{3241 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a250a0059dd38873b6efe85a4f5da8668}{MSD::meanUR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3242     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3243         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).UR;}
\DoxyCodeLine{3244     \textcolor{keywordtype}{double} s = 0;}
\DoxyCodeLine{3245     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3246         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3247         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3248         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a497832a1d05ed77c59702f3eeaaba4af}{UR}});}
\DoxyCodeLine{3249     \}}
\DoxyCodeLine{3250     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3251 \}}
\DoxyCodeLine{3252 }
\DoxyCodeLine{3253 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a922653ef103119a00b0c808c62a7f9d3}{MSD::meanUm}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3254     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3255         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).Um;}
\DoxyCodeLine{3256     \textcolor{keywordtype}{double} s = 0;}
\DoxyCodeLine{3257     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3258         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3259         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3260         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_accd2d8651433a936fcdc74d8677c8cb2}{Um}});}
\DoxyCodeLine{3261     \}}
\DoxyCodeLine{3262     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3263 \}}
\DoxyCodeLine{3264 }
\DoxyCodeLine{3265 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a41a86b85c83949242bcc602775ed136d}{MSD::meanUmL}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3266     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3267         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).UmL;}
\DoxyCodeLine{3268     \textcolor{keywordtype}{double} s = 0;}
\DoxyCodeLine{3269     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3270         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3271         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3272         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a1826fae2c258ee0eaa78bddbcd83b6e9}{UmL}});}
\DoxyCodeLine{3273     \}}
\DoxyCodeLine{3274     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3275 \}}
\DoxyCodeLine{3276 }
\DoxyCodeLine{3277 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_ad5c1cd7334fdd3ea7db7964f2e69a536}{MSD::meanUmR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3278     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3279         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).UmR;}
\DoxyCodeLine{3280     \textcolor{keywordtype}{double} s = 0;}
\DoxyCodeLine{3281     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3282         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3283         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3284         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a11b8dd99584758f7bd89d50823d788d7}{UmR}});}
\DoxyCodeLine{3285     \}}
\DoxyCodeLine{3286     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3287 \}}
\DoxyCodeLine{3288 }
\DoxyCodeLine{3289 \textcolor{keywordtype}{double} \mbox{\hyperlink{classudc_1_1_m_s_d_a215bb03467cc147f837cd3afe89a793a}{MSD::meanULR}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3290     \textcolor{keywordflow}{if}( \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() <= 1 )}
\DoxyCodeLine{3291         \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.at(0).ULR;}
\DoxyCodeLine{3292     \textcolor{keywordtype}{double} s = 0;}
\DoxyCodeLine{3293     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{size\_t} i = 1; i < \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size(); i++ ) \{}
\DoxyCodeLine{3294         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r0 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i -\/ 1];}
\DoxyCodeLine{3295         \textcolor{keyword}{const} \mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results}{Results}} \&r1 = \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[i];}
\DoxyCodeLine{3296         s += (r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}} -\/ r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_af3d16fd70f68cea33b5ef33974515f79}{t}}) * (r0.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}} + r1.\mbox{\hyperlink{structudc_1_1_m_s_d_1_1_results_a4b13d0703ce1ed4495f7d68fd6ff0b91}{ULR}});}
\DoxyCodeLine{3297     \}}
\DoxyCodeLine{3298     \textcolor{keywordflow}{return} (0.5 / (\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[\mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}.size() -\/ 1].t -\/ \mbox{\hyperlink{classudc_1_1_m_s_d_a6a807356604fd24654d015c41974b526}{record}}[0].t)) * s;}
\DoxyCodeLine{3299 \}}
\DoxyCodeLine{3300 }
\DoxyCodeLine{3301 }
\DoxyCodeLine{3302 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_afb91b037de5315bfde0159ee591267a3}{MSD::begin}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3303     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}}(*\textcolor{keyword}{this}, 0);}
\DoxyCodeLine{3304 \}}
\DoxyCodeLine{3305 }
\DoxyCodeLine{3306 \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{MSD::Iterator}} \mbox{\hyperlink{classudc_1_1_m_s_d_a917317363ac8e2e78840845d6fc49f91}{MSD::end}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{3307     \textcolor{keywordflow}{return} \mbox{\hyperlink{classudc_1_1_m_s_d_1_1_iterator}{Iterator}}(*\textcolor{keyword}{this}, indices.size());}
\DoxyCodeLine{3308 \}}
\DoxyCodeLine{3309 }
\DoxyCodeLine{3310 }
\DoxyCodeLine{3311 \} \textcolor{comment}{//end of namespace}}
\DoxyCodeLine{3312 }
\DoxyCodeLine{3313 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
